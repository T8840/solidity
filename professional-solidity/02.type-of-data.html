<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>02.æ•°æ® | T8840 Blog</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="T8840çš„åšå®¢">
    
    <link rel="preload" href="/solidity/assets/css/0.styles.b490882a.css" as="style"><link rel="preload" href="/solidity/assets/js/app.e5082ffd.js" as="script"><link rel="preload" href="/solidity/assets/js/3.5ee47f7c.js" as="script"><link rel="preload" href="/solidity/assets/js/1.912b4b55.js" as="script"><link rel="preload" href="/solidity/assets/js/28.f5e564d2.js" as="script"><link rel="prefetch" href="/solidity/assets/js/10.b8fb11d0.js"><link rel="prefetch" href="/solidity/assets/js/11.f32d6aa6.js"><link rel="prefetch" href="/solidity/assets/js/12.500c9e01.js"><link rel="prefetch" href="/solidity/assets/js/13.f32bd8e7.js"><link rel="prefetch" href="/solidity/assets/js/14.240c8045.js"><link rel="prefetch" href="/solidity/assets/js/15.0e4064e0.js"><link rel="prefetch" href="/solidity/assets/js/16.520be469.js"><link rel="prefetch" href="/solidity/assets/js/17.9e1045bf.js"><link rel="prefetch" href="/solidity/assets/js/18.fda721ea.js"><link rel="prefetch" href="/solidity/assets/js/19.7dcfc9fc.js"><link rel="prefetch" href="/solidity/assets/js/20.5b4e6f91.js"><link rel="prefetch" href="/solidity/assets/js/21.19568bc5.js"><link rel="prefetch" href="/solidity/assets/js/22.166c2d98.js"><link rel="prefetch" href="/solidity/assets/js/23.5cfe8d9a.js"><link rel="prefetch" href="/solidity/assets/js/24.ca3cb849.js"><link rel="prefetch" href="/solidity/assets/js/25.fd73bb0b.js"><link rel="prefetch" href="/solidity/assets/js/26.560bc8ec.js"><link rel="prefetch" href="/solidity/assets/js/27.f2377326.js"><link rel="prefetch" href="/solidity/assets/js/29.dd2c0633.js"><link rel="prefetch" href="/solidity/assets/js/30.28848fc0.js"><link rel="prefetch" href="/solidity/assets/js/31.4c918904.js"><link rel="prefetch" href="/solidity/assets/js/32.a8886025.js"><link rel="prefetch" href="/solidity/assets/js/33.ffc5709c.js"><link rel="prefetch" href="/solidity/assets/js/34.f08a3e2e.js"><link rel="prefetch" href="/solidity/assets/js/35.95934a73.js"><link rel="prefetch" href="/solidity/assets/js/36.61b3c3c3.js"><link rel="prefetch" href="/solidity/assets/js/37.a902f0d2.js"><link rel="prefetch" href="/solidity/assets/js/38.c8172eb9.js"><link rel="prefetch" href="/solidity/assets/js/39.d83f4932.js"><link rel="prefetch" href="/solidity/assets/js/4.673bf15a.js"><link rel="prefetch" href="/solidity/assets/js/40.a01d9291.js"><link rel="prefetch" href="/solidity/assets/js/41.bd4ae60c.js"><link rel="prefetch" href="/solidity/assets/js/42.00e1217a.js"><link rel="prefetch" href="/solidity/assets/js/43.398d96c8.js"><link rel="prefetch" href="/solidity/assets/js/44.61afc1d6.js"><link rel="prefetch" href="/solidity/assets/js/45.e8d6009e.js"><link rel="prefetch" href="/solidity/assets/js/46.5d6497e3.js"><link rel="prefetch" href="/solidity/assets/js/47.34b62bec.js"><link rel="prefetch" href="/solidity/assets/js/48.b3077ae7.js"><link rel="prefetch" href="/solidity/assets/js/49.51c93428.js"><link rel="prefetch" href="/solidity/assets/js/5.8b013b29.js"><link rel="prefetch" href="/solidity/assets/js/50.be8ed4e3.js"><link rel="prefetch" href="/solidity/assets/js/51.ec76f9b6.js"><link rel="prefetch" href="/solidity/assets/js/52.40936f0d.js"><link rel="prefetch" href="/solidity/assets/js/53.488d417b.js"><link rel="prefetch" href="/solidity/assets/js/54.8e10336a.js"><link rel="prefetch" href="/solidity/assets/js/55.2edfb408.js"><link rel="prefetch" href="/solidity/assets/js/56.2c197860.js"><link rel="prefetch" href="/solidity/assets/js/57.1574a0d4.js"><link rel="prefetch" href="/solidity/assets/js/58.34fb9546.js"><link rel="prefetch" href="/solidity/assets/js/59.33203193.js"><link rel="prefetch" href="/solidity/assets/js/6.aad79307.js"><link rel="prefetch" href="/solidity/assets/js/7.8e49b54c.js"><link rel="prefetch" href="/solidity/assets/js/8.1296ca76.js"><link rel="prefetch" href="/solidity/assets/js/9.cc552303.js">
    <link rel="stylesheet" href="/solidity/assets/css/0.styles.b490882a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>T8840 Blog</h3> <p class="description" data-v-59e6cb88>T8840çš„åšå®¢</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
        Â Â 
        <!---->
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/solidity/" class="home-link router-link-active"><!----> <span class="site-name">T8840 Blog</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/solidity/" class="nav-link"><i class="undefined"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      T8840 åšå®¢
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/t8840" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><!----> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>41</h3> <h6 data-v-1fad0c41>æ–‡ç« </h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>0</h3> <h6 data-v-1fad0c41>æ ‡ç­¾</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/solidity/" class="nav-link"><i class="undefined"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      T8840 åšå®¢
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/t8840" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/solidity/" class="sidebar-heading clickable router-link-active"><span>æ¬¢è¿å­¦ä¹ </span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/solidity/" aria-current="page" class="sidebar-link">å­¦å‰å¿…è¯»</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/solidity/best/BestWeb3TechIntroduce" class="sidebar-heading clickable"><span>Web3æœ€ä½³ç¼–ç¨‹å®è·µæŒ‡å—</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/solidity/best/BestWeb3TechIntroduce.html" class="sidebar-link">Web3æœ€ä½³ç¼–ç¨‹å®è·µæŒ‡å—</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/solidity/basic/Introduce" class="sidebar-heading clickable"><span>åŸºç¡€</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/solidity/basic/Introduce.html" class="sidebar-link">ä»‹ç»</a></li><li><a href="/solidity/basic/FirstMetSolidity.html" class="sidebar-link">åˆæ­¥äº†è§£Solidity</a></li><li><a href="/solidity/basic/SoliditybyExample.html" class="sidebar-link">SoliditybyExample</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/standards/Introduce" class="sidebar-heading clickable"><span>æ ‡å‡†</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/professional-solidity/Contents" class="sidebar-heading clickable open"><span>æ•™ç¨‹:professional-solidity</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/solidity/professional-solidity/Contents.html" class="sidebar-link">ç›®å½•</a></li><li><a href="/solidity/professional-solidity/02.type-of-data.html" aria-current="page" class="active sidebar-link">æ•°æ®</a></li><li><a href="/solidity/professional-solidity/03.variable.html" class="sidebar-link">å˜é‡</a></li><li><a href="/solidity/professional-solidity/04.function.html" class="sidebar-link">å‡½æ•°</a></li><li><a href="/solidity/professional-solidity/05.operator.html" class="sidebar-link">æ“ä½œç¬¦</a></li><li><a href="/solidity/professional-solidity/06.error.html" class="sidebar-link">é”™è¯¯å¤„ç†</a></li><li><a href="/solidity/professional-solidity/07.control-flow.html" class="sidebar-link">æµç¨‹æ§åˆ¶</a></li><li><a href="/solidity/professional-solidity/08.loops-and-iteration.html" class="sidebar-link">å¾ªç¯ä¸è¿­ä»£</a></li><li><a href="/solidity/professional-solidity/09.event.html" class="sidebar-link">äº‹ä»¶</a></li><li><a href="/solidity/professional-solidity/10.inheritance.html" class="sidebar-link">ç»§æ‰¿</a></li><li><a href="/solidity/professional-solidity/11.call-other.html" class="sidebar-link">åˆçº¦è°ƒç”¨åˆçº¦</a></li><li><a href="/solidity/professional-solidity/12.deploy.html" class="sidebar-link">åˆçº¦éƒ¨ç½²åˆçº¦</a></li><li><a href="/solidity/professional-solidity/13.interface.html" class="sidebar-link">æ¥å£</a></li><li><a href="/solidity/professional-solidity/14.library.html" class="sidebar-link">åº“</a></li><li><a href="/solidity/professional-solidity/15.algorithm.html" class="sidebar-link">ç®—æ³•</a></li><li><a href="/solidity/professional-solidity/16.assembly.html" class="sidebar-link">å†…è”æ±‡ç¼–</a></li><li><a href="/solidity/professional-solidity/17.metadata.html" class="sidebar-link">å…ƒæ•°æ®</a></li><li><a href="/solidity/professional-solidity/18.abi.html" class="sidebar-link">ABIç¼–ç </a></li><li><a href="/solidity/professional-solidity/19.layout.html" class="sidebar-link">å˜é‡å¸ƒå±€</a></li><li><a href="/solidity/professional-solidity/20.safe.html" class="sidebar-link">å®‰å…¨</a></li><li><a href="/solidity/professional-solidity/21.gas.html" class="sidebar-link">gasä¼˜åŒ–</a></li><li><a href="/solidity/professional-solidity/22.styleguide.html" class="sidebar-link">åˆçº¦ç¼–ç è§„èŒƒ</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/openzeppelin-learn/Introduce" class="sidebar-heading clickable"><span>æ•™ç¨‹:openzeppelin-learn</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/nodejs/Introduce" class="sidebar-heading clickable"><span>nodejs</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/go/Introduce" class="sidebar-heading clickable"><span>Go</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/relay/Introduce" class="sidebar-heading clickable"><span>Relay</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/dapp/CreateWeb3Dapp" class="sidebar-heading clickable"><span>Dapp</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/project/Summary" class="sidebar-heading clickable"><span>é¡¹ç›®</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88></h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
        Â Â 
        <!---->
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">02.æ•°æ®</h1> <div data-v-8a445198><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="_02-æ•°æ®"><a href="#_02-æ•°æ®" class="header-anchor">#</a> 02.æ•°æ®</h1> <p>æ•°æ®æ˜¯ä»»ä½•ç¼–ç¨‹è¯­è¨€çš„ç”Ÿäº§ç”Ÿæ´»èµ„æ–™ï¼Œç¦»å¼€äº†æ•°æ®ï¼Œç¼–ç¨‹è¯­è¨€å°†ä¼šå˜å¾—æ¯«æ— æ„ä¹‰ã€‚ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸èƒ½æŠŠæ‰€æœ‰çš„æ•°æ®éƒ½ç§°ä¸ºä¸€ä¸ªæ•°æ®ï¼Œå°±å¥½åƒæˆ‘ä»¬ç°å®ç”Ÿæ´»ä¸­ä¼šåˆ†ä¸ºäººç±»ï¼ŒåŠ¨ç‰©ç±»ï¼Œæ¤ç‰©ç±»ç­‰ã€‚Solidity æ™ºèƒ½åˆçº¦çš„å«ä¹‰å°±æ˜¯ä¸€äº›åŠŸèƒ½å’Œæ•°æ®çš„é›†åˆï¼Œå®ƒä»¬æ˜¯ä½äºä»¥å¤ªåŠåŒºå—é“¾çš„ç‰¹å®šåœ°å€ä¸Šã€‚</p> <p>Solidity æä¾›äº†å‡ ç§åŸºæœ¬ç±»å‹ï¼Œå¹¶ä¸”åŸºæœ¬ç±»å‹å¯ä»¥ç”¨æ¥ç»„åˆå‡ºå¤æ‚ç±»å‹ã€‚</p> <p>æœ¬ç« ç›®å½•</p> <ul><li>1ï¸âƒ£ æ•°æ®ä¸å˜é‡</li> <li>2ï¸âƒ£ ä¸¤ç§ç±»å‹çš„æ•°æ®</li> <li>3ï¸âƒ£ å€¼ç±»å‹</li> <li>4ï¸âƒ£ å€¼ç±»å‹:åœ°å€ç±»å‹</li> <li>5ï¸âƒ£ å€¼ç±»å‹:åˆçº¦ç±»å‹</li> <li>6ï¸âƒ£ å¼•ç”¨ç±»å‹çš„é¢å¤–æ³¨è§£:æ•°æ®ä½ç½®</li> <li>7ï¸âƒ£ å¼•ç”¨ç±»å‹</li> <li>8ï¸âƒ£ ç±»å‹è½¬æ¢</li> <li>9ï¸âƒ£ å­—é¢å¸¸é‡ä¸åŸºæœ¬ç±»å‹çš„è½¬æ¢</li> <li>ğŸ†— å®æˆ˜ 1: åŒå¿—ä»¬å¥½å¢åŠ æç¤º</li> <li>ğŸ†— å®æˆ˜ 2: ETH é’±åŒ…</li> <li>ğŸ†— å®æˆ˜ 3: å¤šç­¾é’±åŒ…</li> <li>#ï¸âƒ£ é—®ç­”é¢˜</li></ul> <h2 id="_1ï¸âƒ£-æ•°æ®ä¸å˜é‡"><a href="#_1ï¸âƒ£-æ•°æ®ä¸å˜é‡" class="header-anchor">#</a> 1ï¸âƒ£ æ•°æ®ä¸å˜é‡</h2> <p>æåˆ°æ•°æ®ï¼Œå°±ä¸å¯é¿å…çš„éœ€è¦ç‰µæ‰¯åˆ°å˜é‡ã€‚å˜é‡åæ˜¯æ•°æ®çš„åœ¨è®¡ç®—ä¸­çš„å¼•ç”¨ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>uint256 u = 123;
</code></pre></div><p>å¦‚ä¸Šæ˜¯å°†<code>123</code>è¿™ä¸ª <code>uint8</code>ç±»å‹æ•°æ®ï¼Œèµ‹å€¼ç»™ <code>u</code> è¿™ä¸ªåªèƒ½èµ‹å€¼<code>uint256</code>ç±»å‹æ•°æ®çš„å˜é‡åï¼ˆ<code>uint8</code> å¯ä»¥éšå¼è½¬ä¸º<code>uint256</code>ï¼‰ã€‚åç»­æˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>123</code>è¿™ä¸ªæ•°æ®æ—¶ï¼Œå†™ <code>u</code> å°±å¯ä»¥ä»£è¡¨ã€‚</p> <p><code>uint256 u</code> ä¸­çš„ <code>uint256</code>å…³é”®å­—ï¼Œé™åˆ¶äº† <code>u</code> è¿™ä¸ªå˜é‡ååªèƒ½èµ‹å€¼<code>uint256</code>ç±»å‹æ•°æ®ï¼›åœ¨å…¶ä»–å¼±ç±»å‹è¯­è¨€ä¸­å¯èƒ½å­˜åœ¨å˜é‡ç±»å‹å–å†³äºæ•°æ®çš„æƒ…å†µã€‚ä½†æ˜¯ <code>Solidity</code> ä¸­ä¸å­˜åœ¨è¿™ç§æƒ…å†µï¼Œåœ¨å˜é‡å£°æ˜æ—¶å¿…é¡»æŒ‡å®šå˜é‡ç±»å‹ã€‚<strong>Solidity æ˜¯ä¸€ç§é™æ€å¼ºç±»å‹çš„è¯­è¨€ï¼Œå¯¹äºå¸¸è§é”™è¯¯ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡ç¼–è¯‘è¿…é€Ÿæ•æ‰åˆ°</strong>ï¼Œä»»ä½•çš„ Solidity åˆçº¦éƒ½éœ€è¦<strong>ç¼–è¯‘</strong>å’Œ<strong>éƒ¨ç½²</strong>çš„é˜¶æ®µã€‚</p> <h3 id="æœ¬èŠ‚é…å¥—è§†é¢‘"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h3> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=13" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 1 èŠ‚: æ•°æ®ä¸å˜é‡</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=h5x4cZdthgE&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=13" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 1 èŠ‚: æ•°æ®ä¸å˜é‡</a></li></ul> <h3 id="_1-éšå¼è½¬æ¢"><a href="#_1-éšå¼è½¬æ¢" class="header-anchor">#</a> 1.éšå¼è½¬æ¢</h3> <p>å¦‚æœä¸Šé¢ <code>uint256 u = 123;</code> æ”¹ä¸º <code>uint256 u = &quot;Hello&quot;;</code>ï¼Œå°†ä¼šæ”¶åˆ°é”™è¯¯ <code>Type literal_string &quot;Hello&quot; is not implicitly convertible to expected type uint256.</code>ï¼Œå› ä¸ºè¿™ä¸¤ç§ç±»å‹ä¸èƒ½éšå¼è½¬æ¢çš„ï¼›</p> <p>å¦‚æœä¸Šé¢ <code>uint256 u = 123;</code> æ”¹ä¸º <code>uint256 u = uint8(123);</code>ï¼Œå°±ä¸ä¼šæœ‰é—®é¢˜ï¼Œå› ä¸º<code>uint8</code>ç±»å‹å¯ä»¥éšå¼è½¬æ¢ä¸º<code>uint256</code>ç±»å‹ã€‚åé¢ä»‹ç»ç±»å‹è½¬æ¢çš„æ—¶å€™ä¼šè¯¦ç»†çš„ä»‹ç»ã€‚</p> <ul><li><strong>æ€»ç»“:</strong> <ol><li>Solidity æ˜¯ä¸€ç§é™æ€å¼ºç±»å‹çš„è¯­è¨€ã€‚</li> <li>å˜é‡ç±»å‹å’Œéœ€è¦èµ‹å€¼çš„æ•°æ®ç±»å‹å¿…é¡»å¿…é…ï¼Œæˆ–è€…æ‰€èµ‹å€¼çš„æ•°æ®å¯ä»¥éšå¼è½¬æ¢ä¸ºå˜é‡ç±»å‹ã€‚</li></ol></li></ul> <h2 id="_2ï¸âƒ£-ä¸¤ç§ç±»å‹çš„æ•°æ®"><a href="#_2ï¸âƒ£-ä¸¤ç§ç±»å‹çš„æ•°æ®" class="header-anchor">#</a> 2ï¸âƒ£ ä¸¤ç§ç±»å‹çš„æ•°æ®</h2> <h3 id="æœ¬èŠ‚é…å¥—è§†é¢‘-2"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-2" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h3> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=14" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 2 èŠ‚: ä¸¤ç§ç±»å‹çš„æ•°æ®</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=JKiT4L0QveI&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=14" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 1 èŠ‚: ä¸¤ç§ç±»å‹çš„æ•°æ®</a></li></ul> <h3 id="å†…å®¹"><a href="#å†…å®¹" class="header-anchor">#</a> å†…å®¹</h3> <p>Solidity æŒ‰ç…§æ•°æ®ç±»å‹å¯ä»¥åˆ†ä¸º<strong>å€¼ç±»å‹</strong>å’Œ<strong>å¼•ç”¨ç±»å‹</strong>ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    uint256 public u = 123; // æ— å˜åŒ–
    string public welcome1 = &quot;Hello&quot;;
    string public welcome2 = &quot;Hello&quot;;

    function test() external returns(uint256,string memory,string memory){
        // ä¿®æ”¹å€¼ç±»å‹
        uint256 x = u; // èµ‹å€¼
        x = 1; // ä¿®æ”¹

        // ä¿®æ”¹å¼•ç”¨ç±»å‹
        string storage hi1 =  welcome1; // èµ‹å€¼
        bytes(hi1)[0] = bytes1(&quot;2&quot;);

        string memory hi2 =  welcome2; // èµ‹å€¼
        bytes(hi2)[0] = bytes1(&quot;2&quot;);

        // è¿”å›å€¼
        return(x,hi1,hi2);
    }
}
</code></pre></div><ul><li>å€¼ç±»å‹: å€¼ç±»å‹ä¼ å€¼æ—¶ä¼šå°†å€¼æ‹·è´ä¸€ä»½ï¼Œä¼ é€’çš„æ˜¯å€¼æœ¬èº«ï¼Œå¯¹å…¶ä¿®æ”¹æ—¶å¹¶ä¸ä¼šå¯¹åŸæ¥å€¼æœ‰å½±å“ã€‚
<ul><li>å§‹ç»ˆæŒ‰å€¼æ¥ä¼ é€’ï¼Œå½“è¢«ç”¨ä½œå‡½æ•°å‚æ•°æˆ–è€…ç”¨åœ¨èµ‹å€¼è¯­å¥ä¸­æ—¶ï¼Œæ€»ä¼šè¿›è¡Œå€¼æ‹·è´ã€‚</li> <li>å€¼ç±»å‹é‡Œæœ‰ä¸¤ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„ç±»å‹æ˜¯å‡½æ•°å’Œåœ°å€ï¼ˆåŒ…æ‹¬åˆçº¦ï¼‰ï¼Œä¼šåˆ†ä¸ºå•ç‹¬çš„éƒ¨åˆ†ä»‹ç»ã€‚</li></ul></li> <li>å¼•ç”¨ç±»å‹: å¼•ç”¨ç±»å‹è¿›è¡Œä¼ é€’æ—¶ï¼Œä¼ é€’çš„æ˜¯å…¶æŒ‡é’ˆï¼Œè€Œå¼•ç”¨ç±»å‹è¿›è¡Œä¼ é€’æ—¶<strong>å¯ä»¥ä¸ºå€¼ä¼ é€’</strong>ï¼Œ<strong>ä¹Ÿå¯ä»¥ä¸ºå¼•ç”¨ä¼ é€’</strong>ã€‚</li></ul> <h2 id="_3ï¸âƒ£-å€¼ç±»å‹"><a href="#_3ï¸âƒ£-å€¼ç±»å‹" class="header-anchor">#</a> 3ï¸âƒ£ å€¼ç±»å‹</h2> <ol><li>Boolean</li> <li>Integer
<ol><li>uint</li> <li>int</li></ol></li> <li>å®šé•¿å­—èŠ‚æ•°ç»„ï¼ˆå›ºå®šå¤§å°å­—èŠ‚æ•°ç»„ï¼‰
<ol><li><code>bytes1</code> - <code>bytes32</code></li></ol></li> <li>Enum:æšä¸¾</li> <li>åœ°å€ï¼ˆAddressï¼‰</li> <li>åˆçº¦ç±»å‹</li> <li>å‡½æ•°ï¼ˆFunction Typesï¼‰
<ol><li>æ¯”è¾ƒç‰¹æ®Šï¼Œå•ç‹¬å¼€äº†ä¸€ç« è¯´æ˜</li></ol></li></ol> <h3 id="_1-boolean-å¸ƒå°”ç±»å‹"><a href="#_1-boolean-å¸ƒå°”ç±»å‹" class="header-anchor">#</a> 1.Boolean å¸ƒå°”ç±»å‹</h3> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-3"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-3" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=15" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: Boolean å¸ƒå°”ç±»å‹</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=yZzxfnmH-Yw&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=15" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: Boolean å¸ƒå°”ç±»å‹</a></li></ul> <p>å¸ƒå°”å‹ä½¿ç”¨ <code>bool</code>è¡¨ç¤ºï¼Œè¯¥ç±»å‹åªæœ‰ä¸¤ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯ <code>true</code>/<code>false</code>ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo1 {
    bool public t = true;
    bool public f = false;
}
</code></pre></div><p>å¸ƒå°”å€¼é™¤äº†èµ‹å€¼å¾—åˆ°å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡<strong>è¿ç®—ç¬¦</strong>çš„è®¡ç®—ç»“æœå¾—åˆ°ã€‚</p> <h4 id="â“µ-æ”¯æŒçš„è¿ç®—ç¬¦"><a href="#â“µ-æ”¯æŒçš„è¿ç®—ç¬¦" class="header-anchor">#</a> â“µ æ”¯æŒçš„è¿ç®—ç¬¦</h4> <ul><li>åŒ…æ‹¬ï¼š<code>!</code>é€»è¾‘éï¼Œ</li> <li><code>==</code>ç­‰äºï¼Œ<code>!=</code> ä¸ç­‰äº;</li> <li><code>&amp;&amp;</code>é€»è¾‘ä¸ï¼Œ<code>||</code>é€»è¾‘æˆ–ï¼Œ
<ul><li><code>&amp;&amp;</code>ï¼Œ<code>||</code> ä¸ºçŸ­è·¯è¿ç®—ç¬¦ã€‚</li></ul></li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo2 {
    bool public a = false;
    bool public b = !a; // ä»…ç”¨äºå¸ƒå°”å€¼
    bool public c = a == b;
    bool public d = a != b;
    bool public e = a &amp;&amp; b;
    bool public f = a || b;
}
</code></pre></div><p>è¿ç®—ç¬¦ <code>||</code> å’Œ <code>&amp;&amp;</code> éƒ½éµå¾ªåŒæ ·çš„çŸ­è·¯ï¼ˆ short-circuiting ï¼‰è§„åˆ™ã€‚å°±æ˜¯è¯´åœ¨è¡¨è¾¾å¼ <code>f(x) || g(y)</code> ä¸­ï¼Œ å¦‚æœ <code>f(x)</code> çš„å€¼ä¸º true ï¼Œé‚£ä¹ˆ <code>g(y)</code> å°±ä¸ä¼šè¢«æ‰§è¡Œï¼Œ</p> <h4 id="â“¶-ä½¿ç”¨çŸ­è·¯è§„åˆ™èŠ‚çœ-gas"><a href="#â“¶-ä½¿ç”¨çŸ­è·¯è§„åˆ™èŠ‚çœ-gas" class="header-anchor">#</a> â“¶ ä½¿ç”¨çŸ­è·¯è§„åˆ™èŠ‚çœ gas</h4> <p>å€ŸåŠ©çŸ­è·¯è§„åˆ™ï¼Œå¯ä»¥è®©åˆçº¦å°‘æ‰§è¡Œä¸€äº›é€»è¾‘ã€‚</p> <ul><li><code>||</code> å¦‚æœç¬¬ä¸€ä¸ªè¡¨è¾¾å¼æ˜¯<code>true</code>ï¼Œåˆ™ç¬¬äºŒä¸ªè¡¨è¾¾å¼ä¸å†æ‰§è¡Œã€‚ï¼ˆå› ä¸ºä¸¤ä¸ªè¡¨è¾¾å¼æœ‰ä¸€ä¸ªä¸º trueï¼Œç»“æœå°±ä¸º trueï¼Œä¸éœ€è¦è®¡ç®—ç¬¬äºŒä¸ªè¡¨è¾¾å¼å°±çŸ¥é“ç»“æœäº†ï¼‰</li> <li><code>&amp;&amp;</code> å¦‚æœç¬¬ä¸€ä¸ªè¡¨è¾¾å¼æ˜¯<code>false</code>ï¼Œåˆ™ç¬¬äºŒä¸ªè¡¨è¾¾å¼ä¸å†æ‰§è¡Œã€‚ï¼ˆä¸¤ä¸ªè¡¨è¾¾å¼å¿…é¡»éƒ½ä¸º trueï¼Œç»“æœæ‰èƒ½ trueï¼Œå¦‚æœç¬¬ä¸€ä¸ªä¸º falseï¼Œä¸éœ€è¦è®¡ç®—ç¬¬äºŒä¸ªè¡¨è¾¾å¼å°±çŸ¥é“ç»“æœäº†ï¼‰</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.16;

contract Demo3 {
    // 21488 gas
    function testA1() external pure returns (bool) {
        uint256 a = 100 - 99;
        uint256 b = 100 - 1;
        if (a &gt; 50 || b &lt; 50) {
            return true;
        }
        return false;
    }

    // 21440 gas
    function testA2() external pure returns (bool) {
        if ((100 - 99) &gt; 50 || (100 - 10) &lt; 50) {
            return true;
        }
        return false;
    }
}
</code></pre></div><p><span style="color:red;">æœ¬ç« ä¸»è¦ä»‹ç»æ•°æ®ç±»å‹ï¼Œåç»­ä»‹ç»æ•°æ®ç±»å‹çš„æ—¶ä¸å†ä»‹ç»æ“ä½œç¬¦ï¼Œä¼šä¸“é—¨æœ‰ä¸€ç« æ¥æ€»ç»“æ“ä½œç¬¦ã€‚</span></p> <h3 id="_2-integer-æ•´æ•°ç±»å‹"><a href="#_2-integer-æ•´æ•°ç±»å‹" class="header-anchor">#</a> 2.Integer æ•´æ•°ç±»å‹</h3> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-4"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-4" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=16" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: Integer æ•´æ•°ç±»å‹</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=_VpKWN_NdnU&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=16" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: Integer æ•´æ•°ç±»å‹</a></li></ul> <p>æ•´æ•°ç±»å‹åˆ†ä¸ºæœ‰ç¬¦å·æ•´å‹ï¼Œç”¨ int æ ‡ç¤ºï¼›å’Œæ— ç¬¦å·æ•´å‹ï¼Œç”¨ uint æ ‡ç¤ºï¼›</p> <p><strong>int å’Œ uint</strong>:</p> <table border="1" class="docutils"><thead><tr><th>ç±»å‹</th> <th>ç¬¦å·å</th> <th>å–å€¼</th></tr></thead> <tbody><tr><td rowspan="4">æ•´å‹</td> <td>int8 to int256</td> <td>8 ä½åˆ° 256 ä½çš„å¸¦ç¬¦å·æ•´å‹æ•°ã€‚</td></tr> <tr><td>uint8 to uint256</td> <td>8 ä½åˆ° 256 ä½çš„æ— ç¬¦å·æ•´å‹ã€‚</td></tr> <tr><td>int</td> <td>æœ‰ç¬¦å·æ•´æ•°ï¼Œint ä¸  int256 ç›¸åŒã€‚</td></tr> <tr><td>uint</td> <td>æ— ç¬¦å·æ•´æ•°ï¼Œuint å’Œ uint256 æ˜¯ä¸€æ ·çš„ã€‚</td></tr> <tr><td rowspan="4">å®šé•¿æµ®ç‚¹å‹</td> <td>fixed</td> <td>æœ‰ç¬¦å·çš„å®šé•¿æµ®ç‚¹å‹</td></tr> <tr><td>unfixed</td> <td>æ— ç¬¦å·çš„å®šé•¿æµ®ç‚¹å‹</td></tr> <tr></tr></tbody></table> <ul><li>int æ˜¯æœ‰ç¬¦å·æ•´å‹ï¼Œæ”¯æŒ int8 åˆ° int256ã€‚</li> <li>uint æ˜¯æ— ç¬¦å·æ•´å‹ï¼Œæ”¯æŒä» uint8 åˆ° uint256ã€‚</li> <li><code>uint</code> å’Œ <code>int</code> åˆ†åˆ«æ˜¯ <code>uint256</code> å’Œ <code>int256</code> çš„åˆ«åã€‚</li></ul> <h4 id="â“µ-å±æ€§"><a href="#â“µ-å±æ€§" class="header-anchor">#</a> â“µ å±æ€§</h4> <p>å¯¹äºæ•´å‹ T æœ‰ä¸‹é¢çš„å…¨å±€å±æ€§å¯è®¿é—®ï¼š</p> <ul><li><code>type(T).min</code> <ul><li>è·å–æ•´å‹ T çš„æœ€å°å€¼ã€‚</li></ul></li> <li><code>type(T).max</code> <ul><li>è·å–æ•´å‹ T çš„æœ€å¤§å€¼ã€‚</li></ul></li></ul> <h4 id="â“¶-uint-ç±»å‹"><a href="#â“¶-uint-ç±»å‹" class="header-anchor">#</a> â“¶ uint ç±»å‹</h4> <p>uint æ— ç¬¦å·æ•´æ•°ï¼Œåªèƒ½è¡¨ç¤ºéè´Ÿæ•°ï¼›<code>åŒ…æ‹¬æ•°å­—0</code>ï¼›å…¶ä¸­ uint256 ä¸ uint ç›¸åŒï¼Œæ¨èä½¿ç”¨ uint256ï¼›æ”¯æŒ int8 åˆ° int256ï¼Œåé¢çš„æ•°å­—æ˜¯ 8 çš„å€æ•°ã€‚</p> <ul><li><code>uint8</code>: æœ€å°å€¼æ˜¯ 0ï¼Œæœ€å¤§å€¼æ˜¯ <code>2**8-1</code></li> <li><code>uint256</code>:æœ€å°å€¼æ˜¯ 0ï¼Œæœ€å¤§å€¼æ˜¯ <code>2**256-1</code></li> <li>å¯ä»¥ä½¿ç”¨ <code>type(uint8).max</code> è·å–è¯¥ç±»å‹çš„æœ€å¤§å€¼</li> <li>å¯ä»¥ä½¿ç”¨ <code>type(uint8).min</code> è·å–è¯¥ç±»å‹çš„æœ€å°å€¼</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Data {
    // uint
    uint256 public u1 = 123;
    uint8 public u8Max = type(uint8).max; // 255 =&gt; (2**8-1)
    uint8 public u8Min = type(uint8).min; // 0

    // 115792089237316195423570985008687907853269984665640564039457584007913129639935
    uint256 public u256Max = type(uint256).max;
    uint256 public u256Min = type(uint256).min; // 0
}
</code></pre></div><p><strong>é€šè¿‡ä»£ç è·å–æ‰€æœ‰ <code>uint</code> ç±»å‹å’Œå–å€¼èŒƒå›´</strong></p> <p>é€šè¿‡åˆçº¦è·å–å…·ä½“çš„æœ€å¤§å€¼èŒƒå›´ï¼Œæœ€å°å€¼ç±»ä¼¼ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Data {
    // uint
    uint8 public u008Max = type(uint8).max;
    uint16 public u016Max = type(uint16).max;
    uint24 public u024Max = type(uint24).max;
    uint32 public u032Max = type(uint32).max;
    uint40 public u040Max = type(uint40).max;
    uint48 public u048Max = type(uint48).max;
    uint56 public u056Max = type(uint56).max;
    uint64 public u064Max = type(uint64).max;
    uint72 public u072Max = type(uint72).max;
    uint80 public u080Max = type(uint80).max;
    uint88 public u088Max = type(uint88).max;
    uint96 public u096Max = type(uint96).max;
    uint104 public u104Max = type(uint104).max;
    uint112 public u112Max = type(uint112).max;
    uint120 public u120Max = type(uint120).max;
    uint128 public u128Max = type(uint128).max;
    uint136 public u136Max = type(uint136).max;
    uint144 public u144Max = type(uint144).max;
    uint152 public u152Max = type(uint152).max;
    uint160 public u160Max = type(uint160).max;
    uint168 public u168Max = type(uint168).max;
    uint176 public u176Max = type(uint176).max;
    uint184 public u184Max = type(uint184).max;
    uint192 public u192Max = type(uint192).max;
    uint200 public u200Max = type(uint200).max;
    uint208 public u208Max = type(uint208).max;
    uint216 public u216Max = type(uint216).max;
    uint224 public u224Max = type(uint224).max;
    uint232 public u232Max = type(uint232).max;
    uint240 public u240Max = type(uint240).max;
    uint248 public u248Max = type(uint248).max;
    uint256 public u256Max = type(uint256).max;
}
</code></pre></div><p>æ‰€æœ‰ uint ç»“æœå¦‚ä¸‹ï¼š</p> <table><thead><tr><th>uintN</th> <th>å°</th> <th>æœ€å¤§å€¼</th></tr></thead> <tbody><tr><td>uint8</td> <td>0</td> <td>255</td></tr> <tr><td>uint16</td> <td>0</td> <td>65535</td></tr> <tr><td>uint24</td> <td>0</td> <td>16777215</td></tr> <tr><td>uint32</td> <td>0</td> <td>4294967295</td></tr> <tr><td>uint40</td> <td>0</td> <td>1099511627775</td></tr> <tr><td>uint48</td> <td>0</td> <td>281474976710655</td></tr> <tr><td>uint56</td> <td>0</td> <td>72057594037927935</td></tr> <tr><td>uint64</td> <td>0</td> <td>18446744073709551615</td></tr> <tr><td>uint72</td> <td>0</td> <td>4722366482869645213695</td></tr> <tr><td>uint80</td> <td>0</td> <td>1208925819614629174706175</td></tr> <tr><td>uint88</td> <td>0</td> <td>309485009821345068724781055</td></tr> <tr><td>uint96</td> <td>0</td> <td>79228162514264337593543950335</td></tr> <tr><td>uint104</td> <td>0</td> <td>20282409603651670423947251286015</td></tr> <tr><td>uint112</td> <td>0</td> <td>5192296858534827628530496329220095</td></tr> <tr><td>uint120</td> <td>0</td> <td>1329227995784915872903807060280344575</td></tr> <tr><td>uint128</td> <td>0</td> <td>340282366920938463463374607431768211455</td></tr> <tr><td>uint136</td> <td>0</td> <td>87112285931760246646623899502532662132735</td></tr> <tr><td>uint144</td> <td>0</td> <td>22300745198530623141535718272648361505980415</td></tr> <tr><td>uint152</td> <td>0</td> <td>5708990770823839524233143877797980545530986495</td></tr> <tr><td>uint160</td> <td>0</td> <td>1461501637330902918203684832716283019655932542975</td></tr> <tr><td>uint168</td> <td>0</td> <td>374144419156711147060143317175368453031918731001855</td></tr> <tr><td>uint176</td> <td>0</td> <td>95780971304118053647396689196894323976171195136475135</td></tr> <tr><td>uint184</td> <td>0</td> <td>24519928653854221733733552434404946937899825954937634815</td></tr> <tr><td>uint192</td> <td>0</td> <td>6277101735386680763835789423207666416102355444464034512895</td></tr> <tr><td>uint200</td> <td>0</td> <td>1606938044258990275541962092341162602522202993782792835301375</td></tr> <tr><td>uint208</td> <td>0</td> <td>411376139330301510538742295639337626245683966408394965837152255</td></tr> <tr><td>uint216</td> <td>0</td> <td>105312291668557186697918027683670432318895095400549111254310977535</td></tr> <tr><td>uint224</td> <td>0</td> <td>26959946667150639794667015087019630673637144422540572481103610249215</td></tr> <tr><td>uint232</td> <td>0</td> <td>6901746346790563787434755862277025452451108972170386555162524223799295</td></tr> <tr><td>uint240</td> <td>0</td> <td>1766847064778384329583297500742918515827483896875618958121606201292619775</td></tr> <tr><td>uint248</td> <td>0</td> <td>452312848583266388373324160190187140051835877600158453279131187530910662655</td></tr> <tr><td>uint256</td> <td>0</td> <td>115792089237316195423570985008687907853269984665640564039457584007913129639935</td></tr></tbody></table> <h4 id="â“·-int-ç±»å‹"><a href="#â“·-int-ç±»å‹" class="header-anchor">#</a> â“· int ç±»å‹</h4> <p>int æ˜¯æœ‰ç¬¦å·æ•´æ•°ï¼Œå…¶ä¸­ int256 ä¸ int ç›¸åŒï¼Œæ¨èä½¿ç”¨ int256ï¼› 8 ä½åˆ° 256 ä½çš„å¸¦ç¬¦å·æ•´å‹æ•°ã€‚8 çš„å€æ•°ã€‚</p> <ul><li><code>int8</code>: æœ€å°å€¼æ˜¯ <code>-(2**8/2)</code>ï¼Œæœ€å¤§å€¼æ˜¯ <code>(2**8/2)-1</code> <ul><li><code>int8</code>: æœ€å°å€¼æ˜¯ <code>-128</code>ï¼Œæœ€å¤§å€¼æ˜¯ <code>127</code></li></ul></li> <li><code>int256</code>: æœ€å°å€¼æ˜¯ <code>-(2**256/2)</code>ï¼Œæœ€å¤§å€¼æ˜¯ <code>(2**256/2)-1</code></li> <li>å¯ä»¥ä½¿ç”¨ <code>type(int8).max</code> è·å–è¯¥ç±»å‹çš„æœ€å¤§å€¼</li> <li>å¯ä»¥ä½¿ç”¨ <code>type(int8).min</code> è·å–è¯¥ç±»å‹çš„æœ€å°å€¼</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Data {
    // int
    int256 public i1 = 123;
    int256 public i2 = -123;
    int8 public i8Max = type(int8).max; // 127 =&gt; (2**8/2)-1
    int8 public i8Min = type(int8).min; // -128  =&gt; - 2**8/2
    //  57896044618658097711785492504343953926634992332820282019728792003956564819967
    int256 public i256Max = type(int256).max;
    // -57896044618658097711785492504343953926634992332820282019728792003956564819968
    int256 public i256Min = type(int256).min;
}
</code></pre></div><p><strong>è®¡ç®— int çš„æœ€å¤§å€¼å’Œæœ€å°å€¼</strong></p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Data {
    int8 public i008Max = type(int8).max;
    int16 public i016Max = type(int16).max;
    int24 public i024Max = type(int24).max;
    int32 public i032Max = type(int32).max;
    int40 public i040Max = type(int40).max;
    int48 public i048Max = type(int48).max;
    int56 public i056Max = type(int56).max;
    int64 public i064Max = type(int64).max;
    int72 public i072Max = type(int72).max;
    int80 public i080Max = type(int80).max;
    int88 public i088Max = type(int88).max;
    int96 public i096Max = type(int96).max;
    int104 public i104Max = type(int104).max;
    int112 public i112Max = type(int112).max;
    int120 public i120Max = type(int120).max;
    int128 public i128Max = type(int128).max;
    int136 public i136Max = type(int136).max;
    int144 public i144Max = type(int144).max;
    int152 public i152Max = type(int152).max;
    int160 public i160Max = type(int160).max;
    int168 public i168Max = type(int168).max;
    int176 public i176Max = type(int176).max;
    int184 public i184Max = type(int184).max;
    int192 public i192Max = type(int192).max;
    int200 public i200Max = type(int200).max;
    int208 public i208Max = type(int208).max;
    int216 public i216Max = type(int216).max;
    int224 public i224Max = type(int224).max;
    int232 public i232Max = type(int232).max;
    int240 public i240Max = type(int240).max;
    int248 public i248Max = type(int248).max;
    int256 public i256Max = type(int256).max;
}
</code></pre></div><p>æ‰€æœ‰ int ç»“æœå¦‚ä¸‹ï¼š</p> <table><thead><tr><th>intN</th> <th>æœ€å°å€¼</th> <th>æœ€å¤§å€¼</th></tr></thead> <tbody><tr><td>int8</td> <td>-128</td> <td>127</td></tr> <tr><td>int16</td> <td>-32768</td> <td>32767</td></tr> <tr><td>int24</td> <td>-8388608</td> <td>8388607</td></tr> <tr><td>int32</td> <td>-2147483648</td> <td>2147483647</td></tr> <tr><td>int40</td> <td>-549755813888</td> <td>549755813887</td></tr> <tr><td>int48</td> <td>-140737488355328</td> <td>140737488355327</td></tr> <tr><td>int56</td> <td>-36028797018963968</td> <td>36028797018963967</td></tr> <tr><td>int64</td> <td>-9223372036854775808</td> <td>9223372036854775807</td></tr> <tr><td>int72</td> <td>-2361183241434822606848</td> <td>2361183241434822606847</td></tr> <tr><td>int80</td> <td>-604462909807314587353088</td> <td>604462909807314587353087</td></tr> <tr><td>int88</td> <td>-154742504910672534362390528</td> <td>154742504910672534362390527</td></tr> <tr><td>int96</td> <td>-39614081257132168796771975168</td> <td>39614081257132168796771975167</td></tr> <tr><td>int104</td> <td>-10141204801825835211973625643008</td> <td>10141204801825835211973625643007</td></tr> <tr><td>int112</td> <td>-2596148429267413814265248164610048</td> <td>2596148429267413814265248164610047</td></tr> <tr><td>int120</td> <td>-664613997892457936451903530140172288</td> <td>664613997892457936451903530140172287</td></tr> <tr><td>int128</td> <td>-170141183460469231731687303715884105728</td> <td>170141183460469231731687303715884105727</td></tr> <tr><td>int136</td> <td>-43556142965880123323311949751266331066368</td> <td>43556142965880123323311949751266331066367</td></tr> <tr><td>int144</td> <td>-11150372599265311570767859136324180752990208</td> <td>11150372599265311570767859136324180752990207</td></tr> <tr><td>int152</td> <td>-2854495385411919762116571938898990272765493248</td> <td>2854495385411919762116571938898990272765493247</td></tr> <tr><td>int160</td> <td>-730750818665451459101842416358141509827966271488</td> <td>730750818665451459101842416358141509827966271487</td></tr> <tr><td>int168</td> <td>-187072209578355573530071658587684226515959365500928</td> <td>187072209578355573530071658587684226515959365500927</td></tr> <tr><td>int176</td> <td>-47890485652059026823698344598447161988085597568237568</td> <td>47890485652059026823698344598447161988085597568237567</td></tr> <tr><td>int184</td> <td>-12259964326927110866866776217202473468949912977468817408</td> <td>12259964326927110866866776217202473468949912977468817407</td></tr> <tr><td>int192</td> <td>-3138550867693340381917894711603833208051177722232017256448</td> <td>3138550867693340381917894711603833208051177722232017256447</td></tr> <tr><td>int200</td> <td>-803469022129495137770981046170581301261101496891396417650688</td> <td>803469022129495137770981046170581301261101496891396417650687</td></tr> <tr><td>int208</td> <td>-205688069665150755269371147819668813122841983204197482918576128</td> <td>205688069665150755269371147819668813122841983204197482918576127</td></tr> <tr><td>int216</td> <td>-52656145834278593348959013841835216159447547700274555627155488768</td> <td>52656145834278593348959013841835216159447547700274555627155488767</td></tr> <tr><td>int224</td> <td>-13479973333575319897333507543509815336818572211270286240551805124608</td> <td>13479973333575319897333507543509815336818572211270286240551805124607</td></tr> <tr><td>int232</td> <td>-3450873173395281893717377931138512726225554486085193277581262111899648</td> <td>3450873173395281893717377931138512726225554486085193277581262111899647</td></tr> <tr><td>int240</td> <td>-883423532389192164791648750371459257913741948437809479060803100646309888</td> <td>883423532389192164791648750371459257913741948437809479060803100646309887</td></tr> <tr><td>int248</td> <td>-226156424291633194186662080095093570025917938800079226639565593765455331328</td> <td>226156424291633194186662080095093570025917938800079226639565593765455331327</td></tr> <tr><td>int256</td> <td>-57896044618658097711785492504343953926634992332820282019728792003956564819968</td> <td>57896044618658097711785492504343953926634992332820282019728792003956564819967</td></tr></tbody></table> <p><strong>é—®é¢˜</strong>: ä¸ºä»€ä¹ˆ <code>uint8/int8</code>è‡³ <code>uint256/uint256</code> éƒ½æ˜¯ä»¥ 8 çš„å€æ•°é€’å¢ï¼Œä¸”æœ€å¤§å€¼æ˜¯ 256ã€‚
1 å­—èŠ‚æ˜¯ 8 ä½ï¼Œæ‰€ä»¥åé¢ 8,16,éƒ½éœ€è¦æ˜¯ 8 çš„æ•´æ•°å€ï¼Œint8 æ˜¯ 8 ä½ã€‚EVM ä¸ºåœ°å€è®¾ç½®çš„æœ€å¤§é•¿åº¦æ˜¯ 256 ä½ï¼Œæ‰€ä»¥æœ€å¤§å€¼æ˜¯<code>uint256/uint256</code>ã€‚</p> <p>è®¡ç®—ä¸­æœ€å°ä¸€çº§çš„ä¿¡æ¯å•ä½æ˜¯ byte å’Œ bit: <strong>å…¶ä¸­å­—èŠ‚(Byte)ä¸ºæœ€å°å­˜å‚¨å®¹é‡å•ä½</strong>ï¼Œ<strong>ä½(bit)æ˜¯æœ€å°å‚¨å­˜ä¿¡æ¯çš„å•ä½,ä¹Ÿè¢«ç§°ä¸ºæœ€å°çš„æ•°æ®ä¼ è¾“å•ä½</strong>ï¼›ä¸€ä¸ªä½å°±ä»£è¡¨ä¸€ä¸ª 0 æˆ– 1ï¼ˆå³äºŒè¿›åˆ¶ï¼‰ï¼›æ¯ 8 ä¸ª bit(ç®€å†™ä¸º bï¼‰ç»„æˆä¸€ä¸ªå­—èŠ‚ Byteï¼ˆç®€å†™ä¸º Bï¼‰ï¼›æ‰€ä»¥ <code>uint256</code> å’Œ <code>bytes32</code> å¯ä»¥è½¬æ¢</p> <ul><li><code>bytes1 å¯¹åº” uint8</code></li> <li><code>bytes2 å¯¹åº” uint16</code></li> <li>...</li> <li><code>bytes32 å¯¹åº” uint256</code></li></ul> <p><strong>é—®é¢˜</strong>: ä¸ºä»€ä¹ˆ int8 çš„å–å€¼èŒƒå›´æ˜¯-128~127 å‘¢ï¼Ÿä¸ºä»€ä¹ˆ <code>uint256</code> çš„æœ€å¤§å€¼æ˜¯ <code>2**256 -1</code>ï¼Œè€Œä¸æ˜¯ <code>2**256</code> å‘¢ï¼Ÿ</p> <p>1 å­—èŠ‚æ˜¯ 8 ä½ï¼Œint8 æ˜¯ 8 ä½ï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºä¸º<code>0000 0000</code>è‡³<code>1000 0000</code>ï¼Œç¬¬ä¸€ä½æ˜¯ç¬¦å·ä½;ç¬¬ä¸€ä½ä¸º 0 æ˜¯æ­£å€¼ï¼Œç¬¬ä¸€ä½ä¸º 1 æ˜¯è´Ÿå€¼ï¼›å› ä¸º int8 æ€»å…±èƒ½å¤Ÿè¡¨ç¤º 2 çš„ 8 æ¬¡æ–¹ï¼Œæ‰€ä»¥å¸¦ç¬¦å·çš„æ­£å€¼ä¸º 128 ä¸ªæ•°ï¼Œè´Ÿå€¼ä¸º 128 ä¸ªæ•°ï¼›</p> <p>è®¡ç®—æœºé‡Œæ˜¯å°† 0 ç®—åœ¨æ­£å€¼å†…ï¼Œè´Ÿå€¼çš„èŒƒå›´è¿˜æ˜¯-128ï¼›ä½†æ˜¯ <strong>0 ä¸æ˜¯æ­£æ•°ä¹Ÿä¸æ˜¯è´Ÿæ•°</strong>ï¼Œæ‰€ä»¥æ­£å€¼èŒƒå›´å°‘äº†ä¸€ä¸ªä½ç½®ï¼Œå°±å‰© 127 ä¸ªä½ç½®äº†ã€‚</p> <p><strong>é—®é¢˜</strong>: å­—èŠ‚ &amp; bit &amp; åå…­è¿›åˆ¶æ•°å­—å…³ç³»</p> <ul><li>bytes1 æ˜¯æŒ‡ 1 ä¸ªå­—èŠ‚ï¼Œ1 ä¸ªå­—èŠ‚å¯ä»¥è¡¨ç¤ºæˆ 2 ä¸ªè¿ç»­çš„ 16 è¿›åˆ¶æ•°å­—ã€‚æœ€å¤§å€¼æ˜¯ <code>0xff</code></li> <li>bytes1 æ˜¯æŒ‡ 1 ä¸ªå­—èŠ‚ï¼Œ1 ä¸ªå­—èŠ‚å¯ä»¥è¡¨ç¤ºæˆ 8 ä¸ªè¿ç»­çš„ bit æ•°å­—ã€‚æœ€å¤§å€¼æ˜¯ <code>11111111</code> <ul><li><code>bytes1</code> ç­‰äºä¸¤ä½è¿ç»­çš„åå…­è¿›åˆ¶æ•°å­— <code>0xXX</code></li></ul></li> <li>8 ä¸ª bit æœ€å¤§å€¼æ˜¯ <code>11111111</code>,8 ä¸ª bit å¯¹åº” 2 ä¸ªè¿ç»­çš„åå…­è¿›åˆ¶æ•°å­—ï¼Œæœ€å¤§æ˜¯ <code>0xff</code>;
<ul><li><code>uint8</code> ç­‰äºä¸¤ä½è¿ç»­çš„åå…­è¿›åˆ¶æ•°å­— <code>0xXX</code></li></ul></li></ul> <h4 id="â“¸-checked-æ¨¡å¼"><a href="#â“¸-checked-æ¨¡å¼" class="header-anchor">#</a> â“¸ checked æ¨¡å¼</h4> <p>âš ï¸: åœ¨ Solidity ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œå½“å¯¹æ— é™åˆ¶æ•´æ•°æ‰§è¡Œç®—æœ¯è¿ç®—ï¼Œå…¶ç»“æœè¶…å‡ºç»“æœç±»å‹çš„èŒƒå›´ï¼Œè¿™æ˜¯å°±å‘ç”Ÿäº†ä¸Šæº¢å‡ºæˆ–ä¸‹æº¢å‡ºã€‚åœ¨ Solidity 0.8.0 ä¹‹å‰ï¼Œç®—æœ¯è¿ç®—æ€»æ˜¯ä¼šåœ¨å‘ç”Ÿæº¢å‡ºçš„æƒ…å†µä¸‹è¿›è¡Œâ€œæˆªæ–­â€ï¼Œè€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸ã€‚è¿™å°±ä¼šå¯¼è‡´ä¸€äº›éº»çƒ¦çš„äº‹æƒ…ï¼Œå¯èƒ½å¯¼è‡´æœªçŸ¥çš„é”™è¯¯ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¾—ä¸é å¼•å…¥é¢å¤–æ£€æŸ¥åº“æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ˆæœ€å¸¸è§çš„å¦‚ OpenZepplin çš„ SafeMathï¼‰</p> <p>è€Œä» <code>Solidity 0.8.0</code> å¼€å§‹ï¼Œæ‰€æœ‰çš„ç®—æœ¯è¿ç®—é»˜è®¤å°±ä¼šè¿›è¡Œæº¢å‡ºæ£€æŸ¥ï¼Œé¢å¤–å¼•å…¥åº“å°†ä¸å†å¿…è¦ã€‚0.8.0 å¼€å§‹ï¼Œç®—æœ¯è¿ç®—æœ‰ä¸¤ç§è®¡ç®—æ¨¡å¼ï¼šä¸€ç§æ˜¯<code>checked</code>ï¼ˆæ£€æŸ¥ï¼‰æ¨¡å¼ï¼Œå¦ä¸€ç§æ˜¯ <code>unchecked</code>ï¼ˆä¸æ£€æŸ¥ï¼‰æ¨¡å¼ã€‚</p> <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œç®—æœ¯è¿ç®—åœ¨ <code>checked</code> æ¨¡å¼ä¸‹ï¼Œå³éƒ½ä¼šè¿›è¡Œæº¢å‡ºæ£€æŸ¥ï¼Œå¦‚æœç»“æœè½åœ¨å–å€¼èŒƒå›´ä¹‹å¤–ï¼Œè°ƒç”¨ä¼šé€šè¿‡ å¤±è´¥å¼‚å¸¸ å›é€€ã€‚</p> <p>ä½ ä¹Ÿå¯ä»¥é€šè¿‡ <code>unchecked{ ... }</code> åˆ‡æ¢åˆ° â€œuncheckedâ€æ¨¡å¼ï¼Œæ›´å¤šå¯å‚è€ƒ <code>unchecked</code> .</p> <h4 id="â“¹-unchecked-éæ£€æŸ¥æ¨¡å¼"><a href="#â“¹-unchecked-éæ£€æŸ¥æ¨¡å¼" class="header-anchor">#</a> â“¹ unchecked éæ£€æŸ¥æ¨¡å¼</h4> <p>å¦‚æœä¾ç„¶æƒ³è¦ä¹‹å‰â€œæˆªæ–­â€çš„æ•ˆæœï¼Œè€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸é”™è¯¯ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ <code>unchecked{}</code> ä»£ç å—ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract C {
    uint256 public a = type(uint256).max;
    uint8 public b = 1;

    function f1() public view returns (uint256) {
        // å‡æ³•æº¢å‡ºä¼šè¿”å›â€œæˆªæ–­â€çš„ç»“æœ
        unchecked {
            return a + b;
        }
    }

    function f2() public view returns (uint256) {
        unchecked {
            return a + 2;
        }
    }

    function g() public view returns (uint256) {
        // æº¢å‡ºä¼šæŠ›å‡ºå¼‚å¸¸
        return a + b;
    }
}
</code></pre></div><p>è°ƒç”¨ <code>g()</code> ä¼šè§¦å‘å¤±è´¥å¼‚å¸¸ï¼Œ è°ƒç”¨ <code>f1()/f2()</code> åˆ†åˆ«æ˜¯æˆªæ–­æ•ˆæœ,</p> <p>âš ï¸: <code>unchecked</code> ä»£ç å—å¯ä»¥åœ¨ä»£ç å—ä¸­çš„ä»»ä½•ä½ç½®ä½¿ç”¨ï¼Œä½†ä¸å¯ä»¥æ›¿ä»£æ•´ä¸ªå‡½æ•°ä»£ç å—ï¼ŒåŒæ ·ä¸å¯ä»¥åµŒå¥—ã€‚åˆ‡æ­¤è®¾ç½®ä»…å½±å“è¯­æ³•ä¸Šä½äº <code>unchecked</code> å—å†…çš„è¯­å¥ã€‚ åœ¨å—ä¸­è°ƒç”¨çš„å‡½æ•°ä¸ä¼šæ­¤å½±å“ã€‚</p> <p>âš ï¸: ä¸ºé¿å…æ­§ä¹‰ï¼Œä¸èƒ½åœ¨ unchecked å—ä¸­ä½¿ç”¨ <code>_;</code>, è¯¥è¡¨ç¤ºæ–¹æ³•ä»…ç”¨äºå‡½æ•°ä¿®æ”¹å™¨ã€‚</p> <h5 id="è§¦å‘æº¢å‡ºæ£€æŸ¥çš„è¿ç®—ç¬¦"><a href="#è§¦å‘æº¢å‡ºæ£€æŸ¥çš„è¿ç®—ç¬¦" class="header-anchor">#</a> è§¦å‘æº¢å‡ºæ£€æŸ¥çš„è¿ç®—ç¬¦</h5> <p>ä¸‹é¢çš„è¿™ä¸ªè¿ç®—æ“ä½œç¬¦ä¼šè¿›è¡Œæº¢å‡ºæ£€æŸ¥ï¼Œå¦‚æœä¸Šæº¢å‡ºæˆ–ä¸‹æº¢ä¼šè§¦å‘å¤±è´¥å¼‚å¸¸ã€‚ å¦‚æœåœ¨éæ£€æŸ¥æ¨¡å¼ä»£ç å—ä¸­ä½¿ç”¨ï¼Œå°†ä¸ä¼šå‡ºç°é”™è¯¯:</p> <p><code>++</code>, <code>--</code>, <code>+</code>, <code>å‡ -</code>, <code>è´Ÿ -</code>, <code>*</code>, <code>/</code>, <code>%</code>, <code>**</code></p> <p><code>+=</code>,<code>-=</code>, <code>*=</code>, <code>/=</code>, <code>%=</code></p> <h5 id="é™¤-0-æˆ–é™¤-0å–æ¨¡"><a href="#é™¤-0-æˆ–é™¤-0å–æ¨¡" class="header-anchor">#</a> é™¤ <code>0</code>ï¼ˆæˆ–<code>é™¤ 0å–æ¨¡</code>ï¼‰</h5> <p><strong>âš ï¸ è­¦å‘Š</strong>: é™¤ <code>0</code>ï¼ˆæˆ–<code>é™¤ 0å–æ¨¡</code>ï¼‰çš„å¼‚å¸¸æ˜¯ä¸èƒ½è¢« <code>unchecked</code> å¿½ç•¥çš„ã€‚ä¼šå‘ç”Ÿ <code>Panic</code> é”™è¯¯ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.17;

contract C {
    uint256 public a = type(uint256).max;

    function f1() public view returns (uint256) {
        unchecked {
            return a / 0;
        }
    }

    function f2() public view returns (uint256) {
        unchecked {
            return a % 0;
        }
    }
}
</code></pre></div><h5 id="ä½è¿ç®—ä¸ä¼šæ‰§è¡Œä¸Šæº¢æˆ–ä¸‹æº¢æ£€æŸ¥"><a href="#ä½è¿ç®—ä¸ä¼šæ‰§è¡Œä¸Šæº¢æˆ–ä¸‹æº¢æ£€æŸ¥" class="header-anchor">#</a> ä½è¿ç®—ä¸ä¼šæ‰§è¡Œä¸Šæº¢æˆ–ä¸‹æº¢æ£€æŸ¥</h5> <p><strong>âš ï¸ æ³¨è§£</strong>: ä½è¿ç®—ä¸ä¼šæ‰§è¡Œä¸Šæº¢æˆ–ä¸‹æº¢æ£€æŸ¥ã€‚ è¿™åœ¨ä½¿ç”¨ä½ç§»ä½(<code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>&lt;&lt;=</code>, <code>&gt;&gt;=</code>)æ¥ä»£æ›¿æ•´æ•°é™¤æ³•å’Œ 2 æŒ‡æ•°æ—¶å°¤å…¶æ˜æ˜¾ã€‚ ä¾‹å¦‚ <code>type(uint256).max &lt;&lt; 3</code> ä¸ä¼šå›é€€ï¼Œè€Œ <code>type(uint256).max + 1</code> ä¼šå¤±è´¥å›é€€ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract C {
    uint256 public a = type(uint256).max;
    uint8 public b = 1;

    function g1() public view returns (uint256) {
        return a + b;
    }

    function g2() public view returns (uint256) {
        return a &lt;&lt; 3;
    }
}
</code></pre></div><h5 id="int-å€¼éœ€è¦æ³¨æ„"><a href="#int-å€¼éœ€è¦æ³¨æ„" class="header-anchor">#</a> -int å€¼éœ€è¦æ³¨æ„</h5> <p><strong>æ³¨è§£</strong> <code>int x = type(int).min; -x;</code> ä¸­çš„ç¬¬ 2 å¥ä¼šæº¢å‡ºï¼Œå› ä¸ºè´Ÿæ•°çš„èŒƒå›´æ¯”æ­£æ•´æ•°çš„èŒƒå›´å¤§ 1ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract C {
    int256 x = type(int256).min;
    int256 y = -1;

    function fn1() public view returns (int256) {
        unchecked {
            return -x;
        }
    }

    // æº¢å‡º
    function fn2() public view returns (int256) {
        return -x;
    }

    function fn3() public view returns (int256) {
        return -y;
    }
}
</code></pre></div><p>æ˜¾å¼ç±»å‹è½¬æ¢å°†å§‹ç»ˆæˆªæ–­å¹¶ä¸”ä¸ä¼šå¯¼è‡´å¤±è´¥çš„æ–­è¨€ï¼Œä½†æ˜¯ä»æ•´æ•°åˆ°æšä¸¾ç±»å‹çš„è½¬æ¢ä¾‹å¤–ã€‚</p> <h5 id="æ˜¾å¼ç±»å‹è½¬æ¢"><a href="#æ˜¾å¼ç±»å‹è½¬æ¢" class="header-anchor">#</a> æ˜¾å¼ç±»å‹è½¬æ¢</h5> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract C {
    uint256 public a = type(uint256).max;
    uint8 public b = uint8(a);
}
</code></pre></div><h3 id="_3-integer-æ•´æ•°å­—é¢å¸¸é‡"><a href="#_3-integer-æ•´æ•°å­—é¢å¸¸é‡" class="header-anchor">#</a> 3.Integer æ•´æ•°å­—é¢å¸¸é‡</h3> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-5"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-5" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=17" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: æ•´æ•°å­—é¢å¸¸é‡</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=5MiIZaaBbnU&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=17" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: æ•´æ•°å­—é¢å¸¸é‡</a></li></ul> <h4 id="â“µ-æ•´æ•°å­—é¢å¸¸é‡ä¸­ç”¨-å¢åŠ å¯è¯»æ€§"><a href="#â“µ-æ•´æ•°å­—é¢å¸¸é‡ä¸­ç”¨-å¢åŠ å¯è¯»æ€§" class="header-anchor">#</a> â“µ æ•´æ•°å­—é¢å¸¸é‡ä¸­ç”¨<code>_</code>å¢åŠ å¯è¯»æ€§</h4> <p>ä¸ºäº†æé«˜å¯è¯»æ€§å¯ä»¥åœ¨æ•°å­—ä¹‹é—´åŠ ä¸Šä¸‹åˆ’çº¿ã€‚ ä¾‹å¦‚ï¼Œåè¿›åˆ¶ <code>123_000</code>ï¼Œåå…­è¿›åˆ¶ <code>0x2eff_abde</code>ï¼Œç§‘å­¦åè¿›åˆ¶è¡¨ç¤º <code>1_2e12</code> éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚</p> <p>éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p> <ul><li>ä¸‹åˆ’çº¿ä»…å…è®¸åœ¨ä¸¤ä½æ•°ä¹‹é—´ï¼Œå¹¶ä¸”ä¸å…è®¸ä¸‹åˆ’çº¿è¿ç»­å‡ºç°ã€‚</li> <li>æ·»åŠ åˆ°æ•°å­—æ–‡å­—ä¸­ä¸‹åˆ’çº¿æ²¡æœ‰é¢å¤–çš„è¯­ä¹‰ï¼Œä»…ä»…åªæ˜¯ä¸ºäº†å¯è¯»æ€§.</li> <li>ä¸‹åˆ’çº¿ä¼šè¢«ç¼–è¯‘å™¨å¿½ç•¥ã€‚</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo{
    uint public count1 = 123_456_789; // 23503 gas
    uint public count2 = 123_456_789; // 23493 gas
    uint public count3 = 123456789; // 23537 gas
    int public count4 = -123456789; // 23559 gas
    int public count5 = -123_456_789; // 23471 gas
}
</code></pre></div><p>é€šè¿‡æµ‹è¯•å‘ç°ï¼Œå¸¦æœ‰<code>_</code>æ•°å­—çš„å˜é‡ï¼Œè¯»å–æ—¶å€™èŠ±è´¹ gas æ›´å°‘</p> <h4 id="â“¶-å­—é¢å¸¸é‡æ”¯æŒä»»æ„ç²¾åº¦"><a href="#â“¶-å­—é¢å¸¸é‡æ”¯æŒä»»æ„ç²¾åº¦" class="header-anchor">#</a> â“¶ å­—é¢å¸¸é‡æ”¯æŒä»»æ„ç²¾åº¦</h4> <p>æ•°å€¼å­—é¢å¸¸é‡è¡¨è¾¾å¼æœ¬èº«æ”¯æŒä»»æ„ç²¾åº¦ï¼Œç›´åˆ°è¢«è½¬æ¢æˆäº†éå¸¸é‡ç±»å‹ï¼ˆä¾‹å¦‚ï¼Œåœ¨å¸¸é‡å˜é‡è¡¨è¾¾å¼ä¹‹å¤–æœ‰è¿ç®—ï¼Œæˆ–å‘ç”Ÿäº†æ˜¾ç¤ºè½¬æ¢ï¼‰ã€‚ è¿™æ„å‘³ç€åœ¨æ•°å€¼å¸¸é‡è¡¨è¾¾å¼ä¸­, è®¡ç®—ä¸ä¼šæº¢å‡ºè€Œé™¤æ³•ä¹Ÿä¸ä¼šæˆªæ–­ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    uint8 public a = (2**800 + 1) - 2**800;
    uint8 public b = 0.5 * 8;
}
</code></pre></div><p><code>(2**800 + 1) - 2**800</code> çš„ç»“æœæ˜¯å­—é¢å¸¸é‡ 1 ï¼ˆå±äº uint8 ç±»å‹ï¼‰ï¼Œå°½ç®¡è®¡ç®—çš„ä¸­é—´ç»“æœå·²ç»è¶…è¿‡äº† ä»¥å¤ªåŠè™šæ‹Ÿæœºçš„æœºå™¨å­—é•¿åº¦ã€‚ æ­¤å¤–ï¼Œ <code>.5 * 8</code> çš„ç»“æœæ˜¯æ•´å‹ <code>4</code> ï¼ˆå°½ç®¡æœ‰éæ•´å‹å‚ä¸äº†è®¡ç®—ï¼‰ã€‚</p> <p>âš ï¸: æ•° å€¼å­—é¢å¸¸é‡è¡¨è¾¾å¼åªè¦åœ¨éå­—é¢å¸¸é‡è¡¨è¾¾å¼ä¸­ä½¿ç”¨å°±ä¼šè½¬æ¢æˆéå­—é¢å¸¸é‡ç±»å‹ã€‚ åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œå°½ç®¡æˆ‘ä»¬çŸ¥é“ b çš„å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä½† <code>2.5 + a</code> è¿™éƒ¨åˆ†è¡¨è¾¾å¼å¹¶ä¸è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œå› æ­¤ç¼–è¯‘ä¸èƒ½é€šè¿‡ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>uint128 a = 1;
uint128 b = 2.5 + a + 0.5;
</code></pre></div><h4 id="â“·-é™¤æ³•æˆªæ–­"><a href="#â“·-é™¤æ³•æˆªæ–­" class="header-anchor">#</a> â“· é™¤æ³•æˆªæ–­</h4> <p>æ³¨æ„é™¤æ³•æˆªæ–­: åœ¨æ™ºèƒ½åˆçº¦ä¸­ï¼Œåœ¨ å­—é¢å¸¸é‡ ä¼šä¿ç•™ç²¾åº¦ï¼ˆä¿ç•™å°æ•°ä½ï¼‰ã€‚</p> <p>æ•´æ•°çš„é™¤æ³•ä¼šè¢«æˆªæ–­ï¼ˆä¾‹å¦‚ï¼š<code>1/4</code> ç»“æœä¸º 0ï¼‰,ä½†æ˜¯ä½¿ç”¨å­—é¢é‡çš„æ–¹å¼ä¸ä¼šè¢«æˆªæ–­</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract IntegerTest {
    function test1() public pure returns (uint256, uint256) {
        uint256 a = 1;
        uint256 b = 4;
        uint256 c1 = (1 / 4) * 4; // 1 =&gt; æœªæˆªæ–­
        uint256 c2 = (a / b) * b; // 0 =&gt; æˆªæ–­
        return (c1, c2);
    }

    function test2() public pure returns (int256, int256) {
        int256 a = -1;
        int256 b = -4;
        int256 c1 = (-1 / -4) * (-4); // -1 =&gt; æœªæˆªæ–­
        int256 c2 = (a / b) * b; // 0 =&gt; æˆªæ–­
        return (c1, c2);
    }
}
</code></pre></div><p>æ³¨é‡Š: è¡¨è¾¾å¼ <code>type(int).min / (-1)</code> æ˜¯ä»…æœ‰çš„æ•´é™¤ä¼šå‘ç”Ÿå‘ä¸Šæº¢å‡ºçš„æƒ…å†µã€‚ åœ¨ç®—æœ¯æ£€æŸ¥æ¨¡å¼ä¸‹ï¼Œè¿™ä¼šè§¦å‘ä¸€ä¸ªå¤±è´¥å¼‚å¸¸ï¼Œåœ¨æˆªæ–­æ¨¡å¼ä¸‹ï¼Œè¡¨è¾¾å¼çš„å€¼å°†æ˜¯ <code>type(int).min</code> ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    function test1() public pure returns (int256 a) {
        a = type(int256).min / (-2);
    }

    // VM error: revert.
    function test2() public pure returns (int256 a) {
        a = type(int256).min / (-1);
    }

    function test3() public pure returns (int256 a) {
        unchecked {
            a = type(int256).min / (-1);
        }
    }
}
</code></pre></div><h4 id="â“¸-ä¼˜å…ˆä½¿ç”¨è¾ƒå°ç±»å‹è®¡ç®—"><a href="#â“¸-ä¼˜å…ˆä½¿ç”¨è¾ƒå°ç±»å‹è®¡ç®—" class="header-anchor">#</a> â“¸ ä¼˜å…ˆä½¿ç”¨è¾ƒå°ç±»å‹è®¡ç®—</h4> <p>è™½ç„¶å¤§å¤šæ•°è¿ç®—ç¬¦åœ¨å­—é¢å¸¸é‡è¿ç®—æ—¶éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªå­—é¢å¸¸é‡è¡¨è¾¾å¼ï¼Œä½†æœ‰ä¸€äº›è¿ç®—ç¬¦å¹¶ä¸éµå¾ªè¿™ç§æ¨¡å¼ï¼š</p> <ul><li>ä¸‰å…ƒè¿ç®—ç¬¦ <code>(... ? ... : ...)</code>,</li> <li>æ•°ç»„ä¸‹æ ‡è®¿é—® (<code>&lt;array&gt;[&lt;index&gt;]</code>).</li></ul> <p>ä½ å¯èƒ½è®¤ä¸ºåƒ<code>255 + (true ? 1 : 0)</code> æˆ– <code>255 + [1, 2, 3][0]</code> è¿™æ ·çš„è¡¨è¾¾å¼ç­‰åŒäºç›´æ¥ä½¿ç”¨ 256 å­—é¢å¸¸é‡ã€‚ ä½†äº‹å®ä¸Šï¼Œå®ƒä»¬æ˜¯åœ¨ <code>uint8</code> ç±»å‹ä¸­è®¡ç®—çš„ï¼Œä¼šæº¢å‡ºã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    // VM error: revert.
    function testA1() public pure returns (uint256 a) {
        a = 255 + (true ? 1 : 0);
    }

    function testA2() public pure returns (uint256 a) {
        a = (true ? 1 : 0) + 255;
    }

    // VM error: revert.
    function testB1() public pure returns (uint256 a) {
        a = 255 + [1, 2, 3][0];
    }

    function testB2() public pure returns (uint256 a) {
        a = [1, 2, 3][0] + 255;
    }

    function testA3() public pure returns (uint256 a) {
        a = 255 + uint256(true ? 1 : 0);
    }

    function testB3() public pure returns (uint256 a) {
        a = 255 + uint256([1, 2, 3][0]);
    }
}
</code></pre></div><h3 id="_4-fixed-å®šé•¿æµ®ç‚¹å‹"><a href="#_4-fixed-å®šé•¿æµ®ç‚¹å‹" class="header-anchor">#</a> 4.Fixed å®šé•¿æµ®ç‚¹å‹</h3> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-6"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-6" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=18" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: Fixed å®šé•¿æµ®ç‚¹å‹</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=7fHyXGcd72E&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=18" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: Fixed å®šé•¿æµ®ç‚¹å‹</a></li></ul> <p>Solidity è¿˜æ²¡æœ‰å®Œå…¨æ”¯æŒå®šé•¿æµ®ç‚¹å‹ã€‚</p> <p>å¯ä»¥å£°æ˜å®šé•¿æµ®ç‚¹å‹çš„å˜é‡ï¼Œä½†ä¸èƒ½ç»™å®ƒä»¬èµ‹å€¼æˆ–æŠŠå®ƒä»¬èµ‹å€¼ç»™å…¶ä»–å˜é‡ã€‚ã€‚</p> <p>å¯ä»¥é€šè¿‡ç”¨æˆ·å®šä¹‰çš„å€¼ç±»å‹çš„ wrap / unwrap æ¥æ¨¡æ‹Ÿå‡ºæ¥ï¼Œåé¢ä»‹ç»ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹æ—¶å€™ä¼šä»‹ç»ã€‚</p> <p><code>fixed / ufixed</code>ï¼šè¡¨ç¤ºå„ç§å¤§å°çš„æœ‰ç¬¦å·å’Œæ— ç¬¦å·çš„å®šé•¿æµ®ç‚¹å‹ã€‚ åœ¨å…³é”®å­— <code>ufixedMxN</code> å’Œ <code>fixedMxN</code> ä¸­ï¼Œ<code>M</code> è¡¨ç¤ºè¯¥ç±»å‹å ç”¨çš„ä½æ•°ï¼Œ<code>N</code> è¡¨ç¤ºå¯ç”¨çš„å°æ•°ä½æ•°ã€‚ <code>M</code> å¿…é¡»èƒ½æ•´é™¤ 8ï¼Œå³ 8 åˆ° 256 ä½ã€‚ <code>N</code> åˆ™å¯ä»¥æ˜¯ä» 0 åˆ° 80 ä¹‹é—´çš„ä»»æ„æ•°ã€‚</p> <h3 id="_5-bytesn-å®šé•¿å­—èŠ‚æ•°ç»„"><a href="#_5-bytesn-å®šé•¿å­—èŠ‚æ•°ç»„" class="header-anchor">#</a> 5.BytesN å®šé•¿å­—èŠ‚æ•°ç»„</h3> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-7"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-7" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=19" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: BytesN å®šé•¿å­—èŠ‚æ•°ç»„</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=8QqoVA-nnlY&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=19" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: BytesN å®šé•¿å­—èŠ‚æ•°ç»„</a></li></ul> <p>å®šä¹‰æ–¹å¼ <code>bytesN</code>ï¼Œå…¶ä¸­ N å¯å– <code>1~32</code> ä¸­çš„ä»»æ„æ•´æ•°;</p> <p>bytes1 ä»£è¡¨åªèƒ½å­˜å‚¨ä¸€ä¸ªå­—èŠ‚ã€‚</p> <ul><li>âš ï¸ æ³¨æ„ï¼šä¸€æ—¦å£°æ˜ï¼Œå…¶å†…éƒ¨çš„å­—èŠ‚é•¿åº¦ä¸å¯ä¿®æ”¹ï¼Œå†…éƒ¨å­—èŠ‚ä¸å¯ä¿®æ”¹ã€‚</li> <li>âš ï¸ æ³¨æ„ï¼š<code>bytes32</code> å’Œ <code>bytes</code> æ˜¯ä¸åŒçš„ã€‚
<ul><li><code>bytesN</code>: æ˜¯å®šé•¿çš„å­—èŠ‚æ•°ç»„ï¼Œæ˜¯å€¼ç±»å‹</li> <li><code>bytes</code>: æ˜¯å˜é•¿å­—èŠ‚æ•°ç»„ï¼Œæ˜¯å¼•ç”¨ç±»å‹ã€‚</li></ul></li></ul> <h4 id="â“µ-æ™®é€šèµ‹å€¼"><a href="#â“µ-æ™®é€šèµ‹å€¼" class="header-anchor">#</a> â“µ æ™®é€šèµ‹å€¼</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    // å›ºå®šé•¿åº¦çš„å­—èŠ‚æ•°ç»„
    bytes1 public a1 = 0x61;
    bytes2 public a2 = 0x6100;
    bytes4 public a3 = 0x61000000;
    bytes6 public a4 = 0x416e62616e67;
    bytes7 public a5 = 0x416e62616e6700;
    bytes8 public a6 = 0x416e62616e670000;
    bytes16 public a7 = 0x416e62616e6700000000000000000000;
    bytes32 public a8 =
        0x416e62616e670000000000000000000000000000000000000000000000000000;
}
</code></pre></div><p>æ³¨æ„è¿™é‡Œ <code>bytes32</code> å’Œ <code>bytes</code> æ˜¯ä¸åŒçš„ã€‚<code>bytes</code> æ˜¯å˜é•¿å­—èŠ‚æ•°ç»„ï¼Œæ˜¯å¼•ç”¨ç±»å‹ã€‚</p> <h4 id="â“¶-ä½¿ç”¨å­—ç¬¦ä¸²èµ‹å€¼"><a href="#â“¶-ä½¿ç”¨å­—ç¬¦ä¸²èµ‹å€¼" class="header-anchor">#</a> â“¶ ä½¿ç”¨å­—ç¬¦ä¸²èµ‹å€¼</h4> <p>è­¦å‘Š:å­—ç¬¦ä¸²å­—é¢å¸¸é‡åœ¨èµ‹å€¼ç»™ bytesN æ—¶è¢«è§£é‡Šä¸ºåŸå§‹çš„å­—èŠ‚å½¢å¼ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    bytes1 public b1 = &quot;a&quot;;
    bytes2 public b2 = &quot;a&quot;;
    bytes4 public b3 = &quot;a&quot;;
    bytes6 public b4 = &quot;Anbang&quot;;
    bytes7 public b5 = &quot;Anbang&quot;;
    bytes8 public b6 = &quot;Anbang&quot;;
    bytes16 public b7 = &quot;Anbang&quot;;
    bytes32 public b8 = &quot;Anbang&quot;;
}
</code></pre></div><h4 id="â“·-å±æ€§"><a href="#â“·-å±æ€§" class="header-anchor">#</a> â“· å±æ€§</h4> <ul><li><code>length</code> ï¼ˆåªè¯»ï¼‰
<ul><li>è¿”å›å­—èŠ‚ä¸ªæ•°ï¼Œå¯ä»¥é€šè¿‡ç´¢å¼•è¯»å–å¯¹åº”ç´¢å¼•çš„å­—èŠ‚ã€‚</li></ul></li> <li>ç´¢å¼•è®¿é—®: <code>bytesN[index]</code> <ul><li>index å–å€¼èŒƒå›´<code>[0, N]</code>ï¼Œå…¶ä¸­ N è¡¨ç¤ºé•¿åº¦ã€‚</li> <li>å¦‚æœ <code>x</code> æ˜¯ <code>bytesI</code> ç±»å‹ï¼Œé‚£ä¹ˆ <code>x[k]</code> ï¼ˆå…¶ä¸­ 0 &lt;= k &lt; Iï¼‰è¿”å›ç¬¬ k ä¸ªå­—èŠ‚ï¼ˆåªè¯»ï¼‰ã€‚</li></ul></li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    // å›ºå®šé•¿åº¦çš„å­—èŠ‚æ•°ç»„
    bytes1 public a1 = 0x61;
    bytes2 public a2 = 0x6100;

    // length
    uint256 public n1 = a1.length;
    uint256 public n2 = a2.length;

    // ç´¢å¼•
    function getIndex(uint8 index_) public view returns(bytes1){
        return a2[index_];
    }

    // ä¸ä¿®å¯ä»¥ä¿®æ”¹
    // function setIndex(uint8 index_,bytes1 value_) public view{
    //     a2[index_] = value_;
    // }
}
</code></pre></div><h3 id="_6-å­—ç¬¦ä¸²å­—é¢å¸¸é‡åŠç±»å‹"><a href="#_6-å­—ç¬¦ä¸²å­—é¢å¸¸é‡åŠç±»å‹" class="header-anchor">#</a> 6.å­—ç¬¦ä¸²å­—é¢å¸¸é‡åŠç±»å‹</h3> <p>å­—ç¬¦ä¸²å­—é¢å¸¸é‡åªèƒ½åŒ…å«å¯æ‰“å°çš„ ASCII å­—ç¬¦ï¼Œè¿™æ„å‘³ç€ä»–æ˜¯ä»‹äº 0x20 å’Œ 0x7E ä¹‹é—´çš„å­—ç¬¦ã€‚</p> <p>å­—ç¬¦ä¸²å­—é¢å¸¸é‡æ˜¯æŒ‡ç”±åŒå¼•å·æˆ–å•å¼•å·å¼•èµ·æ¥çš„å­—ç¬¦ä¸²ï¼ˆ <code>&quot;foo&quot;</code> æˆ–è€… <code>'bar'</code>ï¼‰;</p> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-8"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-8" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=20" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: å­—ç¬¦ä¸²å­—é¢å¸¸é‡åŠç±»å‹</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=MZIxm2NeHV8&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=20" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: å­—ç¬¦ä¸²å­—é¢å¸¸é‡åŠç±»å‹</a></li></ul> <h4 id="â“µ-å­—ç¬¦ä¸²å­—é¢é‡æ˜¯å€¼ç±»å‹"><a href="#â“µ-å­—ç¬¦ä¸²å­—é¢é‡æ˜¯å€¼ç±»å‹" class="header-anchor">#</a> â“µ å­—ç¬¦ä¸²å­—é¢é‡æ˜¯å€¼ç±»å‹</h4> <p>è½¬æ¢: å’Œæ•´æ•°å­—é¢å¸¸é‡ä¸€æ ·ï¼Œå­—ç¬¦ä¸²å­—é¢å¸¸é‡çš„ç±»å‹ä¹Ÿå¯ä»¥å‘ç”Ÿæ”¹å˜ï¼Œå®ƒä»¬å¯ä»¥éšå¼åœ°è½¬æ¢æˆ<code>bytes1</code>ï¼Œâ€¦â€¦ï¼Œ <code>bytes32</code>ï¼Œå¦‚æœåˆé€‚çš„è¯ï¼Œè¿˜å¯ä»¥è½¬æ¢æˆ <code>bytes</code> ä»¥åŠ <code>string</code>ã€‚</p> <p>æ¯”å¦‚ <code>bytes1 public a8 = &quot;a&quot;;</code> å’Œ <code>bytes2 public b2 = &quot;a&quot;;</code>ã€‚å­—ç¬¦ä¸²å­—é¢å¸¸é‡åœ¨èµ‹å€¼ç»™ <code>bytesN</code> æ—¶è¢«è§£é‡Šä¸º<strong>åŸå§‹çš„å­—èŠ‚å½¢å¼</strong>ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    bytes1 public b1 = &quot;a&quot;;
    string public b2 = &quot;a&quot;;
}
</code></pre></div><h4 id="â“¶-è½¬ä¹‰å­—ç¬¦"><a href="#â“¶-è½¬ä¹‰å­—ç¬¦" class="header-anchor">#</a> â“¶ è½¬ä¹‰å­—ç¬¦</h4> <p>ä½†æ˜¯æˆ‘ä»¬å†™ç‰¹æ®Šå­—ç¬¦ä¸²æ—¶å€™é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚æˆ‘æƒ³è¾“å‡ºä¸€ä¸ª <code>fo&quot;o</code>å’Œ<code>fo'o</code> çš„å­—ç¬¦ä¸²å°±å¾ˆéš¾å¼„ï¼Œå› ä¸ºè«è®¤ä¸º<code>&quot;</code>å’Œ<code>'</code> æ˜¯å­—ç¬¦ä¸²çš„ç»“å°¾ã€‚å¦‚æœæƒ³è¦è¾“å‡ºè¿™ç§ç‰¹æ®Šçš„å­—ç¬¦ä¸²ï¼Œå°±éœ€è¦è½¬ä¹‰å­—ç¬¦äº†ã€‚</p> <p>æ­¤å¤–ï¼Œå­—ç¬¦ä¸²å­—é¢å¸¸é‡æ”¯æŒä¸‹é¢çš„è½¬ä¹‰å­—ç¬¦ï¼š</p> <ul><li><code>\'</code> (å•å¼•å·)</li> <li><code>\&quot;</code> (åŒå¼•å·)</li> <li><code>\\</code> (åæ–œæ )</li> <li><code>\&lt;newline&gt;</code> (è½¬ä¹‰å®é™…æ¢è¡Œ)</li> <li><code>\b</code> (é€€æ ¼)</li> <li><code>\f</code> (æ¢é¡µ)</li> <li><code>\n</code> (æ¢è¡Œç¬¦)</li> <li><code>\r</code> (å›è½¦)</li> <li><code>\t</code> (æ ‡ç­¾ tab)</li> <li><code>\v</code> (å‚ç›´æ ‡ç­¾)</li> <li><code>\xNN</code> (åå…­è¿›åˆ¶è½¬ä¹‰ï¼Œè§ä¸‹æ–‡)</li> <li><code>\uNNNN</code> (unicode è½¬ä¹‰ï¼Œè§ä¸‹æ–‡)</li></ul> <p><code>\xNN</code> è¡¨ç¤ºä¸€ä¸ª 16 è¿›åˆ¶å€¼ï¼Œæœ€ç»ˆè½¬æ¢æˆåˆé€‚çš„å­—èŠ‚ï¼Œè€Œ <code>\uNNNN</code> è¡¨ç¤º Unicode ç¼–ç å€¼ï¼Œæœ€ç»ˆä¼šè½¬æ¢ä¸º UTF-8 çš„åºåˆ—ã€‚</p> <p>é—®ç­”é¢˜:ä¸‹é¢å­—ç¬¦ä¸²é•¿åº¦ä¸ºå¤šå°‘å­—èŠ‚ï¼Ÿ</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    string public a1 = &quot;\n\&quot;'\\abc\
def&quot;;
    bytes32 public a2 = &quot;\n\&quot;'\\abc\
def&quot;;
}
</code></pre></div><p>å­—ç¬¦ä¸²é•¿åº¦ä¸ºåä¸ªå­—èŠ‚ï¼Œå®ƒä»¥æ¢è¡Œç¬¦å¼€å¤´ï¼Œåè·ŸåŒå¼•å·ï¼Œå•å¼•å·ï¼Œåæ–œæ å­—ç¬¦ï¼Œä»¥åŠï¼ˆæ²¡æœ‰åˆ†éš”ç¬¦ï¼‰å­—ç¬¦åºåˆ— <code>&quot;'\abcdef</code> ã€‚</p> <h4 id="â“·-ç”¨ç©ºæ ¼åˆ†å¼€çš„å­—ç¬¦ä¸²"><a href="#â“·-ç”¨ç©ºæ ¼åˆ†å¼€çš„å­—ç¬¦ä¸²" class="header-anchor">#</a> â“· ç”¨ç©ºæ ¼åˆ†å¼€çš„å­—ç¬¦ä¸²</h4> <p>ç”¨ç©ºæ ¼åˆ†å¼€çš„ <code>&quot;foo&quot; &quot;bar&quot;</code> ç­‰æ•ˆäº <code>&quot;foobar&quot;</code>,</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    string public a = &quot;a&quot; &quot;b&quot;;
}
</code></pre></div><h3 id="_7-unicode-å­—é¢å¸¸é‡"><a href="#_7-unicode-å­—é¢å¸¸é‡" class="header-anchor">#</a> 7.Unicode å­—é¢å¸¸é‡</h3> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-9"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-9" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=21" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: Unicode å­—é¢å¸¸é‡</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=TXLpJPK3ZiU&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=21" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: Unicode å­—é¢å¸¸é‡</a></li></ul> <p>å¸¸è§„å­—ç¬¦ä¸²æ–‡å­—åªèƒ½åŒ…å« ASCIIï¼Œè€Œ Unicode æ–‡å­—ï¼ˆä»¥å…³é”®å­— unicode ä¸ºå‰ç¼€ï¼‰å¯ä»¥åŒ…å«ä»»ä½•æœ‰æ•ˆçš„ UTF-8 åºåˆ—ã€‚ å®ƒä»¬è¿˜æ”¯æŒä¸è½¬ä¹‰åºåˆ—å®Œå…¨ç›¸åŒçš„å­—ç¬¦ä½œä¸ºå¸¸è§„å­—ç¬¦ä¸²æ–‡å­—ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    string  public a = unicode&quot;åŒå¿—ä»¬å¥½&quot;;
}
</code></pre></div><h3 id="_8-åå…­è¿›åˆ¶å­—é¢å¸¸é‡"><a href="#_8-åå…­è¿›åˆ¶å­—é¢å¸¸é‡" class="header-anchor">#</a> 8.åå…­è¿›åˆ¶å­—é¢å¸¸é‡</h3> <p>åå…­è¿›åˆ¶å­—é¢å¸¸é‡ä»¥å…³é”®å­— <code>hex</code> æ‰“å¤´ï¼Œåé¢ç´§è·Ÿç€ç”¨å•å¼•å·æˆ–åŒå¼•å·å¼•èµ·æ¥çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ï¼Œ<code>hex&quot;001122FF&quot;</code> ï¼‰ã€‚ å­—ç¬¦ä¸²çš„å†…å®¹å¿…é¡»æ˜¯ä¸€ä¸ªåå…­è¿›åˆ¶çš„å­—ç¬¦ä¸²ï¼Œå®ƒä»¬çš„å€¼å°†ä½¿ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºã€‚</p> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-10"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-10" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=22" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: åå…­è¿›åˆ¶å­—é¢å¸¸é‡</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=kGhNA01b9AI&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=22" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: åå…­è¿›åˆ¶å­—é¢å¸¸é‡</a></li></ul> <h4 id="â“µ-åŸºæœ¬ç”¨æ³•"><a href="#â“µ-åŸºæœ¬ç”¨æ³•" class="header-anchor">#</a> â“µ åŸºæœ¬ç”¨æ³•</h4> <p>å®ƒä»¬çš„å†…å®¹å¿…é¡»æ˜¯åå…­è¿›åˆ¶æ•°å­—ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨å•ä¸ªä¸‹åˆ’çº¿ä½œä¸ºå­—èŠ‚è¾¹ç•Œåˆ†éš”ç¬¦ã€‚ <strong>å­—é¢å¸¸é‡çš„å€¼å°†æ˜¯åå…­è¿›åˆ¶åºåˆ—çš„äºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼</strong>ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    string public a1 = &quot;a&quot;;
    bytes1 public a2 = &quot;a&quot;;
    bytes1 public a3 = 0x61;
    bytes1 public a4 = hex&quot;61&quot;;
}
</code></pre></div><h4 id="â“¶-ç”¨ç©ºæ ¼åˆ†å¼€çš„åå…­è¿›åˆ¶å­—é¢å¸¸é‡"><a href="#â“¶-ç”¨ç©ºæ ¼åˆ†å¼€çš„åå…­è¿›åˆ¶å­—é¢å¸¸é‡" class="header-anchor">#</a> â“¶ ç”¨ç©ºæ ¼åˆ†å¼€çš„åå…­è¿›åˆ¶å­—é¢å¸¸é‡</h4> <p>ç”¨ç©ºæ ¼åˆ†éš”çš„å¤šä¸ªåå…­è¿›åˆ¶å­—é¢å¸¸é‡è¢«åˆå¹¶ä¸ºä¸€ä¸ªå­—é¢å¸¸é‡ï¼š <code>hex&quot;61&quot; hex&quot;61&quot;</code> ç­‰åŒäº <code>hex&quot;6161&quot;</code></p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    bytes2 public a = hex&quot;61&quot; hex&quot;61&quot;;
}
</code></pre></div><p>åå…­è¿›åˆ¶å­—é¢å¸¸é‡è·Ÿ å­—ç¬¦ä¸²å­—é¢å¸¸é‡ å¾ˆç±»ä¼¼ï¼Œå…·æœ‰ç›¸åŒçš„è½¬æ¢è§„åˆ™</p> <h3 id="_9-enum-æšä¸¾"><a href="#_9-enum-æšä¸¾" class="header-anchor">#</a> 9.Enum:æšä¸¾</h3> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-11"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-11" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=23" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: Enum:æšä¸¾</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=mwU1Os9kjkQ&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=23" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: Enum:æšä¸¾</a></li></ul> <p><code>enum</code> æ˜¯ä¸€ç§ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºå¤šç§çŠ¶æ€ï¼Œæšä¸¾å¯ç”¨æ¥åˆ›å»ºç”±ä¸€å®šæ•°é‡çš„â€œå¸¸é‡å€¼â€æ„æˆçš„è‡ªå®šä¹‰ç±»å‹ã€‚ä¸»è¦ä½œç”¨æ˜¯ç”¨äºé™åˆ¶æŸä¸ªäº‹åŠ¡çš„æœ‰é™é€‰æ‹©ã€‚æ¯”å¦‚å°†å’–å•¡çš„å®¹é‡å¤§å°é™åˆ¶ä¸ºï¼šå¤§ã€ä¸­ã€å°ï¼Œè¿™å°†ç¡®ä¿ä»»ä½•äººä¸èƒ½è´­ä¹°å…¶ä»–å®¹é‡çš„å’–å•¡ï¼Œåªèƒ½åœ¨è¿™é‡Œé€‰æ‹©ã€‚</p> <p>æšä¸¾é»˜è®¤å€¼æ˜¯ç¬¬ä¸€ä¸ªæˆå‘˜ï¼Œæ‰€ä»¥æšä¸¾ç±»å‹è‡³å°‘éœ€è¦ä¸€ä¸ªæˆå‘˜ï¼Œæšä¸¾ä¸èƒ½å¤šäº 256 ä¸ªæˆå‘˜ã€‚æšä¸¾é»˜è®¤çš„ç±»å‹ä¸º <code>uint8</code>ï¼Œå½“æšä¸¾æ•°è¶³å¤Ÿå¤šæ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å˜æˆ <code>uint16</code>..ç­‰å˜å¤§ã€‚å¯ä»¥é€šè¿‡ remix éƒ¨ç½²åï¼Œå‡½æ•°çš„è¾“å…¥å€¼å†…æŸ¥çœ‹ç±»å‹ <code>uint8</code> / <code>uint16</code></p> <ul><li>æšä¸¾ç±»å‹ï¼Œè¿”å›å€¼æ˜¯ç´¢å¼•ï¼Œé»˜è®¤å€¼æ˜¯ 0;</li> <li>æšä¸¾ç±»å‹çš„é»˜è®¤å€¼æ˜¯ç¬¬ä¸€ä¸ªå€¼ã€‚
<ul><li>æšä¸¾ç±»å‹ enum è‡³å°‘åº”è¯¥æœ‰ä¸€åæˆå‘˜ã€‚</li></ul></li> <li>è®¾ç½®çš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½®ä¸ºç´¢å¼•ï¼Œä¹Ÿå¯ä»¥å¯¹åº”çš„æšä¸¾åç§°;</li> <li>æšä¸¾ç±»å‹ enum å¯ä»¥ä¸æ•´æ•°è¿›è¡Œæ˜¾å¼è½¬æ¢ï¼Œä½†ä¸èƒ½è¿›è¡Œéšå¼è½¬æ¢ã€‚
<ul><li>æ˜¾ç¤ºè½¬æ¢ä¼šåœ¨è¿è¡Œæ—¶æ£€æŸ¥æ•°å€¼èŒƒå›´ï¼Œå¦‚æœä¸åŒ¹é…ï¼Œå°†ä¼šå¼•èµ·å¼‚å¸¸ã€‚</li></ul></li></ul> <p><strong>ä¾‹å­</strong>:è€ƒè™‘ä¸€ä¸ªé™åˆ¶ï¼Œå°†äº¤æ˜“çš„çŠ¶æ€é™åˆ¶ä¸ºï¼š<code>None</code>/<code>Pending</code>/<code>Shiped</code>/<code>Completed</code>/<code>Rejected</code>/<code>Canceled</code> è¿™å‡ ç§ã€‚è¿™å°†ç¡®ä¿äº¤æ˜“çŠ¶æ€ä»…åœ¨åˆ—å‡ºçš„çŠ¶æ€å†…ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Enum {
    // æšä¸¾ç±»å‹çš„é»˜è®¤å€¼æ˜¯ç¬¬ä¸€ä¸ªå€¼ã€‚
    // ç»“æ„
    enum Status {
        None, // 0
        Pending, // 1
        Shiped,// 2
        Completed,
        Rejected,
        Canceled
    }
    // å˜é‡
    Status public status;

    // è®¾ç½®ç´¢å¼•å€¼
    function set(Status _status) external {
        status = _status;
    }

    // ç”±äºæšä¸¾ç±»å‹ä¸å±äº |ABI| çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤å¯¹äºæ‰€æœ‰æ¥è‡ª Solidity å¤–éƒ¨çš„è°ƒç”¨ï¼Œ
    // &quot;getStatus&quot; çš„ç­¾åä¼šè‡ªåŠ¨è¢«æ”¹æˆ &quot;getStatus() returns (uint8)&quot;ã€‚
    function getStatus() public view returns (Status) {
        return status;
    }

    function getDefaultStatus() public view returns (uint256) {
        return uint256(status);
    }

    // è®¾ç½®
    function ship() external {
        status = Status.Shiped;
    }

    // æ¢å¤ä¸º0
    function reset() external {
        delete status;
    }
}
</code></pre></div><p>å¾ˆå¤šäººæ„Ÿè§‰ enum å¾ˆå°‘ç”¨ï¼Œä¸€æ˜¯å› ä¸ºåº”ç”¨åœºæ™¯ç¡®å®æ¯”è¾ƒçª„ï¼ŒäºŒæ˜¯å› ä¸ºå¯ä»¥è¢«å…¶ä»–æ•°æ®ç±»å‹æ‰€ä»£æ›¿ï¼›ä½†æŒ‰ç…§ç¼–ç è§„èŒƒï¼Œé™åˆ¶é€‰æ‹©èŒƒå›´åœºæ™¯ï¼Œé™¤äº† bool ä»¥å¤–çš„ï¼Œæ¨èä½¿ç”¨ enum ç±»å‹æ¥å®šä¹‰ã€‚</p> <p>æšä¸¾æ˜¯æ˜¾ç¤ºæ‰€æœ‰æ•´å‹ç›¸äº’è½¬æ¢ï¼Œä½†ä¸å…è®¸éšå¼è½¬æ¢ã€‚ä»æ•´å‹æ˜¾å¼è½¬æ¢æšä¸¾ï¼Œä¼šåœ¨è¿è¡Œæ—¶æ£€æŸ¥æ•´æ•°æ—¶å€™åœ¨æšä¸¾èŒƒå›´å†…ï¼Œå¦åˆ™ä¼šå¯¼è‡´å¼‚å¸¸ï¼ˆ Panic å¼‚å¸¸ ï¼‰ã€‚</p> <p>æšä¸¾è¿˜å¯ä»¥åœ¨åˆçº¦æˆ–åº“å®šä¹‰ä¹‹å¤–çš„æ–‡ä»¶çº§åˆ«ä¸Šå£°æ˜ã€‚</p> <h4 id="â“µ-å±æ€§-2"><a href="#â“µ-å±æ€§-2" class="header-anchor">#</a> â“µ å±æ€§</h4> <p>æ•°æ®è¡¨ç¤ºä¸ï¼šé€‰é¡¹ä»<code>0</code>å¼€å§‹çš„æ— ç¬¦å·æ•´æ•°å€¼è¡¨ç¤ºã€‚</p> <h4 id="â“¶-æ–¹æ³•"><a href="#â“¶-æ–¹æ³•" class="header-anchor">#</a> â“¶ æ–¹æ³•</h4> <ul><li>delete</li> <li><code>type(NameOfEnum).min</code></li> <li><code>type(NameOfEnum).max</code></li></ul> <p>ä½¿ç”¨ <code>type(NameOfEnum).min</code> å’Œ <code>type(NameOfEnum).max</code> ä½ å¯ä»¥å¾—åˆ°ç»™å®šæšä¸¾çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Enum {
    // æšä¸¾ç±»å‹çš„é»˜è®¤å€¼æ˜¯ç¬¬ä¸€ä¸ªå€¼ã€‚
    enum Status {
        None,//0
        Pending,//1
        Shiped,//2
        Completed,//3
        Rejected,//4
        Canceled// 5
    }

    function getLargestValue() public pure returns (Status) {
        return type(Status).max;
    }

    function getSmallestValue() public pure returns (Status) {
        return type(Status).min;
    }
}
</code></pre></div><h3 id="_10-ç”¨æˆ·å®šä¹‰çš„å€¼ç±»å‹"><a href="#_10-ç”¨æˆ·å®šä¹‰çš„å€¼ç±»å‹" class="header-anchor">#</a> 10.ç”¨æˆ·å®šä¹‰çš„å€¼ç±»å‹</h3> <p>Solidity å…è®¸åœ¨ä¸€ä¸ªåŸºæœ¬çš„å€¼ç±»å‹ä¸Šåˆ›å»ºä¸€ä¸ªé›¶æˆæœ¬çš„æŠ½è±¡ã€‚è¿™ç±»ä¼¼äºä¸€ä¸ªåˆ«åï¼Œä½†æœ‰æ›´ä¸¥æ ¼çš„ç±»å‹è¦æ±‚ã€‚</p> <p>ç”¨æˆ·å®šä¹‰å€¼ç±»å‹ä½¿ç”¨ <code>type UserType is DefaultType</code> æ¥å®šä¹‰ã€‚</p> <p>å…¶ä¸­ <code>UserType</code> æ˜¯æ–°å¼•å…¥çš„ç±»å‹çš„åç§°ï¼Œ <code>DefaultType</code> å¿…é¡»æ˜¯å†…ç½®çš„å€¼ç±»å‹ï¼ˆâ€åº•å±‚ç±»å‹â€ï¼‰ã€‚è‡ªå®šä¹‰ç±»å‹çš„å€¼çš„æ•°æ®è¡¨ç¤ºåˆ™ç»§æ‰¿è‡ªåº•å±‚ç±»å‹ï¼Œå¹¶ä¸” ABI ä¸­ä¹Ÿä½¿ç”¨åº•å±‚ç±»å‹ã€‚</p> <p>âš ï¸: ç”¨æˆ·å®šä¹‰çš„ç±»å‹ <code>UserType</code> æ²¡æœ‰ä»»ä½•è¿ç®—ç¬¦æˆ–ç»‘å®šæˆå‘˜å‡½æ•°ã€‚å³ä½¿æ˜¯æ“ä½œç¬¦ <code>==</code> ä¹Ÿæ²¡æœ‰å®šä¹‰ã€‚ä¹Ÿä¸å…è®¸ä¸å…¶ä»–ç±»å‹è¿›è¡Œæ˜¾å¼å’Œéšå¼è½¬æ¢ã€‚</p> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-12"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-12" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=24" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: ç”¨æˆ·å®šä¹‰çš„å€¼ç±»å‹</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=FTVsYfNaDqg&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=24" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 3 èŠ‚å€¼ç±»å‹: ç”¨æˆ·å®šä¹‰çš„å€¼ç±»å‹</a></li></ul> <h4 id="â“µ-æ–¹æ³•"><a href="#â“µ-æ–¹æ³•" class="header-anchor">#</a> â“µ æ–¹æ³•</h4> <ul><li><code>UserType.wrap()</code>: ç”¨æ¥ä»åº•å±‚ç±»å‹è½¬æ¢åˆ°è‡ªå®šä¹‰ç±»å‹</li> <li><code>UserType.unwrap()</code>: ä»è‡ªå®šä¹‰ç±»å‹è½¬æ¢åˆ°åº•å±‚ç±»å‹ã€‚</li></ul> <h4 id="â“¶-ä¾‹å­"><a href="#â“¶-ä¾‹å­" class="header-anchor">#</a> â“¶ ä¾‹å­</h4> <p>æ¡ˆä¾‹ï¼šä¸€ä¸ª 18 ä½å°æ•°ã€256 bit çš„æµ®ç‚¹ç±»å‹</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// ä½¿ç”¨ç”¨æˆ·å®šä¹‰çš„å€¼ç±»å‹è¡¨ç¤º 18 ä½å°æ•°ã€256 bitçš„æµ®ç‚¹ç±»å‹ã€‚
type UFixed256x18 is uint256;

/// åœ¨ UFixed256x18 ä¸Šè¿›è¡Œæµ®ç‚¹æ“ä½œçš„ç²¾ç®€åº“ã€‚
library FixedMath {
    uint constant multiplier = 10**18;

    /// ä¸¤ä¸ª UFixed256x18 æ•°ç›¸åŠ ï¼Œ
    /// æº¢å‡ºæ—¶æ¢å¤ï¼Œä¾èµ–äº uint256 ä¸Šçš„æ£€æŸ¥ç®—æœ¯
     function add(UFixed256x18 a, UFixed256x18 b) internal pure returns (UFixed256x18) {
        return UFixed256x18.wrap(UFixed256x18.unwrap(a) + UFixed256x18.unwrap(b));
    }
    /// å°† UFixed256x18 å’Œ uint256 ç›¸ä¹˜.
    /// æº¢å‡ºæ—¶æ¢å¤ï¼Œä¾èµ–äº uint256 ä¸Šçš„æ£€æŸ¥ç®—æœ¯
     function mul(UFixed256x18 a, uint256 b) internal pure returns (UFixed256x18) {
        return UFixed256x18.wrap(UFixed256x18.unwrap(a) * b);
    }
    ///  UFixed256x18 å‘ä¸‹å–æ•´.
    /// @return ä¸è¶…è¿‡ `a` çš„æœ€å¤§æ•´æ•°ã€‚
    function floor(UFixed256x18 a) internal pure returns (uint256) {
        return UFixed256x18.unwrap(a) / multiplier;
    }
    /// å°† uint256 è½¬æ¢ä¸ºç›¸åŒå€¼çš„ UFixed256x18ã€‚
    /// å¦‚æœæ•´æ•°å¤ªå¤§ï¼Œåˆ™è¿˜åŸã€‚
    function toUFixed256x18(uint256 a) internal pure returns (UFixed256x18) {
        return UFixed256x18.wrap(a * multiplier);
    }
}
contract Test {
    uint256 a = 1;
    uint256 b = 2;

    function testAdd() external view returns (UFixed256x18) {
        return FixedMath.add(FixedMath.toUFixed256x18(a), FixedMath.toUFixed256x18(b));
    }
    function testMul() external view returns (UFixed256x18) {
        return FixedMath.mul(FixedMath.toUFixed256x18(a),b);
    }
}
</code></pre></div><p>æ³¨æ„ <code>UFixed256x18.wrap</code> å’Œ <code>FixedMath.toUFixed256x18</code> çš„ç­¾åç›¸åŒï¼Œä½†æ‰§è¡Œçš„æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„æ“ä½œï¼š</p> <ul><li><code>UFixed256x18.wrap</code> å‡½æ•°è¿”å›ä¸€ä¸ªä¸è¾“å…¥çš„æ•°æ®è¡¨ç¤ºç›¸åŒçš„è‡ªå®šä¹‰å€¼ç±»å‹ï¼ˆ<code>UFixed256x18</code>ï¼‰ã€‚</li> <li><code>FixedMath.toUFixed256x18</code>åˆ™è¿”å›ä¸€ä¸ªå…·æœ‰ç›¸åŒæ•°å€¼çš„ <code>UFixed256x18</code> ã€‚</li></ul> <h2 id="_4ï¸âƒ£-å€¼ç±»å‹-åœ°å€ç±»å‹"><a href="#_4ï¸âƒ£-å€¼ç±»å‹-åœ°å€ç±»å‹" class="header-anchor">#</a> 4ï¸âƒ£ å€¼ç±»å‹:åœ°å€ç±»å‹</h2> <p>åœ°å€åˆ†ä¸ºå¤–éƒ¨åœ°å€å’Œåˆçº¦åœ°å€ï¼Œæ¯ä¸ªåœ°å€éƒ½æœ‰<strong>ä¸€å—æŒä¹…åŒ–å†…å­˜åŒº</strong>ç§°ä¸ºå­˜å‚¨ã€‚</p> <p>åœ°å€ç±»å‹ä¹Ÿæ˜¯å€¼ç±»å‹ï¼Œå› ä¸ºæ¯”è¾ƒç‰¹æ®Šï¼Œæ‰€ä»¥å•ç‹¬æ‹¿å‡ºæ¥è®²ã€‚åœ°å€ç±»å‹æ˜¯ Solidity è¯­è¨€ç‹¬æœ‰çš„æ•°æ®ç±»å‹ï¼Œè¡¨ç¤ºä»¥å¤ªåŠçš„åœ°å€ç±»å‹ã€‚ç”¨ address è¡¨ç¤ºåœ°å€ï¼Œé•¿åº¦æ˜¯ 20 ä¸ªå­—èŠ‚ï¼›æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„æ˜¯åå…­è¿›åˆ¶çš„åœ°å€æ ¼å¼ï¼Œæ¯”å¦‚: <code>0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926ac</code>ï¼›è¿™ç§ç±»å‹é€‚åˆå­˜å‚¨åˆçº¦åœ°å€æˆ–å¤–éƒ¨åœ°å€ã€‚</p> <h3 id="æœ¬èŠ‚é…å¥—è§†é¢‘-13"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-13" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h3> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=25" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 4 èŠ‚: åœ°å€ç±»å‹</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=HH1Ft6AwgzE&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=25" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 4 èŠ‚: åœ°å€ç±»å‹</a></li> <li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=26" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 4 èŠ‚: åœ°å€ç±»å‹ code å±æ€§è¡¥å……</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=3w1f8Gc16rk&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=26" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 4 èŠ‚: åœ°å€ç±»å‹ code å±æ€§è¡¥å……</a></li></ul> <h3 id="_1-åœ°å€å­—é¢å¸¸é‡"><a href="#_1-åœ°å€å­—é¢å¸¸é‡" class="header-anchor">#</a> 1.åœ°å€å­—é¢å¸¸é‡</h3> <p>é€šå¸¸çš„åœ°å€ç±»å‹æ˜¯ <code>0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926ac</code> è¿™æ ·çš„ <a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-55.md" target="_blank" rel="noopener noreferrer">checksum address<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œã€‚ è€Œæ²¡æœ‰é€šè¿‡æ ¡éªŒæµ‹è¯•, é•¿åº¦åœ¨ 39 åˆ° 41 ä¸ªæ•°å­—ä¹‹é—´çš„åå…­è¿›åˆ¶å­—é¢å¸¸é‡ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯, æ¯”å¦‚ <code>0XFFD0D80C48F6C3C5387B7CFA7AA03970BDB926AC</code> å°±æ˜¯ä¸€ä¸ªé”™è¯¯ address ç±»å‹ã€‚ä¼šæç¤ºæ­£ç¡®çš„åœ°å€ï¼Œä¹Ÿå¯ä»¥å°†åœ°å€è¾“å…¥åˆ° <a href="https://cn.etherscan.com/address/0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926AC" target="_blank" rel="noopener noreferrer">etherscan<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> è·å–ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    // This looks like an address but has an invalid checksum.
    // Correct checksummed address: &quot;0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926ac&quot;.
    // If this is not used as an address, please prepend '00'.
    // For more information please see
    // https://docs.soliditylang.org/en/develop/types.html#address-literals
    // address public a1 = 0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926AC;

    // ç›´æ¥åœ¨æç¤ºç§è·å–åˆ°æ­£ç¡®çš„ checksummed addressï¼Œ
    // ä¹Ÿå¯ä»¥åœ¨ etherscan ç§å¾—åˆ° checksum åœ°å€ã€‚
    address public a2 = 0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926ac;
}
</code></pre></div><p>å¦‚æœä¸æ€•éº»çƒ¦ï¼Œè¿˜å¯ä»¥é€šè¿‡ SDK æ¥è‡ªå·±è½¬æ¢ <a href="https://web3js.readthedocs.io/en/v1.8.0/web3-utils.html#tochecksumaddress" target="_blank" rel="noopener noreferrer">web3.utils.toChecksumAddress(address)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_2-address-uint-bytes32-ä¹‹é—´çš„è½¬æ¢"><a href="#_2-address-uint-bytes32-ä¹‹é—´çš„è½¬æ¢" class="header-anchor">#</a> 2.address/uint/bytes32 ä¹‹é—´çš„è½¬æ¢</h3> <ul><li>1 å­—èŠ‚ 8 ä½ï¼Œä¸€ä¸ª address æ˜¯ 20 ä¸ªå­—èŠ‚ï¼Œæ˜¯ 160 ä½ï¼Œæ‰€ä»¥ <strong>address å¯ä»¥ç”¨ uint160 è¡¨ç¤º</strong>ã€‚</li> <li>1 å­—èŠ‚å¯ä»¥è¡¨ç¤ºä¸ºä¸¤ä¸ªè¿ç»­çš„åå…­è¿›åˆ¶æ•°å­—ï¼Œæ‰€ä»¥ <strong>address å¯ä»¥ç”¨è¿ç»­çš„ 40 ä¸ªåå…­è¿›åˆ¶æ•°å­—è¡¨ç¤º</strong>ã€‚</li> <li>address ä¸å…è®¸ä»»ä½•ç®—æ•°æ“ä½œ</li> <li><code>address</code> å…è®¸å’Œ <code>uint160</code>ã€ <code>æ•´å‹å­—é¢å¸¸é‡</code>ã€<code>bytes20</code> åŠ<code>åˆçº¦ç±»å‹</code>ç›¸äº’è½¬æ¢ã€‚
<ul><li>å¦‚æœå°†ä½¿ç”¨è¾ƒå¤§å­—èŠ‚æ•°ç»„ç±»å‹è½¬æ¢ä¸º <code>address</code> ï¼Œä¾‹å¦‚ <code>bytes32</code> ï¼Œé‚£ä¹ˆ <code>address</code> å°†è¢«æˆªæ–­ã€‚</li></ul></li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    bytes32 public a =
        0x111122223333444455556666777788889999AAAABBBBCCCCDDDDEEEEFFFFCCCC;

    // 0x111122223333444455556666777788889999aAaa
    address public b = address(uint160(bytes20(a)));

    // 0x777788889999AaAAbBbbCcccddDdeeeEfFFfCcCc
    address public c = address(uint160(uint256(a)));
}
</code></pre></div><p>âš ï¸ï¼šä¸ºäº†å‡å°‘è½¬æ¢æ­§ä¹‰ï¼Œæˆ‘ä»¬åœ¨è½¬æ¢ä¸­æ˜¾å¼æˆªæ–­å¤„ç†ã€‚ ä»¥ 32bytes å€¼ <code>0x111122223333444455556666777788889999AAAABBBBCCCCDDDDEEEEFFFFCCCC</code> ä¸ºä¾‹ï¼Œ å¦‚æœä½¿ç”¨ <code>address(uint160(bytes20(b)))</code> ç»“æœæ˜¯ <code>0x111122223333444455556666777788889999aAaa</code>ï¼Œ è€Œä½¿ç”¨ <code>address(uint160(uint256(b)))</code> ç»“æœæ˜¯ <code>0x777788889999AaAAbBbbCcccddDdeeeEfFFfCcCc</code> ã€‚</p> <p>æ³¨æ„ï¼Œç½‘ä¸Šå¾ˆå¤šåœ¨çº¿è½¬æ¢å·¥å…·å¾—åˆ°çš„ç»“æœå¹¶ä¸æ­£ç¡®ï¼Œæ¯”å¦‚: <a href="https://tool.oschina.net/hexconvert/" target="_blank" rel="noopener noreferrer">https://tool.oschina.net/hexconvert/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>å¦‚ä¸‹ä¾‹å­è¿›è¡ŒçœŸå®è½¬æ¢ï¼š<code>_owner</code> åœ¨ä¸€äº›åœ¨çº¿çš„è½¯ä»¶å†…è½¬æ¢çš„ä¸æ­£ç¡®ï¼Œä¸Šé¢çš„ç½‘å€æœ‰ä¸ªå° BUGï¼Œè¾“å…¥åå…­è¿›åˆ¶æ•°æ®çš„æ—¶å€™ï¼Œä¸èƒ½å¸¦ <code>0x</code> å‰ç¼€ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract test {
    address _owner; // åå…­è¿›åˆ¶
    uint160 _ownerUint; // åè¿›åˆ¶

    constructor() {
        _owner = 0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926ac;
        _ownerUint = 1460450021995508802976443037013257463744970696364;
    }

    function toUint160() public view returns (uint160) {
        //è½¬æ¢10è¿›åˆ¶
        return uint160(_owner);
    }

    function toAddress() public view returns (address) {
        return address(_ownerUint);
    }
}
</code></pre></div><p>æ³¨æ„: è¿™é‡Œè¯´çš„åœ°å€æ˜¯ <code>0x123...</code> è¿™ç§åå…­è¿›åˆ¶çš„åœ°å€å…¬é’¥ï¼Œè€Œä¸æ˜¯åº”ç”¨å±‚çš„ <code>anbang.eth</code> è¿™ç§ ENS åœ°å€ã€‚è™½ç„¶åœ¨å¾ˆå¤šé’±åŒ…å¯ä»¥é€šè¿‡<code>anbang.eth</code>æ¥å‘<code>0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926ac</code>è½¬è´¦ï¼Œä½†ä»…ä»…æ˜¯åº”ç”¨å±‚çš„ä¸­è½¬æœåŠ¡ã€‚å…·ä½“å¯ä»¥åœ¨ <a href="https://etherscan.io/enslookup-search?search=anbang.eth" target="_blank" rel="noopener noreferrer">ä»¥å¤ªåŠæµè§ˆå™¨<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>,æˆ–è€…é’±åŒ…å†…è¾“å…¥ ENS åŸŸåæŸ¥çœ‹ä¸­è½¬é€»è¾‘.ï¼ˆENS æ˜¯ä¸€ç§åˆ«åï¼Œé™¤äº†åœ¨ä»¥å¤ªåŠç½‘ç»œå¯ä»¥ä½¿ç”¨ï¼Œåœ¨ imToken ç­‰é’±åŒ…å†…ï¼Œåœ¨ BTC ç½‘ç»œä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œå®ƒå¹¶ä¸æ˜¯åŒºå—é“¾çš„åº•å±‚ï¼Œè€Œæ˜¯åº”ç”¨å±‚ï¼‰</p> <h3 id="_3-ä¸¤ç§å½¢å¼çš„åœ°å€"><a href="#_3-ä¸¤ç§å½¢å¼çš„åœ°å€" class="header-anchor">#</a> 3.ä¸¤ç§å½¢å¼çš„åœ°å€</h3> <p>åœ¨ç¬¬ä¸€ç« æ¥æ”¶ ETH é‚£ä¸€èŠ‚çš„ä¸‰ä¸ªå…³é”®å­—é‡Œï¼Œä¹Ÿä»‹ç»äº† payableï¼Œè¿™é‡Œå†æ¬¡è®²ä¸€ä¸‹åŠ æ·±å°è±¡ã€‚</p> <ul><li><code>address</code>ï¼šä¿å­˜ä¸€ä¸ª 20 å­—èŠ‚çš„å€¼ï¼ˆä»¥å¤ªåŠåœ°å€çš„å¤§å°ï¼‰ã€‚</li> <li><code>address payable</code> ï¼šå¯æ”¯ä»˜åœ°å€ï¼Œä¸ <code>address</code> ç›¸åŒï¼Œä¸è¿‡æœ‰æˆå‘˜å‡½æ•° <code>transfer</code> å’Œ <code>send</code> ã€‚</li></ul> <p>å¦‚æœä½ éœ€è¦ <code>address</code> ç±»å‹çš„å˜é‡ï¼Œå¹¶è®¡åˆ’å‘é€ä»¥å¤ªå¸ç»™è¿™ä¸ªåœ°å€ï¼Œé‚£ä¹ˆå£°æ˜ç±»å‹ä¸º <code>address payable</code> å¯ä»¥æ˜ç¡®è¡¨è¾¾å‡ºä½ çš„éœ€æ±‚ã€‚ åŒæ ·ï¼Œå°½é‡æ›´æ—©å¯¹ä»–ä»¬è¿›è¡ŒåŒºåˆ†æˆ–è½¬æ¢ã€‚</p> <p>è¿™ç§åŒºåˆ«èƒŒåçš„æ€æƒ³æ˜¯ <code>address payable</code> å¯ä»¥å‘å…¶å‘é€ä»¥å¤ªå¸ï¼Œè€Œä¸èƒ½å‘ä¸€ä¸ªæ™®é€šçš„ <code>address</code> å‘é€ä»¥å¤ªå¸ã€‚æ¯”å¦‚ï¼Œå®ƒå¯èƒ½æ˜¯ä¸€ä¸ªæ™ºèƒ½åˆçº¦åœ°å€ï¼Œå¹¶ä¸”ä¸æ”¯æŒæ¥æ”¶ä»¥å¤ªå¸ã€‚</p> <h4 id="â“µ-ä¸¤ç§å½¢å¼çš„åœ°å€è½¬æ¢"><a href="#â“µ-ä¸¤ç§å½¢å¼çš„åœ°å€è½¬æ¢" class="header-anchor">#</a> â“µ ä¸¤ç§å½¢å¼çš„åœ°å€è½¬æ¢</h4> <p>å…è®¸ä» <code>address payable</code> åˆ° <code>address</code> çš„éšå¼è½¬æ¢ï¼Œè€Œä» <code>address</code> åˆ° <code>address payable</code> å¿…é¡»æ˜¾ç¤ºçš„ é€šè¿‡ <code>payable(&lt;address&gt;)</code> è¿›è¡Œè½¬æ¢ã€‚ä¹Ÿåªèƒ½é€šè¿‡ <code>payable(...)</code> è¡¨è¾¾å¼æŠŠ <code>address</code> ç±»å‹å’Œåˆçº¦ç±»å‹è½¬æ¢ä¸º <code>address payable</code>ã€‚</p> <p>åœ¨ä»‹ç»åœ°å€ payable æ–¹æ³•æ—¶å€™ä¼šå…·ä½“ä»‹ç»ï¼Œè½¬æ¢çš„æ—¶å€™æ³¨æ„ä¸‹é¢ä¸¤ä¸ªç‚¹ï¼š</p> <ol><li>åªæœ‰èƒ½æ¥æ”¶ä»¥å¤ªå¸çš„åˆçº¦ç±»å‹ï¼Œæ‰èƒ½å¤Ÿè¿›è¡Œæ­¤è½¬æ¢ã€‚
<ol><li>ä¾‹å¦‚åˆçº¦è¦ä¹ˆæœ‰ receive æˆ–å¯æ”¯ä»˜çš„å›é€€å‡½æ•°ã€‚</li></ol></li> <li><code>payable(0)</code> æ˜¯æœ‰æ•ˆçš„ï¼Œè¿™æ˜¯æ­¤è§„åˆ™çš„ä¾‹å¤–ã€‚</li></ol> <h3 id="_4-åœ°å€å±æ€§"><a href="#_4-åœ°å€å±æ€§" class="header-anchor">#</a> 4.åœ°å€å±æ€§</h3> <p>address æ‹¥æœ‰å¦‚ä¸‹å±æ€§ï¼›</p> <ol><li><p>.balance : ä»¥ Wei ä¸ºå•ä½çš„ä½™é¢ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;address&gt;.balance    returns(uint256)
</code></pre></div></li> <li><p>.code : åœ°å€ä¸Šçš„ä»£ç (å¯ä»¥ä¸ºç©º)</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;address&gt;.code        returns(bytes memory)
</code></pre></div></li> <li><p>.codehash : åœ°å€çš„ codehash</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;address&gt;.codehash    returns(bytes32)
</code></pre></div></li></ol> <h4 id="â“µ-balance-å±æ€§"><a href="#â“µ-balance-å±æ€§" class="header-anchor">#</a> â“µ balance å±æ€§</h4> <p>è·å–åœ°å€çš„ä½™é¢ï¼Œwei å•ä½ã€‚å¦‚ä¸‹ä¾‹å­æ˜¯è·å–æŒ‡å®šåœ°å€çš„ ETH ä½™é¢ï¼Œå’Œå½“å‰è°ƒç”¨è€…çš„ä½™é¢ã€‚ï¼ˆåŸºäºå½“å‰ä½¿ç”¨çš„ç½‘ç»œï¼‰</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    function getBalance1(address addr) public view returns (uint256) {
        return addr.balance;
    }
    function getBalance2() external view returns (uint256) {
        return address(msg.sender).balance;
    }
}
</code></pre></div><p>å‡½æ•°å†…ä¸€èˆ¬ä¸åƒä¸Šé¢é‚£ä¹ˆç”¨ï¼Œæ›´å¤šçš„æ˜¯è·å–åˆçº¦æœ¬èº«çš„ ETH ä½™é¢;</p> <p><strong>å¦‚ä½•è·å–åˆçº¦åœ°å€?</strong>:åˆçº¦éƒ¨ç½²åï¼Œä¼šæœ‰ä¸€ä¸ªåˆçº¦åœ°å€; <strong>æ‰€æœ‰åˆçº¦éƒ½å¯ä»¥è½¬æ¢ä¸º address ç±»å‹</strong>ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    function returnContractAddress() external view returns (address) {
        return address(this);
    }
}
</code></pre></div><p>å› æ­¤å¯ä»¥ä½¿ç”¨ <code>address(this).balance</code> æŸ¥è¯¢å½“å‰åˆçº¦çš„ä½™é¢ï¼Œè·å–åˆçº¦æœ¬èº«çš„ ETH ä½™é¢å¦‚ä¸‹</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    function getBalance() external view returns (uint256) {
        return address(this).balance;
    }
    receive() external payable {}
}
</code></pre></div><p>âš ï¸: åœ¨ç‰ˆæœ¬ 0.5.0 ä¹‹å‰ï¼ŒSolidity å…è®¸é€šè¿‡åˆçº¦å®ä¾‹æ¥è®¿é—®åœ°å€çš„æˆå‘˜ï¼Œä¾‹å¦‚ <code>this.balance</code> ï¼Œä¸è¿‡ç°åœ¨ç¦æ­¢è¿™æ ·åšï¼Œå¿…é¡»æ˜¾å¼è½¬æ¢ä¸ºåœ°å€åè®¿é—®ï¼Œå¦‚ï¼š <code>address(this).balance</code> ã€‚</p> <h4 id="â“¶-code-å±æ€§"><a href="#â“¶-code-å±æ€§" class="header-anchor">#</a> â“¶ code å±æ€§</h4> <p>å¯ä»¥æŸ¥è¯¢ä»»ä½•æ™ºèƒ½åˆçº¦çš„éƒ¨ç½²ä»£ç ã€‚ä½¿ç”¨ <code>.code</code> æ¥è·å– EVM çš„å­—èŠ‚ç ï¼Œå…¶è¿”å› <code>bytes memory</code> ï¼Œå€¼å¯èƒ½æ˜¯ç©ºã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    function getCode() public view returns (bytes memory) {
        return address(this).code;
    }

    // å¤–éƒ¨åœ°å€ code å†…å®¹æ˜¯ç©ºï¼Œ
    // å¯ä»¥é€šè¿‡è¿™ä¸ªæ¥åˆ¤æ–­åœ°å€æ˜¯å¦ä¸ºåˆçº¦
    function getAdsCode(address a_) public view returns (bytes memory) {
        return address(a_).code;
    }
}
</code></pre></div><p>æ³¨æ„:åˆçº¦æ²¡æœ‰å®Œå…¨åˆ›å»ºï¼Œä¹Ÿå°±æ˜¯ constructor æ²¡æœ‰å®Œå…¨æ‰§è¡Œå®Œçš„æ—¶å€™ï¼Œcode ä¹Ÿæ˜¯ç©ºã€‚</p> <p>ä¸‹é¢æ˜¯å‘ç³–æœçš„åˆçº¦ï¼Œåªå…è®¸ç”¨æˆ·çš„åœ°å€é¢†å–ï¼Œç¦æ­¢åˆçº¦åœ°å€ã€‚ç»“æœè¢«åˆçº¦åœ°å€è–…ç¾Šæ¯›äº†ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// å‘ç³–æœçš„åˆçº¦
contract A {
    uint256 giftValue = 666;
    mapping(address=&gt;uint256) public gifts;

    function gift() public returns(uint256){
        bytes memory senderCode = getCode(msg.sender);
        require(senderCode.length==0,unicode&quot;åªèƒ½ç”¨æˆ·é¢†å–ï¼Œè–…ç¾Šæ¯›çš„åˆçº¦æ»šï¼ï¼ï¼&quot;);
        gifts[msg.sender] = giftValue;
        return giftValue;
    }

    function getCode(address ads_) public view returns(bytes memory){
        return address(ads_).code;
    }
}

// è–…ç¾Šæ¯›çš„åˆçº¦
contract Test {
    A a;
    uint256 public target; // ä¿å­˜è–…ç¾Šæ¯›å¾—åˆ°çš„ç³–æœ
    constructor(address ads_){
        target = A(ads_).gift();
    }
}
</code></pre></div><h4 id="â“·-codehash-å±æ€§"><a href="#â“·-codehash-å±æ€§" class="header-anchor">#</a> â“· codehash å±æ€§</h4> <p>ä½¿ç”¨ <code>.codehash</code> è·å¾—åˆçº¦ä»£ç çš„ <code>Keccak-256 å“ˆå¸Œå€¼</code> (ä¸º bytes32 )ã€‚</p> <p>æ³¨æ„ï¼Œ <code>addr.codehash</code> æ¯”ä½¿ç”¨ <code>keccak256(addr.code)</code> æ›´ä¾¿å®œã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    function getCode() public view returns (bytes memory) {
        return address(this).code;
    }

    function getCodeByKeccak256() public view returns (bytes32) {
        return keccak256(address(this).code);
    }

    function getCodehash() public view returns (bytes32) {
        return address(this).codehash;
    }
}
</code></pre></div><h3 id="_5-åœ°å€æ–¹æ³•"><a href="#_5-åœ°å€æ–¹æ³•" class="header-anchor">#</a> 5.åœ°å€æ–¹æ³•</h3> <p>address æ‹¥æœ‰å¦‚ä¸‹æ–¹æ³•ï¼›</p> <ol><li><code>address()</code>: å¯ä»¥å°†åœ°å€è½¬æ¢åˆ°åœ°å€ç±»å‹ã€‚</li> <li><code>payable()</code>: å°†æ™®é€šåœ°å€è½¬ä¸ºå¯æ”¯ä»˜åœ°å€ã€‚</li> <li><code>.transfer(uint256 amount)</code>: å°†ä½™é¢è½¬åˆ°å½“å‰åœ°å€ï¼ˆåˆçº¦åœ°å€è½¬è´¦ï¼‰</li> <li><code>.send(uint256 amount)</code>: å°†ä½™é¢è½¬åˆ°å½“å‰åœ°å€ï¼Œå¹¶<strong>è¿”å›äº¤æ˜“æˆåŠŸçŠ¶æ€</strong>ï¼ˆåˆçº¦åœ°å€è½¬è´¦ï¼‰</li> <li><code>.call(bytes memory)</code>: ç”¨ç»™å®šçš„æœ‰æ•ˆè½½è·ï¼ˆpayloadï¼‰å‘å‡ºä½çº§ <code>CALL</code> è°ƒç”¨ï¼Œå¹¶<strong>è¿”å›äº¤æ˜“æˆåŠŸçŠ¶æ€å’Œè¿”å›æ•°æ®</strong>ï¼ˆè°ƒç”¨åˆçº¦çš„æ–¹æ³•å¹¶è½¬è´¦ï¼‰</li> <li><code>.delegatecall(bytes memory)</code>: ç”¨ç»™å®šçš„æœ‰æ•ˆè½½è·ï¼ˆpayloadï¼‰å‘å‡ºä½çº§ <code>DELEGATECALL</code> è°ƒç”¨ï¼Œå¹¶<strong>è¿”å›äº¤æ˜“æˆåŠŸçŠ¶æ€å’Œè¿”å›æ•°æ®</strong>ï¼ˆè°ƒç”¨åˆçº¦çš„æ–¹æ³•å¹¶è½¬è´¦ï¼‰</li> <li><code>staticcall(bytes memory)</code>: ç”¨ç»™å®šçš„æœ‰æ•ˆè½½è·ï¼ˆpayloadï¼‰å‘å‡ºä½çº§ <code>STATICCALL</code> è°ƒç”¨ï¼Œå¹¶<strong>è¿”å›äº¤æ˜“æˆåŠŸçŠ¶æ€å’Œè¿”å›æ•°æ®</strong>ï¼ˆè°ƒç”¨åˆçº¦çš„æ–¹æ³•å¹¶è½¬è´¦ï¼‰</li></ol> <h4 id="â“µ-address"><a href="#â“µ-address" class="header-anchor">#</a> â“µ address()</h4> <p><strong>1.è·å–å½“å‰åˆçº¦åœ°å€</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Address {
    mapping(address =&gt; uint256) public balances; // ç”¨åœ¨ mapping ç»“æ„å†…

    // å­˜æ¬¾
    function deposit() public payable {
        balances[msg.sender] += msg.value;
    }

    function getAddress() external view returns (address) {
        return address(this);
    }

    function getBalance1() external view returns (uint256) {
        return address(this).balance;
    }

    function getBalance2() external view returns (uint256) {
        return address(msg.sender).balance;
    }
}
</code></pre></div><p><strong>2.uint å€¼è½¬æ¢æˆåœ°å€</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    function getAddress()
        external
        pure
        returns (
            address,
            address,
            address,
            address,
            address
        )
    {
        return (address(0), address(1), address(3), address(6), address(9));
    }
}
</code></pre></div><p>è¿”å›ç»“æœå¦‚ä¸‹:</p> <div class="language- extra-class"><pre class="language-text"><code>0: address: 0x0000000000000000000000000000000000000000
1: address: 0x0000000000000000000000000000000000000001
2: address: 0x0000000000000000000000000000000000000003
3: address: 0x0000000000000000000000000000000000000006
4: address: 0x0000000000000000000000000000000000000009
</code></pre></div><p><strong>3.è·å–å³å°†éƒ¨ç½²çš„åœ°å€</strong></p> <p>è¿™æ˜¯ <em>uint å€¼è½¬æ¢æˆåœ°å€</em> çš„ä¸€ç§åº”ç”¨ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    // è·å–å³å°†éƒ¨ç½²çš„åœ°å€
    function getAddress(bytes memory bytecode, uint256 _salt)
        external
        view
        returns (address)
    {
        bytes32 hash = keccak256(
            abi.encodePacked(
                bytes1(0xff), // å›ºå®šå­—ç¬¦ä¸²
                address(this), // å½“å‰å·¥å‚åˆçº¦åœ°å€
                _salt, // salt
                keccak256(bytecode) //éƒ¨ç½²åˆçº¦çš„ bytecode
            )
        );
        return address(uint160(uint256(hash)));
    }
}
</code></pre></div><h4 id="â“¶-payable"><a href="#â“¶-payable" class="header-anchor">#</a> â“¶ payable()</h4> <p>æ³¨æ„ï¼šæ”¯ä»˜çš„æ—¶å€™ï¼Œåœ°å€å¿…é¡» <code>payable</code> ç±»å‹ï¼ä» <code>address</code> åˆ° <code>address payable</code> çš„è½¬æ¢ã€‚å¯ä»¥é€šè¿‡ <code>payable(x)</code> è¿›è¡Œ ï¼Œå…¶ä¸­ <code>x</code> å¿…é¡»æ˜¯ <code>address</code> ç±»å‹ã€‚</p> <p>è®©æ™®é€šåœ°å€ä¸º payable æœ‰ä¸¤ç§æ–¹å¼</p> <ul><li>æ–¹å¼ä¸€: å‚æ•°ä¸­ åœ°å€æ ‡æ³¨ address payable ,å¹¶ä¸”å‡½æ•°çŠ¶æ€å¯å˜æ€§æ ‡ä¸º <code>payable</code>;
<ul><li>è¿™ç§æ›´çœ gas (<strong>æ¨è</strong>)</li></ul></li> <li>æ–¹å¼äºŒ: ä»…åœ¨å†…éƒ¨è¿›è¡Œ <code>payable(address)</code> æ˜¾ç¤ºè½¬æ¢</li></ul> <h5 id="ä¾‹å­"><a href="#ä¾‹å­" class="header-anchor">#</a> ä¾‹å­</h5> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Payable {
    address payable public owner;

    constructor() {
        // ç›´æ¥èµ‹å€¼ä¼šæŠ¥é”™,å› ä¸º msg.sender ä¸æ˜¯ payable ç±»å‹çš„åœ°å€ã€‚
        // Type address is not implicitly convertible to expected type address payable.
        // owner = msg.sender;

        // ä½¿ç”¨ payable å‡½æ•°ï¼Œæ˜¾ç¤ºè½¬æ¢ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚
        owner = payable(msg.sender);
    }

    // deposit1 æ²¡æœ‰ payable æ ‡ç¤ºï¼›å¦‚æœä¼ å…¥ETHå¸ï¼Œä¼šæŠ¥é”™
    // transact to Payable.deposit1 errored: VM error: revert.
    function deposit1() external {}

    // deposit2 æœ‰ payableï¼Œ æ‰€ä»¥å¯ä»¥å‘é€ETHåˆ°åˆçº¦
    function deposit2() external payable {}

    function getBalance() external view returns (uint256) {
        // ä½¿ç”¨ address(this) å°±å¯ä»¥åŒ…è£…å½“å‰åˆçº¦ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨ .balance è·å–ä½™é¢äº†ã€‚
        return address(this).balance;
    }
}
</code></pre></div><p><strong>æ³¨æ„ç‚¹</strong>:</p> <ul><li>å¦‚æœçŠ¶æ€å˜é‡æ˜¯ <code>payable</code> ç±»å‹ï¼Œèµ‹å€¼çš„æ—¶å€™éœ€è¦ä½¿ç”¨ <code>payable()</code> è¿›è¡Œæ˜¾ç¤ºè½¬æ¢</li> <li>å¦‚æœå‡½æ•°æ²¡æœ‰ <code>payable</code> æ ‡ç¤ºï¼Œé‚£ä¹ˆè°ƒç”¨æ—¶å€™ä¸èƒ½å‘é€ç½‘ç»œä¸»å¸ã€‚
<ul><li>å¦‚æœå°è¯•è¿™ä¹ˆåšä¼šæ”¶åˆ°é”™è¯¯: <code>transact to Payable.functionName errored: VM error: revert.</code></li></ul></li></ul> <h5 id="è½¬æ¢-0-åœ°å€"><a href="#è½¬æ¢-0-åœ°å€" class="header-anchor">#</a> è½¬æ¢ 0 åœ°å€</h5> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    function getAddress()
        external
        pure
        returns (
            address,
            address,
            address,
            address,
            address
        )
    {
        return (address(0), address(1), address(3), address(6), address(999));
    }

    function getPayaableAddress() external pure returns (address) {
        // Explicit type conversion not allowed from &quot;int_const 1&quot; to &quot;address payable&quot;.
        // return payable(1);
        return payable(0);
    }
}
</code></pre></div><h4 id="â“·-transfer"><a href="#â“·-transfer" class="header-anchor">#</a> â“· transfer()</h4> <p>å°†ä½™é¢è½¬åˆ°å½“å‰åœ°å€ï¼ˆåˆçº¦åœ°å€è½¬è´¦ï¼‰,è¯­æ³•å¦‚ä¸‹:</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;address payable&gt;.transfer(uint256 amount)
</code></pre></div><ol><li>éœ€è¦ payable address</li> <li>ä½¿ç”¨å›ºå®šï¼ˆä¸å¯è°ƒèŠ‚ï¼‰çš„ 2300 gas çš„çŸ¿å·¥è´¹ï¼Œé”™è¯¯ä¼š reverts ï¼ˆå›æ»šæ‰€æœ‰çŠ¶æ€ï¼‰
<ol><li>2300 gas è¶³å¤Ÿè½¬è´¦ï¼Œä½†æ˜¯å¦‚æœæ¥æ”¶åˆçº¦å†…çš„ <code>fallback</code> å’Œ <code>receive</code> å‡½æ•°æœ‰æ¶æ„ä»£ç ï¼Œå¤æ‚ä»£ç ã€‚å®¹æ˜“å¯¼è‡´ gas è€—å°½çš„é”™è¯¯ã€‚</li></ol></li> <li>å¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸,
<ol><li>å¦‚æœå½“å‰åˆçº¦çš„ä½™é¢ä¸å¤Ÿå¤šï¼Œåˆ™ <code>transfer</code> å‡½æ•°ä¼šæ‰§è¡Œå¤±è´¥ï¼Œæˆ–è€…å¦‚æœä»¥å¤ªè½¬ç§»è¢«æ¥æ”¶å¸æˆ·æ‹’ç»ï¼Œ <code>transfer</code> å‡½æ•°åŒæ ·ä¼šå¤±è´¥è€Œè¿›è¡Œå›é€€ã€‚</li></ol></li> <li>å¦‚æœç›®æ ‡åœ°å€æ˜¯ä¸€ä¸ªåˆçº¦ï¼Œé‚£ä¹ˆç›®æ ‡åˆçº¦å†…éƒ¨çš„ receive/fallback å‡½æ•°ä¼šéšç€è°ƒç”¨ <code>transfer</code>å‡½æ•°ä¸€èµ·æ‰§è¡Œï¼Œè¿™æ˜¯ EVM çš„ç‰¹æ€§ï¼Œæ²¡åŠæ³•é˜»æ­¢ã€‚</li></ol> <p>ä¾‹å­æ¼”ç¤º:</p> <p>æ ¸å¿ƒ: <code>_to.transfer(200);</code></p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract SendEth {
    event Log(string funName, address from, uint256 value, bytes data);

    fallback() external payable {
        emit Log(&quot;fallback&quot;, msg.sender, msg.value, msg.data);
    }

    receive() external payable {
        emit Log(&quot;receive&quot;, msg.sender, msg.value, &quot;&quot;);
    }

    function getBalance() external view returns (uint256) {
        return address(this).balance;
    }

    // transfer :  åœ°å€å¿…é¡»ä¸º   payable ç±»å‹
    // æ–¹å¼ä¸€: å‚æ•°ä¸­ åœ°å€æ ‡æ³¨ address payable ,å¹¶ä¸”å‡½æ•°æ ‡æ³¨ payable; è¿™ç§æ›´çœ gas
    // 28767 gas
    function transfer1(address payable _to) external payable {
        _to.transfer(100);
    }

    // ä¹Ÿå¯ä»¥ åœ¨å†…éƒ¨è¿›è¡Œæ˜¾ç¤ºè½¬æ¢
    // æ–¹å¼äºŒ: ä»…åœ¨å†…éƒ¨è¿›è¡Œ payable(address) æ˜¾ç¤ºè½¬æ¢
    // 28813 gas
    function transfer2(address _to) external {
        payable(_to).transfer(200);
    }
}

</code></pre></div><h4 id="â“¸-send"><a href="#â“¸-send" class="header-anchor">#</a> â“¸ send()</h4> <p>å°†ä½™é¢è½¬åˆ°å½“å‰åœ°å€ï¼Œå¹¶<strong>è¿”å›äº¤æ˜“æˆåŠŸçŠ¶æ€</strong>ï¼ˆåˆçº¦åœ°å€è½¬è´¦ï¼‰</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;address payable&gt;.send(uint256 amount) returns (bool)
</code></pre></div><p><code>send</code> æ˜¯ <code>transfer</code> çš„ä½çº§ç‰ˆæœ¬ã€‚å¦‚æœæ‰§è¡Œå¤±è´¥ï¼Œå½“å‰çš„åˆçº¦ä¸ä¼šå› ä¸ºå¼‚å¸¸è€Œç»ˆæ­¢ã€‚<code>transfer</code> ç­‰ä»·äº<code>require(send())</code></p> <ol><li>éœ€è¦ payable address</li> <li>ä½¿ç”¨å›ºå®šï¼ˆä¸å¯è°ƒèŠ‚ï¼‰çš„ 2300 gas çš„çŸ¿å·¥è´¹ã€‚
<ol><li>gas åŒ<code>transfer</code>ä¸€æ ·çš„æ˜¯ 2300 gas ï¼›è¶³å¤Ÿè½¬è´¦ï¼Œä½†æ˜¯å¦‚æœæ¥æ”¶åˆçº¦å†…çš„ <code>fallback</code> å’Œ <code>receive</code> å‡½æ•°æœ‰æ¶æ„ä»£ç ï¼Œå¤æ‚ä»£ç ã€‚å®¹æ˜“å¯¼è‡´ gas è€—å°½çš„é”™è¯¯ã€‚</li></ol></li> <li>å¤±è´¥æ—¶ä»…ä¼šè¿”å› <code>false</code>ï¼Œä¸ä¼šç»ˆæ­¢æ‰§è¡Œï¼ˆåˆçº¦åœ°å€è½¬è´¦ï¼‰;
<ol><li><code>send()</code> æ‰§è¡Œæœ‰ä¸€äº›é£é™©ï¼šä¸ºäº†ä¿è¯å®‰å…¨ï¼Œå¿…é¡»æ£€æŸ¥ send çš„è¿”å›å€¼ï¼Œå¦‚æœäº¤æ˜“å¤±è´¥ï¼Œä¼šå›é€€ä»¥å¤ªå¸ã€‚</li></ol></li> <li>è¡¥å……ï¼šsend ä¸ transfer å¯¹åº”ï¼Œä½† <strong>send æ›´åº•å±‚</strong>ã€‚å¦‚æœæ‰§è¡Œå¤±è´¥ï¼Œtransfer ä¸ä¼šå› å¼‚å¸¸åœæ­¢ï¼Œè€Œ send ä¼šè¿”å› falseã€‚transfer ç›¸å¯¹ send è¾ƒå®‰å…¨</li></ol> <p>ä¾‹å­æ¼”ç¤º:</p> <p>æ ¸å¿ƒ: <code>bool success = _to.send(100);</code></p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract SendEth {
    event Log(string funName, address from, uint256 value, bytes data);

    fallback() external payable {
        emit Log(&quot;fallback&quot;, msg.sender, msg.value, msg.data);
    }

    receive() external payable {
        emit Log(&quot;receive&quot;, msg.sender, msg.value, &quot;&quot;);
    }

    function getBalance() external view returns (uint256) {
        return address(this).balance;
    }

    // 28791 gas
    function send1(address payable _to) external payable {
        bool success = _to.send(100);
        require(success, &quot;Send Faied&quot;);
    }

    // 28793 gas
    function send2(address _to) external {
        bool success = payable(_to).send(100);
        require(success, &quot;Send Faied&quot;);
    }
}
</code></pre></div><p><code>.transfer(uint256 amount)</code> å¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸, ç­‰ä»·äº<code>require(send())</code> ä½¿ç”¨å›ºå®šï¼ˆä¸å¯è°ƒèŠ‚ï¼‰çš„ 2300 gas çš„çŸ¿å·¥è´¹ï¼Œé”™è¯¯ä¼š reverts.</p> <h4 id="â“¹-call-delegatecall-staticcall"><a href="#â“¹-call-delegatecall-staticcall" class="header-anchor">#</a> â“¹ call/delegatecall/staticcall</h4> <p>ä¸ºäº†ä¸ä¸çŸ¥é“ ABI çš„åˆçº¦è¿›è¡Œäº¤äº’ï¼ŒSolidity æä¾›äº†å‡½æ•° <code>call</code>/<code>delegatecall</code>/<code>staticcall</code> ç›´æ¥æ§åˆ¶ç¼–ç ã€‚å®ƒä»¬éƒ½å¸¦æœ‰ä¸€ä¸ª <code>bytes memory</code> å‚æ•°å’Œè¿”å›æ‰§è¡Œ<strong>æˆåŠŸçŠ¶æ€</strong>ï¼ˆboolï¼‰å’Œ<strong>æ•°æ®</strong>ï¼ˆbytes memoryï¼‰ã€‚</p> <p>å‡½æ•° <code>abi.encode</code>ï¼Œ<code>abi.encodePacked</code>ï¼Œ<code>abi.encodeWithSelector</code> å’Œ <code>abi.encodeWithSignature</code> å¯ç”¨äºç¼–ç ç»“æ„åŒ–æ•°æ®ã€‚</p> <p><strong>å®ƒä»¬å¯ä»¥æ¥å—ä»»æ„ç±»å‹ï¼Œä»»æ„æ•°é‡çš„å‚æ•°</strong>ã€‚è¿™äº›å‚æ•°ä¼šè¢«æ‰“åŒ…åˆ°ä»¥ 32 å­—èŠ‚ä¸ºå•ä½çš„è¿ç»­åŒºåŸŸä¸­å­˜æ”¾ã€‚å…¶ä¸­ä¸€ä¸ª<strong>ä¾‹å¤–æ˜¯å½“ç¬¬ä¸€ä¸ªå‚æ•°è¢«ç¼–ç æˆæ­£å¥½ 4 ä¸ªå­—èŠ‚çš„æƒ…å†µ</strong>ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå‚æ•°åè¾¹ä¸ä¼šå¡«å……åç»­å‚æ•°ç¼–ç ï¼Œä»¥å…è®¸ä½¿ç”¨å‡½æ•°ç­¾åã€‚</p> <p>ä¸‹é¢å…·ä½“çš„ä»‹ç»ä¸‰ç§ callã€‚</p> <h4 id="â“º-call"><a href="#â“º-call" class="header-anchor">#</a> â“º call()</h4> <p>ç”¨ç»™å®šçš„æœ‰æ•ˆè½½è·ï¼ˆpayloadï¼‰å‘å‡ºä½çº§ <code>CALL</code> è°ƒç”¨ï¼Œå¹¶<strong>è¿”å›äº¤æ˜“æˆåŠŸçŠ¶æ€å’Œè¿”å›æ•°æ®</strong>ï¼ˆè°ƒç”¨åˆçº¦çš„æ–¹æ³•å¹¶è½¬è´¦ï¼‰, æ ¼å¼å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;address&gt;.call(bytes memory) returns (bool, bytes memory)
</code></pre></div><ol><li>ä½çº§ <code>CALL</code> è°ƒç”¨ï¼šä¸éœ€è¦ payable address, æ™®é€šåœ°å€å³å¯
<ol><li>æ³¨æ„: è°ƒç”¨ <code>call</code> çš„æ—¶å€™ï¼Œåœ°å€å¯ä»¥ä¸å…·å¤‡ payable å±æ€§</li></ol></li> <li>è¿”å›ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ª <code>bool</code> å€¼ä»£è¡¨æˆåŠŸæˆ–è€…å¤±è´¥ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å¯èƒ½å­˜åœ¨çš„ <code>data</code></li> <li>å‘é€æ‰€æœ‰å¯ç”¨ gasï¼Œä¹Ÿå¯ä»¥è‡ªå·±è°ƒèŠ‚ gasã€‚
<ol><li>å¦‚æœ <code>fallback</code> å’Œ <code>receive</code> å†…çš„ä»£ç ç›¸å¯¹å¤æ‚ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯å¦‚æœæ˜¯æ¶æ„ä»£ç ï¼Œéœ€è¦è€ƒè™‘æ¶ˆè€—çš„ gas æ˜¯å¦å€¼å¾—æ‰§è¡Œã€‚</li> <li><code>_ads.call{value: msg.value,gas:2300}(data)</code></li></ol></li> <li>å½“åˆçº¦è°ƒç”¨åˆçº¦æ—¶ï¼Œä¸çŸ¥é“å¯¹æ–¹æºç å’Œ ABI æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ call è°ƒç”¨å¯¹æ–¹åˆçº¦</li> <li>æ¨èä½¿ç”¨ call è½¬è´¦ ETHï¼Œä½†æ˜¯ä¸æ¨èä½¿ç”¨ call æ¥è°ƒç”¨å…¶ä»–åˆçº¦ã€‚
<ol><li>åŸå› æ˜¯: call è°ƒç”¨çš„æ—¶å€™ï¼Œå°†åˆçº¦æ§åˆ¶æƒäº¤ç»™å¯¹æ–¹ï¼Œå¦‚æœç¢°åˆ°æ¶æ„ä»£ç ï¼Œæˆ–è€…ä¸å®‰å…¨çš„ä»£ç å°±å¾ˆå®¹æ˜“å‡‰å‡‰ã€‚</li></ol></li> <li>å½“è°ƒç”¨ä¸å­˜åœ¨çš„åˆçº¦æ–¹æ³•æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹æ–¹åˆçº¦å†…çš„ <code>fallback</code> æˆ–è€… <code>receive</code>ã€‚
<ol><li>æˆ‘ä»¬çš„åˆçº¦ä¹Ÿå¯ä»¥åœ¨ <code>fallback</code> / <code>receive</code> è¿™ä¸¤ä¸ªæ–¹æ³•å†…æŠ›å‡ºäº‹ä»¶ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰äººå¯¹å…¶åšäº†ä»€ä¹ˆæ“ä½œã€‚</li></ol></li> <li>ä¸‰ç§æ–¹æ³•éƒ½æä¾› <code>gas</code> é€‰é¡¹ï¼Œè€Œ <code>value</code> é€‰é¡¹ä»… <code>call</code> æ”¯æŒ ã€‚ä¸‰ç§ call é‡Œåªæœ‰ <code>call</code> å¯ä»¥è¿›è¡Œ ETH è½¬è´¦ï¼Œå…¶ä»–ä¸¤ç§ä¸å¯ä»¥è¿›è¡Œè½¬è´¦ã€‚</li></ol> <p><strong>ä¾‹å­ 1:å‘é€ ETH</strong></p> <p>æ ¸å¿ƒ: <code>(bool success, ) = _to.call{value: 100}(&quot;&quot;);</code></p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract SendEth {
    event Log(string funName, address from, uint256 value, bytes data);

    fallback() external payable {
        emit Log(&quot;fallback&quot;, msg.sender, msg.value, msg.data);
    }

    receive() external payable {
        emit Log(&quot;receive&quot;, msg.sender, msg.value, &quot;&quot;);
    }

    function getBalance() external view returns (uint256) {
        return address(this).balance;
    }

    // 29005
    function call1(address payable _to) external payable {
        (bool success, bytes memory data) = _to.call{value: 100}(&quot;&quot;);
        require(success, &quot;call Faied&quot;);
    }

    // 29007
    function call2(address _to) external {
        (bool success, bytes memory data) = payable(_to).call{value: 100}(&quot;&quot;);
        require(success, &quot;call Faied&quot;);
    }
}
</code></pre></div><p><strong>ä¾‹å­ 2ï¼ˆé‡è¦ï¼‰ï¼šè°ƒç”¨å…¶ä»–åˆçº¦æ–¹æ³•</strong></p> <p><strong>å®Œæ•´ä»£ç å¦‚ä¸‹</strong>:</p> <p>åˆ†åˆ«ä½¿ç”¨ <code>Test1</code> å’Œ <code>Test2</code> çš„åœ°å€è¿›è¡Œæµ‹è¯•ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test1 {
    string public name;
    uint256 public age;
    address public owner;
    event Log(string message);

    fallback() external payable {
        emit Log(&quot;fallback was called&quot;);
    }

    receive() external payable {
        emit Log(&quot;receive was called&quot;);
    }

    function setNameAndAge(string memory name_, uint256 age_)
        external
        payable
        returns (string memory __name, uint256 __age)
    {
        name = name_;
        age = age_;
        owner = msg.sender;
        return (name_, age_);
    }

    // è·å–åˆçº¦çš„ä½™é¢
    function getBalance() external view returns (uint256) {
        return address(this).balance;
    }
}

contract Test2 {}

contract CallTest {
    // éœ€è¦ä¸€ä¸ªç½‘é¡µï¼ŒåŠ¨æ€çš„è§£æ _bys
    bytes public bys;

    function call_Test1_setNameAndAge(
        address ads_,
        string memory name_,
        uint256 age_
    ) external payable {
        bytes memory data = abi.encodeWithSignature(
            &quot;setNameAndAge(string,uint256)&quot;,
            name_,
            age_
        );
        (bool success, bytes memory _bys) = ads_.call{value: msg.value}(data);
        require(success, &quot;Call Failed&quot;);
        bys = _bys;
    }
}
</code></pre></div><p>ç®€å•è¯´ä¸‹è¿™ä¸ªä¾‹å­çš„åŸç†</p> <div class="language- extra-class"><pre class="language-text"><code>/**
æ™®é€šè°ƒç”¨
ç”¨æˆ·A è°ƒç”¨ callB åˆçº¦, å‘é€ 100 wei ; callB è°ƒç”¨ Test1, å‘é€ 50 wei
æ­¤æ—¶åœ¨ Test1 åˆçº¦å†…éƒ¨
        msg.sender = B
        msg.value = 50
        Test1 å†…éƒ¨å¦‚æœæœ‰çŠ¶æ€å˜é‡ä¿®æ”¹ï¼Œåˆ™ä¼šè¢«ä¿®æ”¹
        å‘é€åˆ° Test1 å†…çš„ETHä¸»å¸ä¹Ÿä¼šè¢«ç•™åœ¨Test1å†…
 */
</code></pre></div><p><strong>call æ ¸å¿ƒä»£ç å¦‚ä¸‹</strong></p> <div class="language- extra-class"><pre class="language-text"><code>bytes memory data = abi.encodeWithSignature(
    &quot;setNameAndAge(string,uint256)&quot;,
    _name,
    _age
);
(bool success, bytes memory _bys) = _ads.call{value: msg.value}(data);
require(success, &quot;Call Failed&quot;);
bys = _bys;
</code></pre></div><h4 id="â“»-delegatecall-å§”æ‰˜è°ƒç”¨"><a href="#â“»-delegatecall-å§”æ‰˜è°ƒç”¨" class="header-anchor">#</a> â“» delegatecall() å§”æ‰˜è°ƒç”¨</h4> <p>å‘å‡ºä½çº§å‡½æ•° <code>DELEGATECALL</code>ï¼Œå¤±è´¥æ—¶è¿”å› falseï¼Œå‘é€æ‰€æœ‰å¯ç”¨ gasï¼Œä¹Ÿå¯ä»¥è‡ªå·±è°ƒèŠ‚ gasã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;address&gt;.delegatecall(bytes memory) returns (bool, bytes memory)
</code></pre></div><p><code>delegatecall</code> ä½¿ç”¨æ–¹æ³•å’Œ <code>call</code> å®Œå…¨ä¸€æ ·ã€‚åŒºåˆ«åœ¨äºï¼Œ<code>delegatecall</code> åªè°ƒç”¨ç»™å®šåœ°å€çš„ä»£ç ï¼ˆå‡½æ•°ï¼‰ï¼Œå…¶ä»–çŠ¶æ€å±æ€§å¦‚ï¼ˆå­˜å‚¨ï¼Œä½™é¢ â€¦ï¼‰éƒ½æ¥è‡ªå½“å‰åˆçº¦ã€‚<code>delegatecall</code> çš„ç›®çš„æ˜¯ä½¿ç”¨å¦ä¸€ä¸ªåˆçº¦ä¸­çš„åº“ä»£ç ã€‚</p> <p>å§”æ‰˜è°ƒç”¨æ˜¯ï¼š<strong>å§”æ‰˜å¯¹æ–¹è°ƒç”¨è‡ªå·±æ•°æ®çš„</strong>ã€‚ç±»ä¼¼æˆæƒè½¬è´¦ï¼Œæ¯”å¦‚æˆ‘éƒ¨ç½²ä¸€ä¸ª Bank åˆçº¦ï¼Œ æˆæƒ ContractA ä½¿ç”¨ Bank åœ°å€å†…çš„èµ„é‡‘ï¼ŒContractA åªæ‹¥æœ‰æ§åˆ¶æƒï¼Œä½†æ˜¯æ²¡æœ‰æ‹¥æœ‰æƒã€‚</p> <ul><li>å§”æ‰˜è°ƒç”¨åï¼Œæ‰€æœ‰å˜é‡ä¿®æ”¹éƒ½æ˜¯å‘ç”Ÿåœ¨å§”æ‰˜åˆçº¦å†…éƒ¨ï¼Œå¹¶ä¸ä¼šä¿å­˜åœ¨è¢«å§”æ‰˜åˆçº¦ä¸­ã€‚
<ul><li>åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå¯ä»¥é€šè¿‡æ›´æ¢è¢«å§”æ‰˜åˆçº¦ï¼Œæ¥å‡çº§å§”æ‰˜åˆçº¦ã€‚</li></ul></li> <li>å§”æ‰˜è°ƒç”¨åˆçº¦å†…éƒ¨ï¼Œéœ€è¦å’Œè¢«å§”æ‰˜åˆçº¦çš„å†…éƒ¨å‚æ•°å®Œå…¨ä¸€æ ·ï¼Œå¦åˆ™å®¹æ˜“å¯¼è‡´æ•°æ®æ··ä¹±
<ul><li>å¯ä»¥é€šè¿‡é¡ºåºæ¥é¿å…è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æ¨èå®Œå…¨ä¸€æ ·</li></ul></li></ul> <p><strong>ä¾‹å­ 1ï¼ˆé‡è¦ï¼‰</strong></p> <p>ä»£ç å¦‚ä¸‹:</p> <ul><li><code>DelegateCall</code> æ˜¯å§”æ‰˜åˆçº¦</li> <li><code>TestVersion1</code> æ˜¯ç¬¬ 1 æ¬¡è¢«å§”æ‰˜åˆçº¦</li> <li><code>TestVersion2</code> æ˜¯ç¬¬ 2 æ¬¡è¢«å§”æ‰˜åˆçº¦</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// åˆçº¦ç‰ˆæœ¬ V.1
contract TestVersion1 {
    address public sender;
    uint256 public value;
    uint256 public num;

    function set(uint256 num_) external payable {
        sender = msg.sender;
        value = msg.value;
        num = num_;
    }
}

// åˆçº¦ç‰ˆæœ¬ V.2
contract TestVersion2 {
    address public sender;
    uint256 public value;
    uint256 public num;

    function set(uint256 num_) external payable {
        sender = msg.sender;
        value = msg.value;
        num = num_ * 2;
    }
}

// å§”æ‰˜è°ƒç”¨æµ‹è¯•
contract DelegateCall {
    address public sender;
    uint256 public value;
    uint256 public num;

    function set(address _ads, uint256 num_) external payable {
        sender = msg.sender;
        value = msg.value;
        num = num_;
        // ç¬¬1ç§ encode
        // ä¸éœ€çŸ¥é“åˆçº¦åå­—ï¼Œå‡½æ•°å®Œå…¨è‡ªå®šä¹‰
        bytes memory data1 = abi.encodeWithSignature(&quot;set(uint256)&quot;, num_);
        // ç¬¬2ç§ encode
        // éœ€è¦åˆçº¦åå­—ï¼Œå¯ä»¥é¿å…å‡½æ•°å’Œå‚æ•°å†™é”™
        bytes memory data2 = abi.encodeWithSelector(TestVersion1.set.selector, num_);

        (bool success, bytes memory _data) = _ads.delegatecall(data2);

        require(success, &quot;DelegateCall set failed&quot;);
    }
}
</code></pre></div><p>ç®€å•è¯´ä¸‹è¿™ä¸ªä¾‹å­çš„åŸç†</p> <div class="language- extra-class"><pre class="language-text"><code>/**
å§”æ‰˜è°ƒç”¨
ç”¨æˆ·A è°ƒç”¨ DelegateCallB åˆçº¦, å‘é€ 100 wei ; DelegateCallB å§”æ‰˜è°ƒç”¨ Test1
æ­¤æ—¶åœ¨ Test1 åˆçº¦å†…éƒ¨
        msg.sender = A
        msg.value = 100
        Test1 å†…éƒ¨å¦‚æœæœ‰çŠ¶æ€å˜é‡ä¿®æ”¹ï¼Œä¹Ÿä¸ä¼šè¢«ä¿®æ”¹ï¼Œä¼šåœ¨DelegateCallB å†…æ”¹å˜
        å‘é€åˆ° Test1 å†…çš„ETHä¸»å¸ï¼Œä¼šè¢«ç•™åœ¨ DelegateCallB å†…ï¼Œä¸ä¼šåœ¨Test1 å†…
 */
</code></pre></div><h4 id="â“¼-staticcall-é™æ€è°ƒç”¨"><a href="#â“¼-staticcall-é™æ€è°ƒç”¨" class="header-anchor">#</a> â“¼ staticcall() é™æ€è°ƒç”¨</h4> <p>ç”¨ç»™å®šçš„æœ‰æ•ˆè½½è·ï¼ˆpayloadï¼‰å‘å‡ºä½çº§ <code>STATICCALL</code> è°ƒç”¨ï¼Œå¹¶<strong>è¿”å›äº¤æ˜“æˆåŠŸçŠ¶æ€å’Œè¿”å›æ•°æ®</strong>ï¼ˆè°ƒç”¨åˆçº¦çš„æ–¹æ³•å¹¶è½¬è´¦ï¼‰</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;address&gt;.staticcall(bytes memory) returns (bool, bytes memory)
</code></pre></div><p>å®ƒä¸ call åŸºæœ¬ç›¸åŒï¼Œå‘é€æ‰€æœ‰å¯ç”¨ gasï¼Œä¹Ÿå¯ä»¥è‡ªå·±è°ƒèŠ‚ gasï¼Œ<strong>ä½†å¦‚æœè¢«è°ƒç”¨çš„å‡½æ•°ä»¥ä»»ä½•æ–¹å¼ä¿®æ”¹çŠ¶æ€å˜é‡ï¼Œéƒ½å°†å›é€€</strong>ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// è¢«è°ƒç”¨çš„åˆçº¦
contract Hello1 {
    function echo() external pure returns (string memory) {
        return &quot;Hello World!&quot;;
    }
}

contract Hello2 {
    uint8 public a;
    function echo() external returns (string memory) {
        a = 1;
        return &quot;Hello World!&quot;;
    }
}

// è°ƒç”¨è€…åˆçº¦
contract SoldityTest {
    function callHello(address ads_) external view returns (string memory) {
        // ç¼–ç è¢«è°ƒç”¨è€…çš„æ–¹æ³•ç­¾å
        bytes4 methodId = bytes4(keccak256(&quot;echo()&quot;));

        // è°ƒç”¨åˆçº¦
        (bool success, bytes memory data) = ads_.staticcall(
            abi.encodeWithSelector(methodId)
        );
        if (success) {
            return abi.decode(data, (string));
        } else {
            return &quot;error&quot;;
        }
    }
}
</code></pre></div><h4 id="â“½-ä¸‰ç§-call-çš„æ€»ç»“"><a href="#â“½-ä¸‰ç§-call-çš„æ€»ç»“" class="header-anchor">#</a> â“½ ä¸‰ç§ call çš„æ€»ç»“</h4> <ol><li><code>call</code> ï¼Œ <code>delegatecall</code> å’Œ <code>staticcall</code> éƒ½æ˜¯éå¸¸ä½çº§çš„å‡½æ•°ï¼Œåº”è¯¥åªæŠŠå®ƒä»¬å½“ä½œæœ€åä¸€æ‹›æ¥ä½¿ç”¨ï¼Œå®ƒä»¬ç ´åäº† Solidity çš„ç±»å‹å®‰å…¨æ€§ã€‚</li> <li>ä¸‰ç§æ–¹æ³•éƒ½æä¾› <code>gas</code> é€‰é¡¹ï¼Œè€Œ <code>value</code> é€‰é¡¹ä»… <code>call</code> æ”¯æŒ ã€‚æ‰€ä»¥ä¸‰ç§ call é‡Œåªæœ‰ <code>call</code> å¯ä»¥è¿›è¡Œ ETH è½¬è´¦ï¼Œå…¶ä»–ä¸¤ç§ä¸å¯ä»¥è¿›è¡Œè½¬è´¦ã€‚</li> <li>ä¸ç®¡æ˜¯è¯»å–çŠ¶æ€è¿˜æ˜¯å†™å…¥çŠ¶æ€ï¼Œæœ€å¥½é¿å…åœ¨åˆçº¦ä»£ç ä¸­ç¡¬ç¼–ç ä½¿ç”¨çš„ gas å€¼ã€‚è¿™å¯èƒ½ä¼šå¼•å…¥<strong>é”™è¯¯</strong>ï¼Œè€Œä¸” gas çš„æ¶ˆè€—ä¹Ÿæ˜¯åŠ¨æ€æ”¹å˜çš„ã€‚</li> <li>å¦‚æœåœ¨é€šè¿‡ä½çº§å‡½æ•° <code>delegatecall</code> å‘èµ·è°ƒç”¨æ—¶éœ€è¦è®¿é—®å­˜å‚¨ä¸­çš„å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªåˆçº¦çš„å­˜å‚¨å¸ƒå±€éœ€è¦ä¸€è‡´ï¼Œä»¥ä¾¿è¢«è°ƒç”¨çš„åˆçº¦ä»£ç å¯ä»¥æ­£ç¡®åœ°é€šè¿‡å˜é‡åè®¿é—®åˆçº¦çš„å­˜å‚¨å˜é‡ã€‚ è¿™ä¸æ˜¯æŒ‡åœ¨åº“å‡½æ•°è°ƒç”¨ï¼ˆé«˜çº§çš„è°ƒç”¨æ–¹å¼ï¼‰æ—¶æ‰€ä¼ é€’çš„å­˜å‚¨å˜é‡æŒ‡é’ˆéœ€è¦æ»¡è¶³é‚£æ ·æƒ…å†µã€‚</li></ol> <blockquote><p>âš ï¸ æ³¨æ„: åœ¨ 0.5.0 ç‰ˆæœ¬ä»¥å‰, <code>.call</code>, <code>.delegatecall</code> and <code>.staticcall</code> ä»…ä»…è¿”å›æˆåŠŸçŠ¶æ€ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚</p></blockquote> <blockquote><p>âš ï¸ åœ¨ 0.5.0 ç‰ˆæœ¬ä»¥å‰, è¿˜æœ‰ä¸€ä¸ª <code>callcode</code> å‡½æ•°ï¼Œç°åœ¨å·²ç»å»é™¤ã€‚</p></blockquote> <h4 id="â“¾-transfer-send-call-ä¸‰ç§è½¬è´¦çš„æ€»ç»“"><a href="#â“¾-transfer-send-call-ä¸‰ç§è½¬è´¦çš„æ€»ç»“" class="header-anchor">#</a> â“¾ transfer / send / call ä¸‰ç§è½¬è´¦çš„æ€»ç»“</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    mapping(address =&gt; uint256) public balances;

    function deposit() public payable {
        balances[msg.sender] += msg.value;
    }

    function byTransfer() public {
        payable(msg.sender).transfer(100);
    }

    function bySend() public {
        bool success = payable(msg.sender).send(100);
        require(success, &quot;Send Fail&quot;);
    }

    // å¦‚æœä½¿ç”¨ transfer æˆ– send å‡½æ•°å¿…é¡»æ·»åŠ fallbackå›é€€å‡½æ•°
    fallback() external {}

    receive() external payable {}
}
</code></pre></div><p>ç›¸åŒç‚¹:</p> <ul><li>ä¸‰ç§æ–¹æ³•éƒ½å¯ä»¥è¿›è¡Œè½¬è´¦</li> <li><code>_to.transfer(100)</code>ã€<code>_to.send(100)</code>ã€<code>_to.call{value: 100}(&quot;&quot;)</code> çš„æ¥æ”¶æ–¹éƒ½æ˜¯<code>_to</code>ã€‚
<ul><li>å¦‚æœ<code>_to</code>æ˜¯åˆçº¦ï¼Œåˆ™åˆçº¦ä¸­å¿…é¡»å¢åŠ  <code>fallback</code> æˆ–è€… <code>receive</code> å‡½æ•°ï¼</li> <li>å¦åˆ™æŠ¥é”™<code>In order to receive Ether transfer the contract should have either 'receive' or payable 'fallback' function</code></li></ul></li></ul> <p>ä¸åŒç‚¹:</p> <ul><li>ä½çº§ <code>CALL</code> è°ƒç”¨ï¼šä¸éœ€è¦ <code>payable address</code> <ul><li>transfer å’Œ send åªèƒ½æ˜¯ <code>payable address</code></li></ul></li> <li><code>call</code> çš„ gas å¯ä»¥åŠ¨æ€è°ƒæ•´
<ul><li>transfer å’Œ send åªèƒ½æ˜¯å›ºå®šåˆ¶ <code>2300</code></li></ul></li> <li><code>call</code> é™¤äº†å¯ä»¥è½¬è´¦å¤–ï¼Œå¯ä»¥è¿˜å¯ä»¥è°ƒç”¨ä¸çŸ¥é“ ABI çš„æ–¹æ³•ï¼Œè¿˜å¯ä»¥è°ƒç”¨çš„æ—¶å€™è½¬è´¦
<ul><li>å½“è°ƒç”¨ä¸å­˜åœ¨çš„åˆçº¦æ–¹æ³•æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹æ–¹åˆçº¦å†…çš„ <code>fallback</code> æˆ–è€… <code>receive</code>ã€‚</li> <li>å¦‚æœä½¿ç”¨ <code>_to.call{value: 100}(data)</code>ï¼Œé‚£ä¹ˆ<code>data</code>ä¸­è¢«è°ƒç”¨çš„æ–¹æ³•å¿…é¡»æ·»åŠ  <code>payable</code> ä¿®é¥°ç¬¦ï¼Œå¦åˆ™è½¬è´¦å¤±è´¥ï¼</li> <li>å› ä¸ºå¯ä»¥è°ƒç”¨æ–¹æ³•ï¼Œæ‰€ä»¥ call æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œé™¤äº†ä¸€ä¸ª <code>bool</code> å€¼ä»£è¡¨æˆåŠŸæˆ–è€…å¤±è´¥ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å¯èƒ½å­˜åœ¨çš„ <code>data</code>ï¼Œæ¯”å¦‚åˆ›å»ºåˆçº¦æ—¶å€™å¾—åˆ°éƒ¨ç½²çš„åœ°å€ï¼Œè°ƒç”¨å‡½æ•°æ—¶å€™å¾—åˆ°çš„å‡½æ•°æ”¾å›å€¼ã€‚</li></ul></li></ul> <h4 id="_0-æ³¨æ„äº‹é¡¹Â·"><a href="#_0-æ³¨æ„äº‹é¡¹Â·" class="header-anchor">#</a> â“ª æ³¨æ„äº‹é¡¹Â·</h4> <p><strong>send</strong></p> <p>ä½¿ç”¨ send æœ‰å¾ˆå¤šå±é™©ï¼šå¦‚æœè°ƒç”¨æ ˆæ·±åº¦å·²ç»è¾¾åˆ° 1024ï¼ˆè¿™æ€»æ˜¯å¯ä»¥ç”±è°ƒç”¨è€…æ‰€å¼ºåˆ¶æŒ‡å®šï¼‰ï¼Œè½¬è´¦ä¼šå¤±è´¥ï¼›å¹¶ä¸”å¦‚æœæ¥æ”¶è€…ç”¨å…‰äº† gasï¼Œè½¬è´¦åŒæ ·ä¼šå¤±è´¥ã€‚ä¸ºäº†ä¿è¯ä»¥å¤ªå¸è½¬è´¦å®‰å…¨ï¼Œæ€»æ˜¯æ£€æŸ¥ send çš„è¿”å›å€¼ï¼Œåˆ©ç”¨ transfer æˆ–è€…ä¸‹é¢æ›´å¥½çš„æ–¹å¼ï¼š ç”¨è¿™ç§æ¥æ”¶è€…å–å›é’±çš„æ¨¡å¼ã€‚</p> <p><strong>call</strong></p> <p>åœ¨æ‰§è¡Œå¦ä¸€ä¸ªåˆçº¦å‡½æ•°æ—¶ï¼Œåº”è¯¥å°½å¯èƒ½é¿å…ä½¿ç”¨ .call() ï¼Œå› ä¸ºå®ƒç»•è¿‡äº†ç±»å‹æ£€æŸ¥ï¼Œå‡½æ•°å­˜åœ¨æ£€æŸ¥å’Œå‚æ•°æ‰“åŒ…ã€‚</p> <p>ç”±äº EVM ä¼šæŠŠå¯¹ä¸€ä¸ªä¸å­˜åœ¨çš„åˆçº¦çš„è°ƒç”¨ä½œä¸ºæ˜¯æˆåŠŸçš„ã€‚ Solidity ä¼šåœ¨æ‰§è¡Œå¤–éƒ¨è°ƒç”¨æ—¶ä½¿ç”¨ extcodesize æ“ä½œç è¿›è¡Œé¢å¤–æ£€æŸ¥ã€‚ è¿™ç¡®ä¿äº†å³å°†è¢«è°ƒç”¨çš„åˆçº¦è¦ä¹ˆå®é™…å­˜åœ¨ï¼ˆå®ƒåŒ…å«ä»£ç ï¼‰æˆ–è€…è§¦å‘ä¸€ä¸ªå¼‚å¸¸ã€‚ä½çº§è°ƒç”¨ä¸ åŒ…æ‹¬è¿™ä¸ªæ£€æŸ¥ï¼Œ<strong>è¿™ä½¿å¾—å®ƒä»¬åœ¨ GAS æ–¹é¢æ›´ä¾¿å®œï¼Œä½†ä¹Ÿæ›´ä¸å®‰å…¨</strong>ã€‚</p> <p>ä¸Šé¢çš„è¿™ä¸‰ä¸ª call æ–¹æ³•éƒ½æ˜¯åº•å±‚çš„æ¶ˆæ¯ä¼ é€’è°ƒç”¨ï¼Œæœ€å¥½ä»…åœ¨ä¸‡ä¸å¾—å·²æ‰è¿›è¡Œä½¿ç”¨ï¼Œå› ä¸ºä»–ä»¬ç ´åäº† Solidity çš„ç±»å‹å®‰å…¨ã€‚</p> <h2 id="_5ï¸âƒ£-å€¼ç±»å‹-åˆçº¦ç±»å‹"><a href="#_5ï¸âƒ£-å€¼ç±»å‹-åˆçº¦ç±»å‹" class="header-anchor">#</a> 5ï¸âƒ£ å€¼ç±»å‹:åˆçº¦ç±»å‹</h2> <p>æ¯ä¸€ä¸ªåˆçº¦å®šä¹‰éƒ½æœ‰ä»–è‡ªå·±çš„ç±»å‹ã€‚</p> <ul><li>å¯ä»¥éšå¼åœ°å°†åˆçº¦è½¬æ¢ä¸ºä»ä»–ä»¬ç»§æ‰¿çš„åˆçº¦ã€‚</li> <li>åˆçº¦å¯ä»¥æ˜¾å¼è½¬æ¢ä¸º <code>address</code> ç±»å‹ã€‚</li> <li>å¯ä»¥è½¬æ¢ä¸º <code>address payable</code> ç±»å‹</li></ul> <p>âš ï¸ æ³¨æ„ï¼šåˆçº¦ä¸æ”¯æŒä»»ä½•è¿ç®—ç¬¦ã€‚</p> <h3 id="æœ¬èŠ‚é…å¥—è§†é¢‘-14"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-14" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h3> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=27" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 5 èŠ‚å€¼ç±»å‹:åˆçº¦ç±»å‹</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=CU5PbGUCeio&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=27" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 5 èŠ‚å€¼ç±»å‹:åˆçº¦ç±»å‹</a></li></ul> <h3 id="_1-åˆ›å»ºçš„ä¾‹å­"><a href="#_1-åˆ›å»ºçš„ä¾‹å­" class="header-anchor">#</a> 1.åˆ›å»ºçš„ä¾‹å­</h3> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract A {
    uint256 public a = 123;

    fallback() external {}

    receive() external payable {}
}

contract C {
    A public a1;
    // A public a1 = A(payable(0xa0808B3e1713ff8C66b89aa4d0033c9ACfe37016));
    A public a2 = new A();

    // å…ˆéƒ¨ç½²åï¼Œç„¶åä¼ å…¥åœ°å€
    function getA1(A _a) external pure returns (address, address) {
        return (address(_a), payable(address(_a)));
    }

    // å†…éƒ¨ç›´æ¥newåˆ›å»º
    function getA2() external view returns (address, address) {
        return (address(a2), payable(address(a2)));
    }


    function test1(A _a) external view returns (uint256) {
        return _a.a();
    }
    function test2() external view returns (uint256) {
        return a2.a();
    }
}
</code></pre></div><p>å¦‚æœå£°æ˜ä¸€ä¸ªåˆçº¦ç±»å‹çš„å±€éƒ¨å˜é‡ï¼ˆ <code>MyContract c</code> ï¼‰ï¼Œåˆ™å¯ä»¥è°ƒç”¨è¯¥åˆçº¦çš„å‡½æ•°ã€‚ æ³¨æ„éœ€è¦èµ‹ç›¸åŒåˆçº¦ç±»å‹çš„å€¼ç»™å®ƒã€‚</p> <p>è¿˜å¯ä»¥å®ä¾‹åŒ–åˆçº¦ï¼ˆå³æ–°åˆ›å»ºä¸€ä¸ªåˆçº¦å¯¹è±¡ï¼‰ï¼Œä½¿ç”¨ <code>new</code> åˆ›å»ºåˆçº¦ã€‚</p> <p>åˆçº¦å’Œ address çš„æ•°æ®è¡¨ç¤ºæ˜¯ç›¸åŒçš„.</p> <h3 id="_2-è½¬é’±çš„ä¾‹å­"><a href="#_2-è½¬é’±çš„ä¾‹å­" class="header-anchor">#</a> 2.è½¬é’±çš„ä¾‹å­</h3> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract A {
    uint256 public a = 123;

    fallback() external {}

    receive() external payable {}
}

contract B {
    // æ²¡æœ‰ fallback / receive
    uint256 public b = 123;
}

contract C {
    A public a = new A();
    B public b = new B();

    function transferA() external payable returns (address, address) {
        payable(address(a)).transfer(msg.value);
        return (address(a), payable(address(a)));
    }


    function transferB() external payable returns (address, address) {
        payable(address(b)).transfer(msg.value);
        return (address(b), payable(address(b)));
    }

        // è·å–åˆçº¦çš„ä½™é¢
    function getBalance(address ads_) external view returns (uint256) {
        return ads_.balance;
    }
}
</code></pre></div><h3 id="_3-åˆçº¦çš„å±æ€§"><a href="#_3-åˆçº¦çš„å±æ€§" class="header-anchor">#</a> 3.åˆçº¦çš„å±æ€§</h3> <p>åˆçº¦ç±»å‹çš„æˆå‘˜æ˜¯åˆçº¦çš„å¤–éƒ¨å‡½æ•°åŠ public çš„ çŠ¶æ€å˜é‡ã€‚</p> <p>å¯¹äºåˆçº¦ C å¯ä»¥ä½¿ç”¨ type(C) è·å–åˆçº¦çš„ç±»å‹ä¿¡æ¯ï¼Œ</p> <ul><li><code>type(C).name</code> <ul><li>è·å¾—åˆçº¦å</li></ul></li> <li><code>type(C).creationCode</code> <ul><li>è·å¾—åŒ…å«åˆ›å»ºåˆçº¦å­—èŠ‚ç çš„å†…å­˜å­—èŠ‚æ•°ç»„ã€‚</li> <li>è¯¥å€¼å’Œåˆçº¦å†…ä½¿ç”¨ <code>address(this).code;</code> ç»“æœä¸€æ ·ã€‚</li> <li>å®ƒå¯ä»¥åœ¨å†…è”æ±‡ç¼–ä¸­æ„å»ºè‡ªå®šä¹‰åˆ›å»ºä¾‹ç¨‹ï¼Œå°¤å…¶æ˜¯ä½¿ç”¨ <code>create2</code> æ“ä½œç ã€‚</li> <li>ä¸èƒ½åœ¨åˆçº¦æœ¬èº«æˆ–æ´¾ç”Ÿçš„åˆçº¦è®¿é—®æ­¤å±æ€§ã€‚ å› ä¸ºä¼šå¼•èµ·å¾ªç¯å¼•ç”¨ã€‚</li></ul></li> <li><code>type(C).runtimeCode</code> <ul><li>è·å¾—åˆçº¦çš„è¿è¡Œæ—¶å­—èŠ‚ç çš„å†…å­˜å­—èŠ‚æ•°ç»„ã€‚è¿™æ˜¯é€šå¸¸ç”± <code>C</code> çš„æ„é€ å‡½æ•°éƒ¨ç½²çš„ä»£ç ã€‚</li> <li>å¦‚æœ <code>C</code> æœ‰ä¸€ä¸ªä½¿ç”¨å†…è”æ±‡ç¼–çš„æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆå¯èƒ½ä¸å®é™…éƒ¨ç½²çš„å­—èŠ‚ç ä¸åŒã€‚</li> <li>è¿˜è¦æ³¨æ„åº“åœ¨éƒ¨ç½²æ—¶ä¿®æ”¹å…¶è¿è¡Œæ—¶å­—èŠ‚ç ä»¥é˜²èŒƒå®šæœŸè°ƒç”¨ï¼ˆguard against regular callsï¼‰ã€‚ ä¸ <code>.creationCode</code> æœ‰ç›¸åŒçš„é™åˆ¶ï¼Œä¸èƒ½åœ¨åˆçº¦æœ¬èº«æˆ–æ´¾ç”Ÿçš„åˆçº¦è®¿é—®æ­¤å±æ€§ã€‚ å› ä¸ºä¼šå¼•èµ·å¾ªç¯å¼•ç”¨ã€‚</li></ul></li></ul> <h4 id="â“µ-æ— -constructor"><a href="#â“µ-æ— -constructor" class="header-anchor">#</a> â“µ æ—  constructor</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    address public owner;

    function getCode() public view returns (bytes memory) {
        return address(this).code;
    }
}

contract C {
    string public name = type(Test).name;

    bytes public creationCode = type(Test).creationCode;

    bytes public runtimeCode = type(Test).runtimeCode;
}

// Test.getCode
//

// creationCode
//

// runtimeCode
// å’Œ Test.getCode ç›¸åŒ
</code></pre></div><h4 id="â“¶-æœ‰-constructor"><a href="#â“¶-æœ‰-constructor" class="header-anchor">#</a> â“¶ æœ‰ constructor</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    address public owner;

    constructor() {
        owner = msg.sender;
    }

    function getCode() public view returns (bytes memory) {
        return address(this).code;
    }
}

contract C {
    string public name = type(Test).name;

    bytes public creationCode = type(Test).creationCode;

    // runtimeCode ä¸èƒ½è·å– constructor ä¿®æ”¹ immutable å˜é‡çš„æ•°æ®
    // æ¯”å¦‚ Test é‡Œçš„owner ä¸èƒ½æ˜¯ immutable ç±»å‹
    // &quot;runtimeCode&quot; is not available for contracts containing immutable variables.
    // ç­‰äºåˆçº¦åœ°å€ä¸Šçš„å±æ€§ address(this).code
    bytes public runtimeCode = type(Test).runtimeCode;
}

// Test.getCode
//

// creationCode
//

// runtimeCode
// å’Œ Test.getCode ç›¸åŒ
</code></pre></div><h2 id="_6ï¸âƒ£-å¼•ç”¨ç±»å‹çš„é¢å¤–æ³¨è§£-æ•°æ®ä½ç½®"><a href="#_6ï¸âƒ£-å¼•ç”¨ç±»å‹çš„é¢å¤–æ³¨è§£-æ•°æ®ä½ç½®" class="header-anchor">#</a> 6ï¸âƒ£ å¼•ç”¨ç±»å‹çš„é¢å¤–æ³¨è§£:æ•°æ®ä½ç½®</h2> <p>data location ï¼Œä¸­æ–‡åä¸ºæ•°æ®ä½ç½®ã€‚</p> <p>åœ¨è®²å¼•ç”¨ç±»å‹ä¹‹å‰ï¼Œå…ˆä»‹ç»æ•°æ®ä½ç½®ã€‚è¿™æ˜¯å› ä¸ºåœ¨ Solidity ä¸­ï¼Œå¼•ç”¨ç±»å‹æ˜¯ç”±ç®€å•æ•°æ®ç±»å‹ç»„åˆè€Œæˆï¼Œç›¸æ¯”äºç®€å•çš„å€¼ç±»å‹ï¼Œè¿™äº›ç±»å‹é€šå¸¸é€šè¿‡åç§°å¼•ç”¨ã€‚è¿™äº›ç±»å‹æ¶‰åŠåˆ°çš„æ•°æ®é‡è¾ƒå¤§ï¼Œå¤åˆ¶å®ƒä»¬å¯èƒ½è¦æ¶ˆè€—å¤§é‡ Gasï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨å¼•ç”¨æ•°æ®ç±»å‹æ—¶ï¼Œå¿…é¡»è€ƒè™‘å­˜å‚¨ä½ç½®ã€‚æˆ‘ä»¬éœ€è¦ä»”ç»†è€ƒè™‘æ•°æ®æ˜¯ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜æ˜¯åœ¨ EVM å­˜å‚¨åŒºä¸­ã€‚è¿™å°±æ˜¯çº¿ä»‹ç»æ•°æ®ä½ç½®çš„åŸå› ã€‚</p> <p>æ³¨æ„ï¼šæ‰€æœ‰çš„å¼•ç”¨ç±»å‹ï¼Œéƒ½æœ‰æ•°æ®ä½ç½®è¿™ä¸ªé¢å¤–çš„æ³¨è§£æ¥æŒ‡å®šå­˜å‚¨åœ¨å“ªé‡Œï¼Œæ‰€ä»¥ä¸€å®šè¦æŒæ¡å¥½ã€‚</p> <p>æ€»ç»“ï¼š<strong>å¦‚æœä½¿ç”¨å¼•ç”¨ç±»å‹ï¼Œåˆ™å¿…é¡»æ˜ç¡®æŒ‡æ˜æ•°æ®å­˜å‚¨å“ªç§ç±»å‹çš„ä½ç½®ï¼ˆç©ºé—´ï¼‰é‡Œ</strong>ï¼š</p> <h3 id="_1-æ•°æ®ä½ç½®çš„åŸºç¡€ä»‹ç»"><a href="#_1-æ•°æ®ä½ç½®çš„åŸºç¡€ä»‹ç»" class="header-anchor">#</a> 1.æ•°æ®ä½ç½®çš„åŸºç¡€ä»‹ç»</h3> <p>åœ¨åˆçº¦ä¸­å£°æ˜å’Œä½¿ç”¨çš„å˜é‡éƒ½æœ‰ä¸€ä¸ªæ•°æ®ä½ç½®ï¼Œåˆçº¦å˜é‡çš„æ•°æ®ä½ç½®å°†ä¼šå½±å“ Gas æ¶ˆè€—é‡ã€‚</p> <p>Solidity æä¾›çš„æœ‰ä¸‰ç§å¦‚ä¸‹æ•°æ®ä½ç½®ã€‚</p> <ul><li>å­˜å‚¨ storage : çŠ¶æ€å˜é‡ä¿å­˜çš„ä½ç½®ï¼Œåªè¦åˆçº¦å­˜åœ¨å°±ä¸€ç›´å­˜å‚¨ï¼</li> <li>å†…å­˜ memory : å³æ•°æ®åœ¨å†…å­˜ä¸­ï¼Œå› æ­¤æ•°æ®ä»…åœ¨å…¶ç”Ÿå‘½å‘¨æœŸå†…ï¼ˆå‡½æ•°è°ƒç”¨æœŸé—´ï¼‰æœ‰æ•ˆã€‚ä¸èƒ½ç”¨äºå¤–éƒ¨è°ƒç”¨ã€‚</li> <li>è°ƒç”¨æ•°æ® calldata : ç”¨æ¥ä¿å­˜å‡½æ•°å‚æ•°çš„ç‰¹æ®Šæ•°æ®ä½ç½®ï¼Œæ˜¯ä¸€ä¸ªåªè¯»ä½ç½®ã€‚
<ul><li>è°ƒç”¨æ•°æ® calldata æ˜¯ä¸å¯ä¿®æ”¹çš„ã€éæŒä¹…çš„å‡½æ•°å‚æ•°å­˜å‚¨åŒºåŸŸï¼Œæ•ˆæœå¤§å¤šç±»ä¼¼ å†…å­˜ memory ã€‚</li> <li>ä¸»è¦ç”¨äºå¤–éƒ¨å‡½æ•°çš„å‚æ•°ï¼Œä½†ä¹Ÿå¯ç”¨äºå…¶ä»–å˜é‡ï¼Œæ— è®ºå¤–éƒ¨å†…éƒ¨å‡½æ•°éƒ½å¯ä»¥ä½¿ç”¨ã€‚</li></ul></li></ul> <p>æ ¸å¿ƒï¼šæ›´æ”¹æ•°æ®ä½ç½®æˆ–ç±»å‹è½¬æ¢å°†å§‹ç»ˆäº§ç”Ÿè‡ªåŠ¨è¿›è¡Œä¸€ä»½æ‹·è´ï¼Œè€Œåœ¨åŒä¸€æ•°æ®ä½ç½®å†…ï¼ˆå¯¹äº å­˜å‚¨ storage æ¥è¯´ï¼‰çš„å¤åˆ¶ä»…åœ¨æŸäº›æƒ…å†µä¸‹è¿›è¡Œæ‹·è´ã€‚</p> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-15"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-15" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=28" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 6 èŠ‚æ•°æ®ä½ç½®: æ•°æ®ä½ç½®çš„åŸºç¡€ä»‹ç»</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=XnHfYzygmG8&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=28" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 6 èŠ‚æ•°æ®ä½ç½®: æ•°æ®ä½ç½®çš„åŸºç¡€ä»‹ç»</a></li></ul> <h4 id="â“µ-storage"><a href="#â“µ-storage" class="header-anchor">#</a> â“µ storage</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract DataLocation {
    // storage
    uint256 stateVariable = 1;
    uint256[] stateArray = [1, 2, 3];

    // uint storage stateVariable; // Expected identifier but got 'storage'
    // uint[] memory stateArray; // Expected identifier but got 'memory'
}
</code></pre></div><p>è¯¥å­˜å‚¨ä½ç½®å­˜å‚¨æ°¸ä¹…æ•°æ®ï¼Œè¿™æ„å‘³ç€è¯¥æ•°æ®å¯ä»¥è¢«åˆçº¦ä¸­çš„æ‰€æœ‰å‡½æ•°è®¿é—®ã€‚å¯ä»¥æŠŠå®ƒè§†ä¸ºè®¡ç®—æœºçš„ç¡¬ç›˜æ•°æ®ï¼Œæ‰€æœ‰æ•°æ®éƒ½æ°¸ä¹…å­˜å‚¨ã€‚ä¿å­˜åœ¨å­˜å‚¨åŒº(storage)ä¸­çš„å˜é‡ï¼Œä»¥æ™ºèƒ½åˆçº¦çš„çŠ¶æ€å­˜å‚¨ï¼Œå¹¶ä¸”åœ¨å‡½æ•°è°ƒç”¨ä¹‹é—´ä¿æŒæŒä¹…æ€§ã€‚ä¸å…¶ä»–æ•°æ®ä½ç½®ç›¸æ¯”ï¼Œå­˜å‚¨åŒºæ•°æ®ä½ç½®çš„æˆæœ¬è¾ƒé«˜ã€‚</p> <p>storage æ˜¯æ°¸ä¹…å­˜å‚¨åœ¨ä»¥å¤ªåŠåŒºå—é“¾ä¸­ï¼Œæ›´å…·ä½“åœ°è¯´å­˜å‚¨åœ¨å­˜å‚¨ Merkle Patricia æ ‘ä¸­ï¼Œ<strong>å½¢æˆå¸æˆ·çŠ¶æ€ä¿¡æ¯çš„ä¸€éƒ¨åˆ†</strong>ã€‚ä¸€æ—¦ä½¿ç”¨è¿™ä¸ªç±»å‹ï¼Œæ•°æ®å°†æ°¸è¿œå­˜åœ¨ã€‚ æ‰©å±•: <a href="https://zhuanlan.zhihu.com/p/39271872" target="_blank" rel="noopener noreferrer">é»˜å…‹å°”æ ‘ï¼ˆmerkle treeï¼‰<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>é‡ç‚¹:çŠ¶æ€å˜é‡æ€»æ˜¯å­˜å‚¨åœ¨å­˜å‚¨åŒº(storage)ä¸­,å¹¶ä¸”ä¸èƒ½æ˜¾å¼åœ°æ ‡è®°çŠ¶æ€å˜é‡çš„ä½ç½®ã€‚</strong>ã€‚çŠ¶æ€å˜é‡æ˜¯å¼ºåˆ¶ä¸º storageã€‚</p> <h4 id="â“¶-memory"><a href="#â“¶-memory" class="header-anchor">#</a> â“¶ memory</h4> <p>å†…å­˜ä½ç½®æ˜¯ä¸´æ—¶æ•°æ®ï¼Œæ¯”å­˜å‚¨ä½ç½®ä¾¿å®œã€‚å®ƒåªèƒ½åœ¨å‡½æ•°ä¸­è®¿é—®ã€‚é€šå¸¸ï¼Œå†…å­˜æ•°æ®ç”¨äºä¿å­˜ä¸´æ—¶å˜é‡ï¼Œä»¥ä¾¿åœ¨å‡½æ•°æ‰§è¡ŒæœŸé—´è¿›è¡Œè®¡ç®—ã€‚ä¸€æ—¦å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œå®ƒçš„å†…å®¹å°±ä¼šè¢«ä¸¢å¼ƒã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆæ¯ä¸ªå•ç‹¬å‡½æ•°çš„å†…å­˜(RAM)ã€‚</p> <p>memoryï¼š<strong>å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå³åˆ†é…ã€å³ä½¿ç”¨ï¼Œè¶Šè¿‡ä½œç”¨åŸŸåˆ™ä¸å¯è®¿é—®ï¼Œç­‰å¾…è¢«å›æ”¶</strong>ã€‚</p> <h5 id="é‡ç‚¹-1-å‡½æ•°å‚æ•°-åŒ…æ‹¬è¿”å›å‚æ•°-éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚"><a href="#é‡ç‚¹-1-å‡½æ•°å‚æ•°-åŒ…æ‹¬è¿”å›å‚æ•°-éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚" class="header-anchor">#</a> <strong>é‡ç‚¹ 1:å‡½æ•°å‚æ•°(åŒ…æ‹¬è¿”å›å‚æ•°)éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚</strong></h5> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract DataLocation {
    function add(uint256 num1, uint256 num2)
        public
        pure
        returns (uint256 result)
    {
        return num1 + num2;
    }
}
</code></pre></div><p>ä¸Šé¢ä¾‹å­ä¸­: å‡½æ•°å‚æ•° <code>uint num1</code> ä¸ <code>uint num2</code>ï¼Œè¿”å›å€¼ <code>uint result</code> éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚</p> <h5 id="é‡ç‚¹-2-å¼•ç”¨ç±»å‹çš„å±€éƒ¨å˜é‡-éœ€è¦æ˜¾å¼æŒ‡å®šæ•°æ®ä½ç½®-storage-memory"><a href="#é‡ç‚¹-2-å¼•ç”¨ç±»å‹çš„å±€éƒ¨å˜é‡-éœ€è¦æ˜¾å¼æŒ‡å®šæ•°æ®ä½ç½®-storage-memory" class="header-anchor">#</a> <strong>é‡ç‚¹ 2:å¼•ç”¨ç±»å‹çš„å±€éƒ¨å˜é‡ï¼Œéœ€è¦æ˜¾å¼æŒ‡å®šæ•°æ®ä½ç½®(storage/memory)</strong></h5> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Locations {
    struct Book {
        string title;
        string author;
        uint256 book_id;
    }
    Book public java; // ä¸€æœ¬ java ä¹¦
    mapping(address =&gt; uint256) public balances;

    function test() public {
        /* æ­¤å¤„éƒ½æ˜¯å±€éƒ¨å˜é‡  */
        // å€¼ç±»å‹:æ‰€ä»¥å®ƒä»¬è¢«å­˜å‚¨åœ¨å†…å­˜ä¸­
        bool flag = true;
        uint256 number = 1;
        address account = 0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926ac;
        bytes32 hash = keccak256(abi.encodePacked(bytes1(0xff)));

        // Data location can only be specified for array, struct or mapping types,
        // but &quot;memory&quot; was given.
        // bool memory flag2; // é”™è¯¯:å€¼ç±»å‹çš„æ•°æ®ä¸èƒ½æ ‡ç¤º memory

        // å¼•ç”¨ç±»å‹:éœ€è¦æ˜¾ç¤ºæŒ‡å®šæ•°æ®ä½ç½®ï¼Œæ­¤å¤„æŒ‡å®šä¸ºå†…å­˜
        uint256[] memory localArray; // array
        // uint8[] memory nums = [1, 2, 3]; // å†…å­˜ä¸­ä¸èƒ½åˆ›å»ºåŠ¨æ€æ•°ç»„
        uint8[3] memory numsFixed = [1, 2, 3];
        uint256[] memory a = new uint256[](5); // æ¨è
        a[1] = 1;
        a[2] = 2;
        a[3] = 3;
        a[4] = 4;

        string memory myStr = &quot;hello&quot;; // string

        // æ˜ å°„ä¸èƒ½åœ¨å‡½æ•°ä¸­åŠ¨æ€åˆ›å»ºï¼Œæ‚¨å¿…é¡»ä»çŠ¶æ€å˜é‡ä¸­åˆ†é…å®ƒä»¬ã€‚
        // mapping(address =&gt; bool) memory myMapping;
        mapping(address =&gt; uint256) storage ref = balances; // mapping
        java = Book({title: &quot;Solidity&quot;, author: &quot;Anbang&quot;, book_id: 1}); // struct
        bytes memory bc = bytes(&quot;!&quot;); //
    }
}
</code></pre></div><ul><li>mapping å’Œ struct ç±»å‹ï¼Œä¸èƒ½åœ¨å‡½æ•°ä¸­åŠ¨æ€åˆ›å»ºï¼Œå¿…é¡»ä»çŠ¶æ€å˜é‡ä¸­åˆ†é…å®ƒä»¬ã€‚</li> <li>å†…å­˜ä¸­ä¸èƒ½åˆ›å»ºåŠ¨æ€æ•°ç»„</li></ul> <h5 id="é‡ç‚¹-3-å‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºå‚æ•°å¦‚æœæ˜¯æ•°ç»„-ä½¿ç”¨-memory"><a href="#é‡ç‚¹-3-å‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºå‚æ•°å¦‚æœæ˜¯æ•°ç»„-ä½¿ç”¨-memory" class="header-anchor">#</a> <strong>é‡ç‚¹ 3:å‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºå‚æ•°å¦‚æœæ˜¯æ•°ç»„,ä½¿ç”¨ memory</strong></h5> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract DataLocations {
    // name_ æ˜¯ string ï¼Œæ‰€ä»¥ä½¿ç”¨ memory
    // mm_ æ˜¯ uint256[] ï¼Œæ‰€ä»¥ä½¿ç”¨ memory
    // è¾“å‡ºç›¸åŒï¼Œä¹Ÿæ˜¯ä½¿ç”¨ memory
    function examples2(string memory name_, uint256[] memory mm_)
        external
        pure
        returns (uint256[] memory memArr, string memory myName)
    {
        memArr = new uint256[](mm_.length);
        myName = name_;
        for (uint256 index = 0; index &lt; mm_.length; index++) {
            memArr[index] = mm_[index];
        }
    }
}
</code></pre></div><h5 id="é‡ç‚¹-4-å¼•ç”¨ç±»å‹çš„å±€éƒ¨å˜é‡-æŒ‡å®š-storage-å’Œ-memory-çš„åŒºåˆ«"><a href="#é‡ç‚¹-4-å¼•ç”¨ç±»å‹çš„å±€éƒ¨å˜é‡-æŒ‡å®š-storage-å’Œ-memory-çš„åŒºåˆ«" class="header-anchor">#</a> <strong>é‡ç‚¹ 4:å¼•ç”¨ç±»å‹çš„å±€éƒ¨å˜é‡:æŒ‡å®š storage å’Œ memory çš„åŒºåˆ«</strong></h5> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract DataLocations {
    struct MyStruct {
        string name;
        uint256 age;
    }
    mapping(address =&gt; MyStruct) public myStructs;

    function test1() external returns (MyStruct memory) {
        myStructs[msg.sender] = MyStruct({name: &quot;Anbang1&quot;, age: 18});

        // storage ä¼šä¿®æ”¹çŠ¶æ€å˜é‡
        MyStruct storage myStruct1 = myStructs[msg.sender];
        myStruct1.age++;
        return myStruct1;
    }

    function test2() external returns (MyStruct memory) {
        myStructs[msg.sender] = MyStruct({name: &quot;Anbang2&quot;, age: 18});

        // memory å‡½æ•°è¿è¡Œå®Œåå³æ¶ˆå¤±ï¼Œä¿®æ”¹çš„å€¼ä¹Ÿä¸ä¼šå‚¨å­˜åœ¨çŠ¶æ€å˜é‡ä¸­
        MyStruct memory myStruct2 = myStructs[msg.sender];
        myStruct2.age++;
        return myStruct2;
    }
}
</code></pre></div><ul><li><code>storage</code>ä¿®æ”¹å¼•ç”¨æ•°æ®: ä¼šä¿®æ”¹çŠ¶æ€å˜é‡</li> <li><code>memory</code>ä¿®æ”¹å¼•ç”¨æ•°æ®: å‡½æ•°è¿è¡Œå®Œåå³æ¶ˆå¤±ï¼Œä¿®æ”¹çš„å€¼ä¹Ÿä¸ä¼šå‚¨å­˜åœ¨çŠ¶æ€å˜é‡ä¸­</li></ul> <h4 id="â“·-calldata"><a href="#â“·-calldata" class="header-anchor">#</a> â“· calldata</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract DataLocations {
    function test(uint256[] calldata mm_)
        external
        pure
        returns (uint256[] calldata)
    {
        // mm_[0] = 1; // Calldata arrays are read-only.
        return mm_;
    }
}
</code></pre></div><p>calldata æ˜¯ä¸å¯ä¿®æ”¹çš„éæŒä¹…æ€§æ•°æ®ä½ç½®ï¼Œæ‰€æœ‰ä¼ é€’ç»™å‡½æ•°çš„å€¼ï¼Œéƒ½å­˜å‚¨åœ¨è¿™é‡Œã€‚æ­¤å¤–ï¼Œ<code>calldata</code> æ˜¯å¤–éƒ¨å‡½æ•°(external function)çš„å‚æ•°çš„é»˜è®¤ä½ç½®ã€‚å¤–éƒ¨å‡½æ•°(external function)çš„å‚æ•°å­˜å‚¨åœ¨ calldata ä¸­ã€‚å‡½æ•°çš„è¿”å›å€¼ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ calldata æ•°æ®ä½ç½®çš„æ•°ç»„å’Œç»“æ„ï¼Œä½†æ˜¯æ— æ³•ç»™å…¶åˆ†é…ç©ºé—´ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract DataLocations {
    // å‚æ•° [1,2,3]      æ¶ˆè€— 25586 gas
    // å‚æ•° [1,2,3,4,5,6,7,8,9,0] æ¶ˆè€— 32114 gas
    function iMemory(uint256[] memory _mm)
        external
        pure
        returns (uint256[] memory memArr)
    {
        memArr = new uint256[](_mm.length);
        for (uint256 index = 0; index &lt; _mm.length; index++) {
            memArr[index] = _mm[index];
        }
    }

    // å‚æ•° [1,2,3]      æ¶ˆè€— 24551 gas
    // å‚æ•° [1,2,3,4,5,6,7,8,9,0] æ¶ˆè€— 29510 gas
    function iCalldata(uint256[] calldata _mm)
        external
        pure
        returns (uint256[] memory memArr)
    {
        memArr = new uint256[](_mm.length);
        for (uint256 index = 0; index &lt; _mm.length; index++) {
            memArr[index] = _mm[index];
        }
    }
}
</code></pre></div><ul><li><strong>è¦ç‚¹: calldata åªèƒ½ç”¨åœ¨å‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºå‚æ•°ä¸­</strong></li> <li><strong>è¦ç‚¹: calldata ç”¨åœ¨è¾“å…¥å‚æ•°ä¸­ï¼Œæ¯” memorg æ›´çœ gas</strong></li> <li><strong>è¦ç‚¹: calldata çš„å‚æ•°ä¸å…è®¸ä¿®æ”¹ï¼Œä½†æ˜¯ memorg å‚æ•°å…è®¸ä¿®æ”¹</strong></li></ul> <p>å­˜å‚¨å‡½æ•°å‚æ•°ï¼Œå®ƒæ˜¯åªè¯»çš„ï¼Œä¸ä¼šæ°¸ä¹…å­˜å‚¨çš„ä¸€ä¸ªæ•°æ®ä½ç½®ã€‚å¤–éƒ¨å‡½æ•°(external function)çš„å‚æ•°è¢«å¼ºåˆ¶æŒ‡å®šä¸º calldataï¼Œæ•ˆæœä¸ memory ç±»ä¼¼ã€‚</p> <blockquote><p>æ³¨è§£: å¦‚æœå¯ä»¥çš„è¯ï¼Œè¯·å°½é‡ä½¿ç”¨ calldata ä½œä¸ºæ•°æ®ä½ç½®ï¼Œå› ä¸ºå®ƒå°†é¿å…å¤åˆ¶ï¼Œå¹¶ç¡®ä¿ä¸èƒ½ä¿®æ”¹æ•°æ®ã€‚</p></blockquote> <blockquote><p>æ³¨è§£: åœ¨ 0.6.9 ç‰ˆæœ¬ä¹‹å‰ï¼Œå¼•ç”¨ç±»å‹å‚æ•°çš„æ•°æ®ä½ç½®æœ‰é™åˆ¶ï¼Œä¸»è¦è¡¨ç°åœ¨å‡½æ•°çš„å¯è§æ€§ä¸Šï¼›å¤–éƒ¨å‡½æ•°ä¸­ä½¿ç”¨ calldata ï¼Œå…¬å…±å‡½æ•°ä¸­ä½¿ç”¨ memory ï¼Œä»¥åŠå†…éƒ¨å’Œç§æœ‰å‡½æ•°ä¸­çš„ memory æˆ– storage ã€‚ ç°åœ¨ memory å’Œ calldata åœ¨æ‰€æœ‰å‡½æ•°ä¸­éƒ½è¢«å…è®¸ä½¿ç”¨ï¼Œæ— è®ºå…¶å¯è§æ€§å¦‚ä½•ã€‚</p></blockquote> <h4 id="â“¸-stack"><a href="#â“¸-stack" class="header-anchor">#</a> â“¸ stack</h4> <p>å †æ ˆæ˜¯ç”± EVM (Ethereum è™šæ‹Ÿæœº)ç»´æŠ¤çš„éæŒä¹…æ€§æ•°æ®ã€‚EVM ä½¿ç”¨å †æ ˆæ•°æ®ä½ç½®åœ¨æ‰§è¡ŒæœŸé—´åŠ è½½å˜é‡ã€‚å †æ ˆä½ç½®æœ€å¤šæœ‰ 1024 ä¸ªçº§åˆ«çš„é™åˆ¶ã€‚</p> <h4 id="â“¹-å°ç»“"><a href="#â“¹-å°ç»“" class="header-anchor">#</a> â“¹ å°ç»“</h4> <p>æŒ‰ç…§å…³é”®å­—:</p> <ul><li>storage: å­˜å‚¨åŒº: çŠ¶æ€å˜é‡æ€»æ˜¯å‚¨å­˜åœ¨<strong>å­˜å‚¨åŒº</strong>ä¸Š</li> <li>memory: å†…å­˜åŒº: å±€éƒ¨å˜é‡ä½¿ç”¨ï¼Œåªåœ¨å†…å­˜ä¸­ç”Ÿæ•ˆã€‚
<ul><li>å€¼ç±»å‹çš„å±€éƒ¨å˜é‡ï¼Œå­˜å‚¨åœ¨<strong>å†…å­˜</strong>ä¸­ã€‚</li> <li><strong>å¼•ç”¨ç±»å‹å±€éƒ¨å˜é‡ï¼Œéœ€è¦æ˜¾å¼åœ°æŒ‡å®šæ•°æ®ä½ç½®</strong>ã€‚</li> <li>å‡½æ•°çš„è¾“å…¥å‚æ•°å¦‚æœæ˜¯æ•°ç»„æˆ–è€… stringï¼Œå¿…é¡»æ˜¯ <code>memory</code> æˆ– <code>calldata</code></li> <li>å†…å­˜ä¸­çš„æ•°ç»„å¿…é¡»æ˜¯å®šé•¿æ•°ç»„ï¼ˆä¸èƒ½ä½¿ç”¨ push èµ‹å€¼ï¼‰ï¼ŒåŠ¨æ€æ•°ç»„åªèƒ½å‚¨å­˜åœ¨çŠ¶æ€å˜é‡ä¸­ã€‚</li></ul></li> <li>calldata
<ul><li>å’Œ memory ç±»ä¼¼ï¼Œä½†æ˜¯ calldata åªèƒ½ç”¨åœ¨å‡½æ•°çš„è¾“å…¥å‚æ•°ä¸­ã€‚</li> <li>ç›¸æ¯”ä½¿ç”¨ memory ,åˆçº¦è¾“å…¥å‚æ•°å¦‚æœä½¿ç”¨ calldata, å¯ä»¥èŠ‚çº¦ gas</li></ul></li></ul> <p>æŒ‰ç…§å‡½æ•°å‚æ•°:</p> <ul><li>å†…éƒ¨å‡½æ•°å‚æ•°: (åŒ…æ‹¬è¿”å›å‚æ•°)éƒ½å­˜å‚¨åœ¨**memoryï¼ˆå†…å­˜ï¼‰**ä¸­ã€‚</li> <li>å¤–éƒ¨å‡½æ•°å‚æ•°: (ä¸åŒ…æ‹¬è¿”å›å‚æ•°)å­˜å‚¨åœ¨ <code>calldata</code> ä¸­ã€‚</li></ul> <h3 id="_2-ä¸åŒæ•°æ®ä½ç½®ä¹‹é—´çš„èµ‹å€¼è§„åˆ™"><a href="#_2-ä¸åŒæ•°æ®ä½ç½®ä¹‹é—´çš„èµ‹å€¼è§„åˆ™" class="header-anchor">#</a> 2.ä¸åŒæ•°æ®ä½ç½®ä¹‹é—´çš„èµ‹å€¼è§„åˆ™</h3> <p>æœ¬å°èŠ‚æ€»ç»“å¦‚ä¸‹:</p> <ol><li>å°† <strong style="color:blue;">å­˜å‚¨å˜é‡</strong> èµ‹å€¼ç»™ <strong>å­˜å‚¨å˜é‡</strong> (åŒç±»å‹)
<ul><li><code>å€¼ ç±» å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li> <li><code>å¼•ç”¨ç±»å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li></ul></li> <li>å°† <strong style="color:red;">å†…å­˜å˜é‡</strong> èµ‹å€¼ç»™ <strong>å­˜å‚¨å˜é‡</strong> <ul><li><code>å€¼ ç±» å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li> <li><code>å¼•ç”¨ç±»å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li></ul></li> <li>å°† <strong style="color:blue;">å­˜å‚¨å˜é‡</strong> èµ‹å€¼ç»™ å†…å­˜å˜é‡
<ul><li><code>å€¼ ç±» å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li> <li><code>å¼•ç”¨ç±»å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li></ul></li> <li>å°† <strong style="color:red;">å†…å­˜å˜é‡</strong> èµ‹å€¼ç»™ å†…å­˜å˜é‡ (åŒç±»å‹)
<ul><li><code>å€¼ ç±» å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li> <li><code>å¼•ç”¨ç±»å‹</code>: ä¸ä¼šåˆ›å»ºå‰¯æœ¬ã€‚(<strong>é‡è¦</strong>)</li></ul></li></ol> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-16"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-16" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=29" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 6 èŠ‚æ•°æ®ä½ç½®: ä¸åŒæ•°æ®ä½ç½®ä¹‹é—´çš„èµ‹å€¼è§„åˆ™</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=gR6s2aBbftg&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=29" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 6 èŠ‚æ•°æ®ä½ç½®: ä¸åŒæ•°æ®ä½ç½®ä¹‹é—´çš„èµ‹å€¼è§„åˆ™</a></li></ul> <h4 id="â“µ-å°†å­˜å‚¨å˜é‡èµ‹å€¼ç»™å­˜å‚¨å˜é‡"><a href="#â“µ-å°†å­˜å‚¨å˜é‡èµ‹å€¼ç»™å­˜å‚¨å˜é‡" class="header-anchor">#</a> â“µ å°†<strong style="color:blue;">å­˜å‚¨å˜é‡</strong>èµ‹å€¼ç»™å­˜å‚¨å˜é‡</h4> <p>å°†ä¸€ä¸ªçŠ¶æ€(å­˜å‚¨)å˜é‡èµ‹å€¼ç»™å¦ä¸€ä¸ªçŠ¶æ€(å­˜å‚¨)å˜é‡ï¼Œå°†åˆ›å»ºä¸€ä¸ªæ–°çš„å‰¯æœ¬ã€‚</p> <ul><li><code>å€¼ ç±» å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li> <li><code>å¼•ç”¨ç±»å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Locations {
    // å€¼ç±»å‹
    uint256 public stateA1 = 10;
    uint256 public stateA2 = 20;
    // å¼•ç”¨ç±»å‹
    string public stateB1 = &quot;ABCD&quot;;
    string public stateB2 = &quot;1234&quot;;

    function testA() public returns (uint256) {
        stateA1 = stateA2;
        stateA2 = 30;
        return stateA1; // returns 20
    }

    function testB() public returns (string memory) {
        stateB1 = stateB2;
        bytes(stateB2)[0] = bytes1(&quot;9&quot;);
        return stateB1; // returns 1234
    }
}
</code></pre></div><p><strong>é—®ç­”é¢˜: ä¸Šé¢å‡½æ•° <code>testA</code> å’Œ <code>testB</code> çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p> <ul><li><code>testA</code>: ç¬¬ä¸€æ¬¡æ‰§è¡Œè¿”å›å€¼æ˜¯ <code>20</code>ï¼Œä¹‹åæ‰§è¡Œè¿”å›å€¼æ˜¯ <code>30</code></li> <li><code>testB</code>: ç¬¬ä¸€æ¬¡æ‰§è¡Œè¿”å›å€¼æ˜¯å­—ç¬¦ä¸² <code>&quot;1234&quot;</code>ï¼Œä¹‹åæ‰§è¡Œè¿”å›å€¼æ˜¯å­—ç¬¦ä¸² <code>&quot;9234&quot;</code></li></ul> <p><strong>å€¼ç±»å‹</strong>: å…ˆå°† stateA2 èµ‹å€¼ç»™ stateA1,å†æŠŠ stateA2 ä¿®æ”¹ï¼›ç»“æœå¾—åˆ°çš„ stateA1 æ˜¯ stateA2 ä¿®æ”¹å‰çš„å€¼ï¼Œè¯´æ˜å¯¹äºå€¼ç±»å‹çš„å±€éƒ¨å˜é‡æ¥è¯´ =&gt; åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</p> <p><strong>å¼•ç”¨ç±»å‹</strong>: å…ˆå°† stateB2 èµ‹å€¼ç»™ stateB1,å†æŠŠ stateB2 ä¿®æ”¹ï¼›ç»“æœå¾—åˆ°çš„ stateB1 æ˜¯ stateB2 ä¿®æ”¹å‰çš„å€¼ï¼Œè¯´æ˜å¯¹äºå¼•ç”¨ç±»å‹çš„å±€éƒ¨å˜é‡æ¥è¯´ =&gt; åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</p> <h4 id="â“¶-å°†å†…å­˜å˜é‡èµ‹å€¼ç»™å­˜å‚¨å˜é‡"><a href="#â“¶-å°†å†…å­˜å˜é‡èµ‹å€¼ç»™å­˜å‚¨å˜é‡" class="header-anchor">#</a> â“¶ å°†<strong style="color:red;">å†…å­˜å˜é‡</strong>èµ‹å€¼ç»™å­˜å‚¨å˜é‡</h4> <p>å°†å†…å­˜å˜é‡èµ‹å€¼ç»™å­˜å‚¨å˜é‡ï¼Œæ€»ä¼šåˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</p> <ul><li><code>å€¼ ç±» å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li> <li><code>å¼•ç”¨ç±»å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Locations {
    uint256 public stateA1 = 10; //storage
    string public stateB1 = &quot;ABCD&quot;;

    function testA() public returns (uint256) {
        uint256 memoryA2 = 20; // memory
        stateA1 = memoryA2;
        memoryA2 = 40;
        return stateA1; // returns 20
    }

    function testB() public returns (string memory) {
        string memory memoryB2 = &quot;1234&quot;; // memory
        stateB1 = memoryB2;
        bytes(memoryB2)[0] = bytes1(&quot;9&quot;);
        return stateB1; // returns 1234
    }
}
</code></pre></div><p><strong>é—®ç­”é¢˜: ä¸Šé¢å‡½æ•° <code>testA</code> å’Œ <code>testB</code> çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p> <ul><li><code>testA</code>: æ°¸è¿œè¿”å› <code>20</code></li> <li><code>testB</code>: æ°¸è¿œè¿”å›å­—ç¬¦ä¸² <code>&quot;1234&quot;</code></li></ul> <p><strong>å€¼ç±»å‹</strong>: å…ˆå°† memoryA2 èµ‹å€¼ç»™ stateA1,å†æŠŠ memoryA2 ä¿®æ”¹ï¼›ç»“æœå¾—åˆ°çš„ stateA1 æ˜¯ memoryA2 ä¿®æ”¹å‰çš„å€¼ï¼Œè¯´æ˜å¯¹äºå€¼ç±»å‹çš„å±€éƒ¨å˜é‡æ¥è¯´ =&gt; åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</p> <p><strong>å¼•ç”¨ç±»å‹</strong>: å…ˆå°† memoryB2 èµ‹å€¼ç»™ stateB1,å†æŠŠ memoryB2 ä¿®æ”¹ï¼›ç»“æœå¾—åˆ°çš„ stateB1 æ˜¯ memoryB2 ä¿®æ”¹å‰çš„å€¼ï¼Œè¯´æ˜å¯¹äºå¼•ç”¨ç±»å‹çš„å±€éƒ¨å˜é‡æ¥è¯´ =&gt; åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</p> <h4 id="â“·-å°†å­˜å‚¨å˜é‡èµ‹å€¼ç»™å†…å­˜å˜é‡"><a href="#â“·-å°†å­˜å‚¨å˜é‡èµ‹å€¼ç»™å†…å­˜å˜é‡" class="header-anchor">#</a> â“· å°†<strong style="color:blue;">å­˜å‚¨å˜é‡</strong>èµ‹å€¼ç»™å†…å­˜å˜é‡</h4> <p>ä»å­˜å‚¨å˜é‡å¤åˆ¶åˆ°å†…å­˜å˜é‡ï¼Œå°†åˆ›å»ºä¸€ä¸ªå‰¯æœ¬ã€‚</p> <ul><li><code>å€¼ ç±» å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li> <li><code>å¼•ç”¨ç±»å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Locations {
    uint256 public stateA1 = 10; //storage
    string public stateB1 = &quot;ABCD&quot;;

    function testA() public returns (uint256) {
        uint256 memoryA2 = 20; // memory
        memoryA2 = stateA1;
        stateA1 = 40;
        return memoryA2; // returns ç¬¬ä¸€æ¬¡æ˜¯ 10, ä»¥åéƒ½æ˜¯40
    }

    function testB() public returns (string memory) {
        string memory memoryB2 = &quot;1234&quot;; // memory
        memoryB2 = stateB1;
        bytes(stateB1)[0] = bytes1(&quot;9&quot;);
        return memoryB2; // returns ç¬¬ä¸€æ¬¡æ˜¯ &quot;ABCD&quot;, ä»¥åéƒ½æ˜¯ &quot;9BCD&quot;
    }
}
</code></pre></div><p><strong>é—®ç­”é¢˜: ä¸Šé¢å‡½æ•° testA å’Œ testB çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p> <ul><li><code>testA</code>: ç¬¬ä¸€æ¬¡æ‰§è¡Œè¿”å›å€¼æ˜¯ 10ï¼Œä¹‹åæ‰§è¡Œè¿”å›å€¼æ˜¯ 40</li> <li><code>testB</code>: ç¬¬ä¸€æ¬¡æ‰§è¡Œè¿”å›å€¼æ˜¯å­—ç¬¦ä¸² <code>&quot;ABCD&quot;</code>ï¼Œä¹‹åæ‰§è¡Œè¿”å›å€¼æ˜¯å­—ç¬¦ä¸² <code>&quot;9BCD&quot;</code></li></ul> <p><strong>å€¼ç±»å‹</strong>: å…ˆå°† stateA1 èµ‹å€¼ç»™ memoryA2,å†æŠŠ stateA1 ä¿®æ”¹ï¼›ç»“æœå¾—åˆ°çš„ memoryA2 æ˜¯ stateA1 ä¿®æ”¹å‰çš„å€¼ï¼Œè¯´æ˜å¯¹äºå€¼ç±»å‹çš„å±€éƒ¨å˜é‡æ¥è¯´ =&gt; åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</p> <p><strong>å¼•ç”¨ç±»å‹</strong>: å…ˆå°† stateB1 èµ‹å€¼ç»™ memoryB2,å†æŠŠ stateB1 ä¿®æ”¹ï¼›ç»“æœå¾—åˆ°çš„ memoryB2 æ˜¯ stateB1 ä¿®æ”¹å‰çš„å€¼ï¼Œè¯´æ˜å¯¹äºå¼•ç”¨ç±»å‹çš„å±€éƒ¨å˜é‡æ¥è¯´ =&gt; åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</p> <h4 id="â“¸-å°†å†…å­˜å˜é‡èµ‹å€¼ç»™å†…å­˜å˜é‡"><a href="#â“¸-å°†å†…å­˜å˜é‡èµ‹å€¼ç»™å†…å­˜å˜é‡" class="header-anchor">#</a> â“¸ å°†<strong style="color:red;">å†…å­˜å˜é‡</strong>èµ‹å€¼ç»™å†…å­˜å˜é‡</h4> <ul><li>å¯¹äºå€¼ç±»å‹çš„å±€éƒ¨å˜é‡: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li> <li>å¯¹äºå¼•ç”¨ç±»å‹å±€éƒ¨å˜é‡: <strong>ä¸ä¼šåˆ›å»ºå‰¯æœ¬</strong>ã€‚(é‡è¦)</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Locations {
    function testA() public pure returns (uint256) {
        uint256 memoryA1 = 10; // memory
        uint256 memoryA2 = 20; // memory
        memoryA1 = memoryA2;
        memoryA2 = 40;
        return memoryA1; // returns æ°¸è¿œæ˜¯ 20
    }

    function testB() public pure returns (string memory) {
        string memory memoryB1 = &quot;ABCD&quot;; // memory
        string memory memoryB2 = &quot;1234&quot;; // memory
        memoryB1 = memoryB2;
        bytes(memoryB2)[0] = bytes1(&quot;9&quot;);
        return memoryB1; // returns æ°¸è¿œæ˜¯ &quot;9234&quot;
    }
}
</code></pre></div><p><strong>é—®ç­”é¢˜: ä¸Šé¢å‡½æ•° testA å’Œ testB çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p> <ul><li><code>testA</code>: æ°¸è¿œæ˜¯ <code>20</code></li> <li><code>testB</code>: æ°¸è¿œæ˜¯å­—ç¬¦ä¸² <code>&quot;9234&quot;</code></li></ul> <p><strong>å€¼ç±»å‹</strong>: å…ˆå°† memoryA2 èµ‹å€¼ç»™ memoryA1,å†æŠŠ memoryA2 ä¿®æ”¹ï¼›ç»“æœå¾—åˆ°çš„ memoryA1 æ˜¯ memoryA2 ä¿®æ”¹å‰çš„å€¼ï¼Œè¯´æ˜å¯¹äºå€¼ç±»å‹çš„å±€éƒ¨å˜é‡æ¥è¯´ï¼Œæ­¤æ—¶ä»ç„¶åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</p> <p><strong>å¼•ç”¨ç±»å‹</strong>: å…ˆå°† memoryB2 èµ‹å€¼ç»™ memoryB1,å†æŠŠ memoryB2 ä¿®æ”¹ï¼›ç»“æœå¾—åˆ°çš„ memoryB1 æ˜¯ memoryB2 ä¿®æ”¹åçš„å€¼ã€‚è¯´æ˜å®ƒä»¬éƒ½æŒ‡å‘ç›¸åŒçš„å­˜å‚¨ä½ç½®ï¼Œå¹¶ä¸ä¼šåˆ›å»ºæ–°å‰¯æœ¬ã€‚</p> <p>âš ï¸ é‡ç‚¹ï¼š<strong>å¯¹äºå¼•ç”¨ç±»å‹çš„å±€éƒ¨å˜é‡ï¼Œä»ä¸€ä¸ªå†…å­˜å˜é‡å¤åˆ¶åˆ°å¦ä¸€ä¸ªå†…å­˜å˜é‡ä¸ä¼šåˆ›å»ºå‰¯æœ¬ï¼Œå…±äº«å†…å­˜</strong>ã€‚</p> <h4 id="â“¹-å°ç»“-2"><a href="#â“¹-å°ç»“-2" class="header-anchor">#</a> â“¹ å°ç»“</h4> <p>æ•°æ®ä½ç½®ä¸ä»…ä»…è¡¨ç¤ºæ•°æ®å¦‚ä½•ä¿å­˜ï¼Œå®ƒåŒæ ·å½±å“ç€èµ‹å€¼è¡Œä¸ºï¼š</p> <ul><li>åœ¨ storage å’Œ memory ä¹‹é—´ä¸¤ä¸¤èµ‹å€¼ï¼ˆæˆ–è€…ä» calldata èµ‹å€¼ ï¼‰ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä»½ç‹¬ç«‹çš„æ‹·è´ã€‚</li> <li>ä» memory åˆ° memory çš„èµ‹å€¼åªåˆ›å»ºå¼•ç”¨ï¼Œè¿™æ„å‘³ç€æ›´æ”¹å†…å­˜å˜é‡ï¼Œå…¶ä»–å¼•ç”¨ç›¸åŒæ•°æ®çš„æ‰€æœ‰å…¶ä»–å†…å­˜å˜é‡çš„å€¼ä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚</li> <li>ä» storage åˆ°æœ¬åœ°å­˜å‚¨å˜é‡çš„èµ‹å€¼ä¹Ÿåªåˆ†é…ä¸€ä¸ªå¼•ç”¨ã€‚</li> <li>å…¶ä»–çš„å‘ storage çš„èµ‹å€¼ï¼Œæ€»æ˜¯è¿›è¡Œæ‹·è´ã€‚ è¿™ç§æƒ…å†µçš„ç¤ºä¾‹ï¼Œå¦‚å¯¹çŠ¶æ€å˜é‡æˆ– storage çš„ç»“æ„ä½“ç±»å‹çš„å±€éƒ¨å˜é‡æˆå‘˜çš„èµ‹å€¼ï¼Œå³ä½¿å±€éƒ¨å˜é‡æœ¬èº«æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œä¹Ÿä¼šè¿›è¡Œä¸€ä»½æ‹·è´ã€‚</li></ul> <h3 id="_3-æ·±åˆ»ç†è§£å¼•ç”¨ç±»å‹èµ‹å€¼å’Œä¿®æ”¹"><a href="#_3-æ·±åˆ»ç†è§£å¼•ç”¨ç±»å‹èµ‹å€¼å’Œä¿®æ”¹" class="header-anchor">#</a> 3.æ·±åˆ»ç†è§£å¼•ç”¨ç±»å‹èµ‹å€¼å’Œä¿®æ”¹</h3> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-17"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-17" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=30" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 6 èŠ‚æ•°æ®ä½ç½®: æ·±åˆ»ç†è§£å¼•ç”¨ç±»å‹èµ‹å€¼å’Œä¿®æ”¹</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=HB-03x5PfX4&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=30" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 6 èŠ‚æ•°æ®ä½ç½®: æ·±åˆ»ç†è§£å¼•ç”¨ç±»å‹èµ‹å€¼å’Œä¿®æ”¹</a></li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Locations {
    string public stateB1 = &quot;ABCD&quot;;
    struct MyStruct {
        string name;
        uint256 age;
    }
    mapping(address =&gt; MyStruct) public stateC1;

    constructor() {
        stateC1[msg.sender] = MyStruct({name: &quot;Anbang&quot;, age: 1});
    }

    function testB1() public returns (string memory, string memory) {
        string memory memoryB2 = &quot;1234&quot;; // memory
        stateB1 = memoryB2;

        // storage ä¿®æ”¹:ä¼šæ”¹å˜çŠ¶æ€å˜é‡
        string storage stateB3 = stateB1;
        bytes(stateB3)[0] = bytes1(&quot;9&quot;);
        return (stateB1, stateB3);
        // returns (9234,9234)
        // å‚¨å­˜ç©ºé—´ä¸­ stateB1 = 9234
    }

    function testB2() public returns (string memory, string memory) {
        string memory memoryB2 = &quot;1234&quot;; // memory
        stateB1 = memoryB2;

        // memory ä¿®æ”¹:ä¸ä¼šæ”¹å˜çŠ¶æ€å˜é‡
        string memory memoryB3 = stateB1;
        bytes(memoryB3)[0] = bytes1(&quot;9&quot;);
        return (stateB1, memoryB3);
        // returns (1234,9234)
        // å‚¨å­˜ç©ºé—´ä¸­ stateB1 = 1234
    }

    function testC1() external returns (MyStruct memory, MyStruct memory) {
        MyStruct memory memoryC2 = MyStruct({name: &quot;Anbang1&quot;, age: 18});
        stateC1[msg.sender] = memoryC2;

        // storage ä¿®æ”¹:ä¼šæ”¹å˜çŠ¶æ€å˜é‡
        MyStruct storage stateC3 = stateC1[msg.sender];
        stateC3.age++;
        return (stateC1[msg.sender], stateC3);
        // returns ({name: &quot;Anbang1&quot;, age: 19},{name: &quot;Anbang1&quot;, age: 19})
        // å‚¨å­˜ç©ºé—´ä¸­ stateC1 = {name: &quot;Anbang1&quot;, age: 19}
    }

    function testC2() external returns (MyStruct memory, MyStruct memory) {
        MyStruct memory memoryC2 = MyStruct({name: &quot;Anbang2&quot;, age: 18});
        stateC1[msg.sender] = memoryC2;

        // memory ä¿®æ”¹:ä¸ä¼šæ”¹å˜çŠ¶æ€å˜é‡
        MyStruct memory memoryC3 = stateC1[msg.sender];
        memoryC3.age++;
        return (stateC1[msg.sender], memoryC3);
        // returns ({name: &quot;Anbang2&quot;, age: 18},{name: &quot;Anbang2&quot;, age: 19})
        // å‚¨å­˜ç©ºé—´ä¸­ stateC1 = {name: &quot;Anbang2&quot;, age: 18}
    }
}
</code></pre></div><p>é—®ç­”é¢˜ï¼š</p> <ul><li>testB1 è¿è¡Œåï¼Œè¿”å›ä»€ä¹ˆï¼Ÿ
<ul><li><code>(9234,9234)</code></li></ul></li> <li>testB2 è¿è¡Œåï¼Œè¿”å›ä»€ä¹ˆï¼Ÿ
<ul><li><code>(1234,9234)</code></li></ul></li> <li>testC1 è¿è¡Œåï¼Œè¿”å›ä»€ä¹ˆï¼Ÿ
<ul><li><code>({name: &quot;Anbang1&quot;, age: 19},{name: &quot;Anbang1&quot;, age: 19})</code></li></ul></li> <li>testC2 è¿è¡Œåï¼Œè¿”å›ä»€ä¹ˆï¼Ÿ
<ul><li><code>({name: &quot;Anbang2&quot;, age: 18},{name: &quot;Anbang2&quot;, age: 19})</code></li></ul></li></ul> <h3 id="_4-calldata-å’Œ-memeory-åŒºåˆ«"><a href="#_4-calldata-å’Œ-memeory-åŒºåˆ«" class="header-anchor">#</a> 4.calldata å’Œ memeory åŒºåˆ«</h3> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-18"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-18" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=31" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 6 èŠ‚æ•°æ®ä½ç½®: calldata å’Œ memeory åŒºåˆ«</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=dyUlxfSJOvE&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=31" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 6 èŠ‚æ•°æ®ä½ç½®: calldata å’Œ memeory åŒºåˆ«</a></li></ul> <p><strong>å‡½æ•°è°ƒç”¨å‡½æ•°æ—¶çš„åŒºåˆ«</strong>:</p> <h4 id="â“µ-calldataå¯ä»¥éšå¼è½¬æ¢ä¸ºmemory"><a href="#â“µ-calldataå¯ä»¥éšå¼è½¬æ¢ä¸ºmemory" class="header-anchor">#</a> â“µ <code>calldataå¯ä»¥éšå¼è½¬æ¢ä¸ºmemory</code></h4> <ul><li>calldata å‚æ•°å¯ä»¥éšå¼è½¬æ¢ä¸º memory</li> <li>memory å‚æ•°ä¸å¯ä»¥éšå¼è½¬æ¢ä¸º calldata</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract DataLocations {
    function memoryFn(uint256[] memory _mm)
        private
        pure
        returns (uint256[] memory memArr)
    {
        memArr = new uint256[](_mm.length);
        for (uint256 index = 0; index &lt; _mm.length; index++) {
            memArr[index] = _mm[index];
        }
    }

    function calldataFn(uint256[] calldata _mm)
        private
        pure
        returns (uint256[] memory memArr)
    {
        memArr = new uint256[](_mm.length);
        for (uint256 index = 0; index &lt; _mm.length; index++) {
            memArr[index] = _mm[index];
        }
    }


    function examples1(uint256[] memory _mm)
        external
        pure
        returns (uint256[] memory memArr)
    {
        // memoryFn å‚æ•°æ˜¯ memoryï¼Œå¯ä»¥è°ƒç”¨
        // calldataFn å‚æ•°æ˜¯ calldata ï¼Œä¸å¯ä»¥è°ƒç”¨ï¼Œ memory ä¸å¯ä»¥éšå¼è½¬æ¢ä¸º calldata
        // memory å‚æ•°ï¼Œè°ƒç”¨éœ€è¦ memory å‚æ•°çš„å‡½æ•°: æˆåŠŸ
        memArr = memoryFn(_mm);

        // memory ä¸èƒ½éšå¼è½¬æ¢ä¸º calldata
        // memArr = calldataFn(_mm); // memory å‚æ•°ï¼Œè°ƒç”¨éœ€è¦ calldata å‚æ•°çš„å‡½æ•°: ç¦æ­¢
    }

    function examples2(uint256[] calldata _mm)
        external
        pure
        returns (uint256[] memory memArr)
    {
        // calldata å‚æ•°ï¼Œè°ƒç”¨éœ€è¦ calldata å‚æ•°çš„å‡½æ•°: æˆåŠŸ
        memArr = calldataFn(_mm);

        // memoryFn å‚æ•°æ˜¯ memoryï¼Œå¯ä»¥è°ƒç”¨ï¼Œcalldataå¯ä»¥éšå¼è½¬æ¢ä¸º memory
        // calldataFn å‚æ•°æ˜¯ calldata ï¼Œç›´æ¥ä½¿ç”¨calldataæ›´çœgas
        // calldataï¼ˆå°:çº¦æŸå¤šï¼‰ å¯ä»¥éšå¼çš„è½¬æ¢ memoryï¼ˆå¤§ï¼‰
        // calldata å‚æ•°ï¼Œè°ƒç”¨éœ€è¦ memory å‚æ•°çš„å‡½æ•°: æˆåŠŸ
        // memArr = memoryFn(_mm);
    }

}
</code></pre></div><h4 id="â“¶-calldata-å’Œ-memeory-å¯¹æ¯”"><a href="#â“¶-calldata-å’Œ-memeory-å¯¹æ¯”" class="header-anchor">#</a> â“¶ calldata å’Œ memeory å¯¹æ¯”</h4> <div class="language- extra-class"><pre class="language-text"><code>contract Test {
    function memoryFn(uint256[] memory _num)
        public
        pure
        returns (uint256[] memory)
    {
        _num[0] = 999; // ä¿®æ”¹å‚æ•°
        return (_num);
    }

    function calldataFn(uint256[] calldata _num)
        public
        pure
        returns (uint256[] calldata)
    {
        // _num[0] = 999; // ç¦æ­¢ä¿®æ”¹ calldata æ•°æ®
        return (_num);
    }
}
</code></pre></div><h2 id="_7ï¸âƒ£-å¼•ç”¨ç±»å‹"><a href="#_7ï¸âƒ£-å¼•ç”¨ç±»å‹" class="header-anchor">#</a> 7ï¸âƒ£ å¼•ç”¨ç±»å‹</h2> <p>Solidity ä¸­ï¼Œæœ‰ä¸€äº›æ•°æ®ç±»å‹ç”±å€¼ç±»å‹ç»„åˆè€Œæˆï¼Œç›¸æ¯”äºç®€å•çš„å€¼ç±»å‹ï¼Œè¿™äº›ç±»å‹é€šå¸¸é€šè¿‡åç§°å¼•ç”¨ï¼Œè¢«ç§°ä¸ºå¼•ç”¨ç±»å‹ã€‚</p> <ul><li>array
<ul><li>åŸºæœ¬ç±»å‹ç»„æˆçš„æ•°ç»„é›†åˆã€‚</li></ul> <div class="language- extra-class"><pre class="language-text"><code>uint256[5] public T1 = [1, 2, 3, 4, 5];
address[5] public A = [0xff...6ac];
byte[5] public A = [0xff...6ac];
</code></pre></div><ul><li>å­—ç¬¦ä¸²ä¸ bytes æ˜¯ç‰¹æ®Šçš„æ•°ç»„ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯å¼•ç”¨ç±»å‹</li></ul></li> <li>string: æ˜¯ä¸€ä¸ªåŠ¨æ€å°ºå¯¸çš„ utf-8 ç¼–ç å­—ç¬¦ä¸²
<ul><li>ä»–å…¶å®æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¯å˜å­—èŠ‚æ•°ç»„ï¼ŒåŒæ—¶å…¶ä¹Ÿæ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹</li></ul></li> <li>bytes: åŠ¨æ€åå…­è¿›åˆ¶å­—èŠ‚æ•°ç»„
<ul><li>bytes ç±»ä¼¼äº <code>byte[]</code>ï¼Œä½†å®ƒåœ¨ calldata ä¸­è¢«ç´§å¯†åœ°æ‰“åŒ…ã€‚å› æ­¤ï¼Œç›¸æ¯”äº <code>byte[]</code>ï¼Œbytes åº”è¯¥ä¼˜å…ˆä½¿ç”¨ï¼Œå› ä¸ºæ›´ä¾¿å®œã€‚</li> <li>string ç­‰ä»·äº bytesï¼Œä½†ä¸å…è®¸é•¿åº¦æˆ–ç´¢å¼•è®¿é—®ã€‚</li></ul></li> <li>mapping</li> <li>structï¼šä¸ºäº†å…è®¸ evm çš„ä¼˜åŒ–ï¼Œè¯·ç¡®ä¿ storage ä¸­çš„å˜é‡å’Œ <code>struct</code> æˆå‘˜çš„ä¹¦å†™é¡ºåºå…è®¸å®ƒä»¬è¢«ç´§å¯†åœ°æ‰“åŒ…ã€‚ä¾‹å¦‚ï¼Œåº”è¯¥æŒ‰ç…§ <code>uint128ï¼Œuint128ï¼Œuint256</code> çš„é¡ºåºæ¥å£°æ˜çŠ¶æ€å˜é‡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ <code>uint128ï¼Œuint256ï¼Œuint128</code>ï¼Œå› ä¸ºå‰è€…åªå ç”¨ä¸¤ä¸ªå­˜å‚¨æ’æ§½ï¼Œè€Œåè€…å°†å ç”¨ä¸‰ä¸ªã€‚</li></ul> <h3 id="_1-array-æ•°ç»„"><a href="#_1-array-æ•°ç»„" class="header-anchor">#</a> 1.array æ•°ç»„</h3> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-19"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-19" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=32" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 7 èŠ‚å¼•ç”¨ç±»å‹: array æ•°ç»„</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=rKSExH-ZclU&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=32" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 7 èŠ‚å¼•ç”¨ç±»å‹: array æ•°ç»„</a></li></ul> <p>æ•°ç»„æ˜¯å­˜å‚¨<strong>åŒç±»å…ƒç´ çš„æœ‰åºé›†åˆ</strong>ã€‚æ•°ç»„å£°æ˜æ—¶å¯ä»¥æ˜¯å›ºå®šå¤§å°çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯åŠ¨æ€è°ƒæ•´é•¿åº¦ã€‚</p> <p>ä¸‹é¢æ˜¯ array çš„æ€»ç»“:</p> <ul><li>å£°æ˜å’Œåˆå§‹åŒ–æ•°ç»„
<ul><li>æ•°ç»„å…ƒç´ å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼ŒåŒ…æ‹¬æ˜ å°„æˆ–ç»“æ„ä½“ã€‚å¯¹ç±»å‹çš„é™åˆ¶æ˜¯æ˜ å°„åªèƒ½å­˜å‚¨åœ¨ å­˜å‚¨ storage ä¸­ï¼Œå¹¶ä¸”å…¬å¼€è®¿é—®å‡½æ•°çš„å‚æ•°éœ€è¦æ˜¯ ABI ç±»å‹ã€‚</li></ul></li> <li>è®¿é—®å’Œä¿®æ”¹æ•°ç»„å…ƒç´ 
<ul><li><code>arr[_index]</code>:
<ul><li>é€šè¿‡ç´¢å¼•è¿›è¡Œè·å–ç‰¹å®šå…ƒç´ </li> <li>å¯ä»¥é€šè¿‡ç´¢å¼•ä¿®æ”¹å€¼</li></ul></li> <li>çŠ¶æ€å˜é‡æ ‡è®° <code>public</code> çš„æ•°ç»„ï¼ŒSolidity åˆ›å»ºä¸€ä¸ª <code>getterå‡½æ•°</code> ã€‚ ä¸‹æ ‡çš„ç´¢å¼•æ•°å­—å°±æ˜¯ <code>getterå‡½æ•°</code> çš„å‚æ•°ã€‚</li> <li>è®¿é—®è¶…å‡ºæ•°ç»„é•¿åº¦çš„å…ƒç´ ä¼šå¯¼è‡´å¼‚å¸¸ï¼ˆassert ç±»å‹å¼‚å¸¸ ï¼‰ã€‚ å¯ä»¥ä½¿ç”¨ .push() æ–¹æ³•åœ¨æœ«å°¾è¿½åŠ ä¸€ä¸ªæ–°å…ƒç´ ï¼Œå…¶ä¸­ .push() è¿½åŠ ä¸€ä¸ªé›¶åˆå§‹åŒ–çš„å…ƒç´ å¹¶è¿”å›å¯¹å®ƒçš„å¼•ç”¨ã€‚</li></ul></li> <li>å‡½æ•°ä¸­è¿”å›æ•°ç»„
<ul><li>å¦‚æœæƒ³æŠŠæ•°ç»„å…¨éƒ¨è¿”å›ï¼Œéœ€è¦é€šè¿‡å‡½æ•°è¿›è¡Œæ“ä½œã€‚åœ¨å‡½æ•°ä¸­è¿”å›æ•°ç»„</li></ul></li> <li>åŠ¨æ€æ•°ç»„å’Œå®šé•¿æ•°ç»„
<ul><li>åŠ¨æ€æ•°ç»„åªèƒ½å­˜åœ¨äºçŠ¶æ€å˜é‡ä¸­</li> <li>å†…å­˜ä¸­åªèƒ½åˆ›å»ºå®šé•¿æ•°ç»„</li></ul></li> <li>åˆ›å»ºå†…å­˜æ•°ç»„
<ul><li>å¯¹äº storage æ•°ç»„ï¼Œå…ƒç´ å¯ä»¥æ˜¯ä»»æ„ç±»å‹(å…¶ä»–æ•°ç»„ã€æ˜ å°„æˆ–ç»“æ„)ã€‚</li> <li>å¯¹äº memory æ•°ç»„ï¼Œå…ƒç´ ç±»å‹ä¸èƒ½æ˜¯æ˜ å°„ç±»å‹ï¼Œå¦‚æœå®ƒæ˜¯ä¸€ä¸ª public å‡½æ•°çš„å‚æ•°ï¼Œé‚£ä¹ˆå…ƒç´ ç±»å‹å¿…é¡»æ˜¯ ABI ç±»å‹ã€‚</li></ul></li> <li>æ•°ç»„çš„å±æ€§
<ul><li><code>length</code>: è·å–æ•°ç»„çš„é•¿åº¦</li></ul></li> <li>æ•°ç»„çš„æ–¹æ³•
<ul><li>push : åªæœ‰åŠ¨æ€æ•°ç»„å¯ä»¥ä½¿ç”¨ï¼Œåªèƒ½ç”¨åœ¨åŠ¨æ€æ•°ç»„ä¸Š</li> <li>pop: åˆ é™¤æœ€åä¸€ä¸ªé•¿åº¦ï¼Œåªèƒ½ç”¨åœ¨åŠ¨æ€æ•°ç»„ä¸Š</li> <li>delete: æ¸…ç©ºå¯¹åº”çš„ç´¢å¼•ï¼›æ¸…ç©ºä¸æ˜¯åˆ é™¤ï¼Œå¹¶ä¸ä¼šæ”¹å˜é•¿åº¦ï¼Œç´¢å¼•ä½ç½®çš„å€¼ä¼šæ”¹ä¸ºé»˜è®¤å€¼ã€‚</li> <li>æ•°ç»„åˆ‡ç‰‡: <code>x[start:end]</code></li></ul></li> <li>å†™ä¸€ä¸ªå®Œå…¨åˆ é™¤çš„ delete æ–¹æ³•</li></ul> <h4 id="â“µ-æ•°ç»„çš„åˆ›å»º"><a href="#â“µ-æ•°ç»„çš„åˆ›å»º" class="header-anchor">#</a> â“µ æ•°ç»„çš„åˆ›å»º</h4> <p>æ•°ç»„é•¿åº¦ä¸Šåˆ†ä¸º <strong>å›ºå®šé•¿åº¦æ•°ç»„</strong> å’Œ <strong>å¯å˜é•¿åº¦æ•°ç»„</strong>ï¼Œç±»å‹ä¸Šåˆ†ä¸º<strong>ä¸€ç»´æ•°ç»„</strong>å’Œ<strong>å¤šç»´æ•°ç»„</strong>ï¼›</p> <p>ä¸€ä¸ªå…ƒç´ ç±»å‹ä¸º <code>T</code>ï¼Œå›ºå®šé•¿åº¦ä¸º <code>k</code> çš„æ•°ç»„å¯ä»¥å£°æ˜ä¸º <code>T[k]</code>ï¼Œè€ŒåŠ¨æ€æ•°ç»„å£°æ˜ä¸º <code>T[]</code>ã€‚</p> <ul><li>å›ºå®šé•¿åº¦æ•°ç»„:åˆ›å»º</li> <li>å¯å˜é•¿åº¦æ•°ç»„:åˆ›å»º</li> <li>äºŒç»´æ•°ç»„:åˆ›å»º</li> <li>å…¶å®ƒ
<ul><li><code>uint256[2][] public T = new uint256[2][](10);</code></li></ul></li></ul> <h5 id="_1-å›ºå®šé•¿åº¦æ•°ç»„-åˆ›å»º"><a href="#_1-å›ºå®šé•¿åº¦æ•°ç»„-åˆ›å»º" class="header-anchor">#</a> 1.<strong>å›ºå®šé•¿åº¦æ•°ç»„:åˆ›å»º</strong></h5> <p>å›ºå®šé•¿åº¦æ•°ç»„:åˆ›å»º</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    // å›ºå®šé•¿åº¦æ•°ç»„
    uint256[5] public T = [1, 2, 3, 4, 5];
    address[5] public A =   [0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926ac];
    uint256[10] public arr1 = [0, 1, 2]; // èµ‹å€¼çš„æ•°ç»„é•¿åº¦ä¸è¶…è¿‡10éƒ½å¯ä»¥
    uint256[10] public arr2 = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];

    // å¦‚æœåˆå§‹åŒ–è¶…å‡ºäº†æ•°ç»„çš„é¢„æœŸé•¿åº¦ï¼ŒæŠ¥é”™:
    // Type uint8[11] memory is not implicitly convertible to expected
    // type uint256[10] storage ref.
    // uint256[10] public arr3 = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
}
</code></pre></div><ul><li>è¯­æ³•: <code>type[arraySize] arrayName;</code>ï¼Œè¿™æ˜¯ä¸€ç»´æ•°ç»„ï¼Œå…¶ä¸­ arraySize å¿…é¡»æ˜¯ä¸€ä¸ªå¤§äºé›¶çš„æ•´æ•°æ•°å­—ï¼Œtype å¯ä»¥æ˜¯ä»»ä½•æ•°æ®ç±»å‹ã€‚</li> <li>å›ºå®šé•¿åº¦æ•°ç»„åˆ›å»ºåä¸å¯å¯¹é•¿åº¦è¿›è¡Œä¿®æ”¹,ä½†æ˜¯å¯ä»¥å¯¹å†…å®¹è¿›è¡Œä¿®æ”¹
<ul><li>ï¼ˆä¸å¯å¯¹é•¿åº¦è¿›è¡Œä¿®æ”¹æ˜¯ä¸ä¸å¯å˜å­—èŠ‚æ•°ç»„ä¹‹é—´ä¸åŒç‚¹ï¼‰</li></ul></li></ul> <p><strong>æ•°ç»„å…ˆå£°æ˜å†èµ‹å€¼</strong></p> <p>é€šè¿‡ç´¢å¼•è¿›è¡Œèµ‹å€¼ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    uint256[10] public arr1;

    function test() external {
        arr1[0] = 1;
        arr1[1] = 10;
        arr1[2] = 100;
        arr1[9] = 900;
    }
}
</code></pre></div><h5 id="_2-å¯å˜é•¿åº¦æ•°ç»„-åˆ›å»º"><a href="#_2-å¯å˜é•¿åº¦æ•°ç»„-åˆ›å»º" class="header-anchor">#</a> 2.<strong>å¯å˜é•¿åº¦æ•°ç»„:åˆ›å»º</strong></h5> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    // å¯å˜é•¿åº¦æ•°ç»„
    uint256[] public T1 = [1, 2, 3, 4, 5]; // æ–¹å¼ 1
    uint256[] public T2 = new uint256[](5); // æ–¹å¼ 2
}
</code></pre></div><ul><li>æ–¹å¼ 1: <code>uint256[] T1 = [1, 2, 3, 4, 5];</code> <ul><li>è¯¥æ–¹å¼ä¸å¯ä»¥åœ¨å‡½æ•°å†…åˆ›å»º</li></ul></li> <li>æ–¹å¼ 2: <code>uint256[] T2 = new uint256[](5);</code> <ul><li>ç”¨æ–¹å¼ 2 åˆ›å»ºæ•°ç»„æ—¶ï¼Œè‹¥æ•°ç»„ä¸ºæˆå‘˜å˜é‡, åˆ™é»˜è®¤ä¸º storage ç±»å‹ï¼›</li> <li>è‹¥ä¸ºå±€éƒ¨å˜é‡é»˜è®¤ä¸º <code>memory</code> ç±»å‹ï¼Œ<code>memory</code> ç±»å‹çš„æ•°ç»„ï¼Œå¿…é¡»å£°æ˜é•¿åº¦ï¼Œå¹¶ä¸”é•¿åº¦åˆ›å»ºåä¸å¯å˜ã€‚</li> <li><code>push</code> æ–¹æ³•ä¸èƒ½ç”¨åœ¨ <code>memeory</code> çš„æ•°ç»„ä¸Š,åªèƒ½é€ä¸ªç´¢å¼•çš„èµ‹å€¼ã€‚</li></ul></li></ul> <h5 id="_3-å†…å­˜ä¸­åˆ›å»ºæ•°ç»„"><a href="#_3-å†…å­˜ä¸­åˆ›å»ºæ•°ç»„" class="header-anchor">#</a> 3.å†…å­˜ä¸­åˆ›å»ºæ•°ç»„</h5> <p>ä¸èƒ½ç›´æ¥åˆ›å»ºï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    uint256[] public x = [uint256(1), 3, 4];

    // ä¸‹é¢è¿™æ®µä»£ç å¹¶ä¸èƒ½ç¼–è¯‘ã€‚
    function f() public {
        uint256[] memory x = [uint256(1), 3, 4];
    }
}
</code></pre></div><p>å¯ä»¥ä½¿ç”¨ <code>new</code> å…³é”®å­—åœ¨å†…å­˜ä¸­åˆ›å»ºåŠ¨æ€æ•°ç»„ã€‚åˆ›å»ºæ ¼å¼: <code>uint256[] memory x = new uint256[](3);</code></p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract C {
    function f() public pure {
        uint256[] memory x = new uint256[](3);
    }
}
</code></pre></div><ul><li>å†…å­˜ä¸­åˆ›å»ºçš„æ•°ç»„æ˜¯å±€éƒ¨å˜é‡ã€‚</li> <li>å†…å­˜ä¸­ä¸èƒ½åˆ›å»ºåŠ¨æ€æ•°ç»„ï¼Œå¿…é¡»åˆ›å»ºå®šé•¿æ•°ç»„ã€‚
<ul><li>æ€è€ƒ: æ’å…¥æ’åºçš„ä¾‹å­ä¸­ï¼Œä¼˜åŒ–åçš„ä»£ç æ˜¯åŠ¨æ€æ•°ç»„ï¼Œè¿˜æ˜¯å®šé•¿æ•°ç»„ï¼Ÿ(æ’å…¥æ’åºåœ¨åé¢ç®—æ³•é‚£ä¸€ç« )</li></ul></li></ul> <p>memory ç±»å‹çš„æ•°ç»„é•¿åº¦åˆ›å»ºåä¸å¯å˜ï¼Œä¸èƒ½é€šè¿‡ä¿®æ”¹æˆå‘˜å˜é‡ <code>.push</code> æ”¹å˜ memory æ•°ç»„çš„å¤§å°ã€‚å¿…é¡»æå‰è®¡ç®—æ•°ç»„å¤§å°ï¼Œæˆ–è€…åˆ›å»ºä¸€ä¸ªæ–°çš„å†…å­˜æ•°ç»„å¹¶å¤åˆ¶æ¯ä¸ªå…ƒç´ ã€‚</p> <p>ä¾‹å­ 0 : æ˜¾ç¤ºç»™å„ä¸ªå…ƒç´ èµ‹å€¼:</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract C {
    function f() public pure {
        uint256[] memory x = new uint256[](3);
        x[0] = 1;
        x[1] = 3;
        x[2] = 4;
    }
}
</code></pre></div><p>ä¾‹å­ 1: æ–°åˆ†é…çš„æ•°ç»„å…ƒç´ æ€»æ˜¯ä»¥ é»˜è®¤å€¼ åˆå§‹åŒ–ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract FunctionOutputs {
    function examples1() external pure returns (uint256[] memory) {
        uint256[] memory a = new uint256[](5);
        a[1] = 1;
        a[2] = 2;
        a[3] = 3;
        a[4] = 4;
        return a;
    }

    // åœ¨ Solidity ä¸­çš„æ‰€æœ‰å˜é‡ï¼Œæ–°åˆ†é…çš„æ•°ç»„å…ƒç´ æ€»æ˜¯ä»¥ é»˜è®¤å€¼ åˆå§‹åŒ–ã€‚
    function examples2(uint256 _len)
        external
        pure
        returns (uint256[] memory b)
    {
        require(_len &gt; 1, &quot;length &gt; 1&quot;);
        b = new uint256[](_len);
        b[0] = 666;
    }

    function examples3(uint256 _len) external pure returns (bytes memory b) {
        require(_len &gt; 1, &quot;length &gt; 1&quot;);
        b = new bytes(_len);
        b[0] = bytes1(&quot;A&quot;);
    }
}
</code></pre></div><h5 id="_4-åŠ¨æ€æ•°ç»„å’Œå®šé•¿æ•°ç»„çš„-gas-åŒºåˆ«"><a href="#_4-åŠ¨æ€æ•°ç»„å’Œå®šé•¿æ•°ç»„çš„-gas-åŒºåˆ«" class="header-anchor">#</a> 4.åŠ¨æ€æ•°ç»„å’Œå®šé•¿æ•°ç»„çš„ gas åŒºåˆ«</h5> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract FunctionOutputs {
    // 26086 gas
    uint256[] public nums = [1, 2, 3];

    // 23913 gas
    uint256[3] public numsFixed = [1, 2, 3];
}
</code></pre></div><p>åœ¨ Remix ä¸­éƒ¨ç½²åï¼Œå¦‚æœè·å– numsï¼Œéœ€è¦ä¼ å…¥ç´¢å¼•è·å– nums çš„å¯¹åº” inedx å€¼ã€‚å…¶ä¸­åŠ¨æ€æ•°ç»„ nums æŸ¥çœ‹éœ€è¦ 26086 gasï¼Œå®šé•¿æ•°ç»„ numsFixed æŸ¥çœ‹ä»…éœ€ 23913 gasã€‚<strong>å¦‚æœèƒ½ä½¿ç”¨å®šé•¿æ•°ç»„ï¼Œå°±ä½¿ç”¨å®šé•¿æ•°ç»„ï¼Œå› ä¸ºå®ƒå¾ˆä¾¿å®œã€‚</strong></p> <h5 id="_5-äºŒç»´æ•°ç»„-åˆ›å»º"><a href="#_5-äºŒç»´æ•°ç»„-åˆ›å»º" class="header-anchor">#</a> 5.<strong>äºŒç»´æ•°ç»„:åˆ›å»º</strong>:</h5> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    // length:3
    uint256[2][3] public T = [[1, 2], [3, 4], [5, 6]];

    function getLength() external view returns (uint256) {
        return T.length;
    }
}
</code></pre></div><ul><li>ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªé•¿åº¦ä¸º <code>5</code>ï¼Œå…ƒç´ ç±»å‹ä¸º uint çš„åŠ¨æ€æ•°ç»„çš„æ•°ç»„ï¼ˆäºŒç»´æ•°ç»„ï¼‰ï¼Œåº”å£°æ˜ä¸º <code>uint[][5]</code> ï¼ˆæ³¨æ„è¿™é‡Œè·Ÿå…¶å®ƒè¯­è¨€æ¯”ï¼Œæ•°ç»„é•¿åº¦çš„å£°æ˜ä½ç½®æ˜¯åçš„ï¼‰ã€‚åœ¨ Solidity ä¸­ï¼Œ <code>X[3]</code> æ€»æ˜¯ä¸€ä¸ªåŒ…å«ä¸‰ä¸ª X ç±»å‹å…ƒç´ çš„æ•°ç»„ï¼Œå³ä½¿ X æœ¬èº«å°±æ˜¯ä¸€ä¸ªæ•°ç»„.</li> <li><code>uint256[2][3] public T = [[1, 2], [3, 4], [5, 6]];</code></li> <li><code>T.length</code> ä¸º 3</li></ul> <h4 id="â“¶-è®¿é—®å’Œä¿®æ”¹æ•°ç»„å…ƒç´ "><a href="#â“¶-è®¿é—®å’Œä¿®æ”¹æ•°ç»„å…ƒç´ " class="header-anchor">#</a> â“¶ è®¿é—®å’Œä¿®æ”¹æ•°ç»„å…ƒç´ </h4> <ul><li>é€šè¿‡ç´¢å¼•è®¿é—®æ•°ç»„å…ƒç´ </li> <li>é€šè¿‡ç´¢å¼•ä¿®æ”¹æ•°ç»„å…ƒç´ </li></ul> <p>æ³¨æ„: <code>arr[index]</code> ä¸­çš„ index éœ€è¦å°äº <code>arr.length</code>ï¼›</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    uint256[10] public arr1 = [0, 1, 2]; // èµ‹å€¼çš„æ•°ç»„é•¿åº¦ä¸è¶…è¿‡10éƒ½å¯ä»¥
    uint256[10] public arr2 = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];

    function test() external view returns (uint256, uint256) {
        return (arr1[2], arr2[5]);
    }

    function modi() external {
        arr1[2] = 666;
        arr2[5] = 666;
    }
}
</code></pre></div><p>è¿™ç§å¯ä»¥æŸ¥çœ‹åˆ°å…ƒç´ çš„æŒ‡å®šå…ƒç´ ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½æƒ³è¦æŸ¥çœ‹å…ƒç´ çš„æ‰€æœ‰å†…å®¹ã€‚è¿™æ—¶å€™å°±éœ€è¦å‡½æ•°å¤„ç†ä¸€ä¸‹ã€‚</p> <h4 id="â“·-å‡½æ•°ä¸­è¿”å›æ•´ä¸ªæ•°ç»„"><a href="#â“·-å‡½æ•°ä¸­è¿”å›æ•´ä¸ªæ•°ç»„" class="header-anchor">#</a> â“· å‡½æ•°ä¸­è¿”å›æ•´ä¸ªæ•°ç»„</h4> <p>é€šè¿‡å‡½æ•°æŠŠæ•°ç»„çš„æ‰€æœ‰å†…å®¹å…¨éƒ¨è¿”å›ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract FunctionOutputs {
    uint256[] public nums1 = [1, 2, 3];
    uint256[3] public nums2 = [1, 2, 3];

    function test1() external view returns (uint256[] memory) {
        return nums1;
    }

    function test2() external view returns (uint256[3] memory) {
        return nums2;
    }
}
</code></pre></div><h4 id="â“¸-æ•°ç»„å¸¸é‡"><a href="#â“¸-æ•°ç»„å¸¸é‡" class="header-anchor">#</a> â“¸ æ•°ç»„å¸¸é‡</h4> <p>æ­£å¸¸çœ‹åˆ°ä¸‹æ–¹ä»£ç åº”è¯¥æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯æ³¨æ„:å‡½æ•° s ä¸­æ•°ç»„ç±»å‹æ˜¯<code>uint256</code>ï¼Œè€Œå‡½æ•° t ä¸­è¾“å…¥çš„æ•°ç»„ç±»å‹æ˜¯<code>uint8</code>, è¿™é‡Œéœ€è¦å°† uint8 è½¬æ¢ä¸€ä¸‹<code>s([uint256(1), uint256(2)]);</code>;</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract T {
    function s(uint256[2] memory _arr) public {}

    function t() public {
        // Invalid type for argument in function call.
        // Invalid implicit conversion from uint8[2] memory to uint256[2] memory requested.
        // s([1, 2]); // é»˜è®¤è¿™ä¹ˆå†™ä¸è¡Œçš„ âŒ
        s([uint256(1), uint256(2)]); // âœ…
    }
}
</code></pre></div><p>æ•°ç»„å¸¸é‡ï¼ˆå­—é¢é‡ï¼‰æ˜¯åœ¨æ–¹æ‹¬å·ä¸­ï¼ˆ <code>[...]</code> ï¼‰ åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªé€—å·åˆ†éš”çš„è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ <code>[1, a, f(3)]</code> ã€‚</p> <p>æ•°ç»„å¸¸é‡çš„ç±»å‹é€šè¿‡ä»¥ä¸‹çš„æ–¹å¼ç¡®å®š:</p> <ul><li>å®ƒæ€»æ˜¯ä¸€ä¸ªé™æ€å¤§å°çš„å†…å­˜æ•°ç»„ï¼Œå…¶é•¿åº¦ä¸ºè¡¨è¾¾å¼çš„æ•°é‡ã€‚</li> <li>æ•°ç»„çš„åŸºæœ¬ç±»å‹æ˜¯åˆ—è¡¨ä¸Šçš„ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼çš„ç±»å‹ï¼Œä»¥ä¾¿æ‰€æœ‰å…¶ä»–è¡¨è¾¾å¼å¯ä»¥éšå¼åœ°è½¬æ¢ä¸ºå®ƒã€‚å¦‚æœä¸å¯ä»¥è½¬æ¢ï¼Œå°†å‡ºç°ç±»å‹é”™è¯¯ã€‚</li> <li>æ‰€æœ‰å…ƒç´ éƒ½éƒ½å¯ä»¥è½¬æ¢ä¸ºåŸºæœ¬ç±»å‹ä¹Ÿæ˜¯ä¸å¤Ÿçš„ã€‚å…¶ä¸­ä¸€ä¸ªå…ƒç´ å¿…é¡»æ˜¯æ˜ç¡®ç±»å‹çš„ã€‚</li></ul> <p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ<code>[1, 2, 3]</code> çš„ç±»å‹æ˜¯ <code>uint8[3] memory</code>ã€‚ å› ä¸ºæ¯ä¸ªå¸¸é‡çš„ç±»å‹éƒ½æ˜¯ <code>uint8</code> ï¼Œå¦‚æœä½ å¸Œæœ›ç»“æœæ˜¯ <code>uint256[3] memory</code> ç±»å‹ï¼Œä½ éœ€è¦å°†ç¬¬ä¸€ä¸ªå…ƒç´ è½¬æ¢ä¸º <code>uint256</code> ã€‚è™½ç„¶æ‰€æœ‰å…ƒç´ éƒ½éƒ½å¯ä»¥è½¬æ¢ä¸º<code>uint256</code>ï¼Œä½†æ˜¯é»˜è®¤æ˜¯è½¬æ¢ä¸º<code>uint8</code>ï¼Œèƒ½è½¬æˆå°çš„ç±»å‹ï¼Œå°±ä¸ä¼šè½¬æˆå¤§çš„ï¼Œè¿™æ˜¯æ•°ç»„å¸¸é‡çš„<strong>æ‡’æƒ°æ€§</strong>ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract LBC {
    function f() public pure returns (uint256[3] memory) {
        return g([uint256(1), 2, 3]);
    }

    function g(uint256[3] memory _arr)
        internal
        pure
        returns (uint256[3] memory)
    {
        return _arr;
    }
}
</code></pre></div><p>å¦‚ä¸‹æ˜¯ä¸€ä¸ªæ¯”è¾ƒç»å…¸çš„ä¾‹å­</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract T {
    int8[2] public a = [1, -1];
    // int8[2] public a = [int8(1), -1];
}
</code></pre></div><p>æ•°ç»„å¸¸é‡ <code>[1, -1]</code> æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªè¡¨è¾¾å¼ç±»å‹æ˜¯ <code>uint8</code> è€Œç¬¬äºŒä¸ªç±»ä¼¼æ˜¯ <code>int8</code> ä»–ä»¬ä¸å¯ä»¥éšå¼çš„ç›¸äº’è½¬æ¢ã€‚ ä¸ºäº†ç¡®ä¿å¯ä»¥è¿è¡Œï¼Œä½ æ˜¯å¯ä»¥ä½¿ç”¨ä¾‹å¦‚ï¼š <code>[int8(1), -1]</code> ã€‚</p> <p>ç”±äºä¸åŒç±»å‹çš„å›ºå®šå¤§å°çš„å†…å­˜æ•°ç»„ä¸èƒ½ç›¸äº’è½¬æ¢(å°½ç®¡åŸºç¡€ç±»å‹å¯ä»¥)ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨äºŒç»´æ•°ç»„å¸¸é‡ï¼Œä½ å¿…é¡»æ˜¾å¼åœ°æŒ‡å®šä¸€ä¸ªåŸºç¡€ç±»å‹:</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    function f() public pure returns (uint24[2][4] memory) {
        // ä¸‹é¢ä»£ç æ— æ³•å·¥ä½œï¼Œå› ä¸ºæ²¡æœ‰åŒ¹é…å†…éƒ¨ç±»å‹
        // uint[2][4] memory x = [[0x1, 1], [0xffffff, 2], [0xff, 3], [0xffff, 4]];

        uint24[2][4] memory x = [
            [uint24(0x1), 1],
            [0xffffff, 2],
            [uint24(0xff), 3],
            [uint24(0xffff), 4]
        ];

        return x;
    }
}
</code></pre></div><h4 id="â“¹-æ•°ç»„çš„å±æ€§"><a href="#â“¹-æ•°ç»„çš„å±æ€§" class="header-anchor">#</a> â“¹ æ•°ç»„çš„å±æ€§</h4> <h5 id="length"><a href="#length" class="header-anchor">#</a> length</h5> <p>æ•°ç»„æœ‰ <code>length</code> å±æ€§è¡¨ç¤ºå½“å‰æ•°ç»„çš„é•¿åº¦ã€‚ ä¸€ç»åˆ›å»ºï¼Œå†…å­˜ memory æ•°ç»„çš„å¤§å°å°±æ˜¯å›ºå®šçš„ï¼ˆä½†å´æ˜¯åŠ¨æ€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¯ä»¥æ ¹æ®è¿è¡Œæ—¶çš„å‚æ•°åˆ›å»ºï¼‰ã€‚</p> <p>ä¾‹å­ 1: <strong>é€šè¿‡ <code>arr.length</code> è·å–æ•°ç»„çš„é•¿åº¦</strong></p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    uint256[10] public arr1 = [0, 1, 2];
    uint256[10] public arr2 = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];

    function test1() external view returns (uint256) {
        return arr1.length;
    }

    function test2() external view returns (uint256) {
        return arr2.length;
    }
}
</code></pre></div><p>ä¾‹å­ 2: <strong>å¯ä»¥é€šè¿‡ length å±æ€§æ¥åˆ¤æ–­é•¿åº¦ã€‚</strong></p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract TX {
    function f(uint len) public pure {
        uint[] memory a = new uint[](7);
        bytes memory b = new bytes(len);

        assert(a.length == 7);
        assert(b.length == len);
    }
}
</code></pre></div><p>ä¾‹å­ 3:<strong>ä¸èƒ½é€šè¿‡è®¾ç½® <code>arr.length</code> æ¥è°ƒæ•´åŠ¨æ€æ•°ç»„çš„é•¿åº¦ã€‚</strong></p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    uint256[10] public arr1 = [0, 1, 2];
    // Member &quot;length&quot; is read-only and cannot be used to resize arrays.
    function test1() external {
        arr1.length = 8;
    }
}
</code></pre></div><h4 id="â“º-æ•°ç»„çš„æ–¹æ³•"><a href="#â“º-æ•°ç»„çš„æ–¹æ³•" class="header-anchor">#</a> â“º æ•°ç»„çš„æ–¹æ³•</h4> <ul><li>push : åªæœ‰åŠ¨æ€æ•°ç»„å¯ä»¥ä½¿ç”¨ï¼ŒåŠ¨æ€çš„ storage æ•°ç»„ä»¥åŠ <code>bytes</code> ç±»å‹å¯ä»¥ç”¨ï¼Œ<code>string</code> ç±»å‹ä¸å¯ä»¥
<ul><li><code>push()</code>: å®ƒç”¨æ¥æ·»åŠ æ–°çš„é›¶åˆå§‹åŒ–å…ƒç´ åˆ°æ•°ç»„æœ«å°¾ï¼Œå¹¶è¿”å›å…ƒç´ å¼•ç”¨.å› æ­¤å¯ä»¥è¿™æ ·ï¼š<code>x.push().t = 2</code> æˆ– <code>x.push() = b</code>.</li> <li><code>push(x)</code>: ç”¨æ¥åœ¨æ•°ç»„æœ«å°¾æ·»åŠ ä¸€ä¸ªç»™å®šçš„å…ƒç´ ï¼Œè¿™ä¸ªå‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼</li></ul></li> <li><code>pop</code>: åˆ é™¤æœ€åä¸€ä¸ªé•¿åº¦
<ul><li>å®ƒç”¨æ¥ä»æ•°ç»„æœ«å°¾åˆ é™¤å…ƒç´ ã€‚ åŒæ ·çš„ä¼šåœ¨ç§»é™¤çš„å…ƒç´ ä¸Šéšå«è°ƒç”¨ delete ã€‚</li></ul></li> <li><code>delete</code>: åˆ é™¤å¯¹åº”çš„ç´¢å¼•ï¼›åˆ é™¤å¹¶ä¸ä¼šæ”¹å˜é•¿åº¦ï¼Œç´¢å¼•ä½ç½®çš„å€¼ä¼šæ”¹ä¸ºé»˜è®¤å€¼ã€‚</li> <li><code>x[start:end]</code>: æ•°ç»„åˆ‡ç‰‡ï¼Œä»…å¯ä½¿ç”¨äº <code>calldata</code> æ•°ç»„.</li></ul> <h5 id="push"><a href="#push" class="header-anchor">#</a> push</h5> <p>é€šè¿‡ <code>push()</code>ã€€å¢åŠ  storage æ•°ç»„çš„é•¿åº¦å…·æœ‰å›ºå®šçš„ gas æ¶ˆè€—ï¼Œå› ä¸º storage æ€»æ˜¯è¢«é›¶åˆå§‹åŒ–ï¼›</p> <p>ä¾‹å­: çŠ¶æ€å˜é‡çš„å®šé•¿æ•°ç»„å¯ä»¥é€šè¿‡ push æ¥æ”¹å˜é•¿åº¦ã€‚ä½†æ˜¯å†…å­˜ä¸­ä¸å¯ä»¥ä½¿ç”¨ pushã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    uint256[] public a1 = new uint256[](5);

    function setStorageA() external {
        a1.push(8);
    }

    function setMemoryA() external pure {
        uint256[] memory a2 = new uint256[](5);

        // Type uint8[5] memory is not implicitly convertible to expected
        // type uint256[] memory. uint256[] memory a3 = [1, 2, 3, 4, 5];

        // Member &quot;push&quot; is not available in uint256[] memory outside of storage.
        // a2.push(8);
    }
}
</code></pre></div><h5 id="pop-delete"><a href="#pop-delete" class="header-anchor">#</a> pop &amp; delete</h5> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract FunctionOutputs {
    uint256[] private nums = [1, 2, 3];
    uint256[3] private numsFixed = [1, 2, 3];

    function setArray()
        external
        returns (
            uint256 len1,
            uint256 len2,
            uint256 len3
        )
    {
        nums.push(4); // push
        len1 = nums.length;

        nums.pop(); // åˆ é™¤
        len2 = nums.length;

        nums[2] = 666;

        delete nums[1];
        // delete nums;
        len3 = nums.length;
    }

    function getArray() external view returns (uint256[] memory) {
        return nums;
    }
}
</code></pre></div><ul><li><code>pop</code> åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ </li> <li><code>delete array[x]</code> ä»…ä»…æ˜¯æ¸…é™¤å…ƒç´ å¯¹åº”ç´¢å¼•ä¸ºé»˜è®¤å€¼</li> <li><code>delete array</code> array çš„ length é‡ç½®ä¸º 0</li></ul> <p>é€šè¿‡ <code>pop()</code>ã€€åˆ é™¤æ•°ç»„æˆæœ¬æ˜¯å¾ˆé«˜çš„,å› ä¸ºå®ƒåŒ…æ‹¬å·²åˆ é™¤çš„å…ƒç´ çš„æ¸…ç†ï¼Œç±»ä¼¼äºåœ¨è¿™äº›å…ƒç´ ä¸Šè°ƒç”¨ <code>delete</code>ã€‚</p> <p>æ³¨æ„:å¦‚æœéœ€è¦åœ¨å¤–éƒ¨ï¼ˆexternalï¼‰å‡½æ•°ä¸­ä½¿ç”¨å¤šç»´æ•°ç»„ï¼Œè¿™éœ€è¦å¯ç”¨ ABI coder v2ã€‚ public å‡½æ•°ä¸­æ˜¯æ”¯æŒçš„ä½¿ç”¨å¤šç»´æ•°ç»„ã€‚å› ä¸ºå¤šç»´æ•°ç»„ç”¨çš„åœºæ™¯ä¸å¤šï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†ã€‚</p> <h5 id="æ•°ç»„åˆ‡ç‰‡-x-start-end"><a href="#æ•°ç»„åˆ‡ç‰‡-x-start-end" class="header-anchor">#</a> æ•°ç»„åˆ‡ç‰‡: x[start:end]</h5> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    uint256[] internal nums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 0];
    uint256[] temp1;
    uint256[] temp2;
    uint256[] temp3;

    // è¾“å…¥ [1, 2, 3, 4, 5, 6, 7, 8, 9, 0]
    function setTemp(uint256[] calldata _arr)
        external
        returns (
            uint256[] memory,
            uint256[] memory,
            uint256[] memory
        )
    {
        temp1 = _arr[0:2];
        temp2 = _arr[:2];
        temp3 = _arr[2:];

        // Index range access is only supported for dynamic calldata arrays.
        // temp3 = nums[2:];

        return (temp1, temp2, temp3);
    }
}
</code></pre></div><p>æ•°ç»„åˆ‡ç‰‡æ˜¯æ•°ç»„è¿ç»­éƒ¨åˆ†çš„è§†å›¾ï¼Œç”¨æ³•å¦‚ï¼š<code>x[start:end]</code> ï¼Œ <code>start</code> å’Œ <code>end</code> æ˜¯ <code>uint256</code> ç±»å‹ï¼ˆæˆ–ç»“æœä¸º <code>uint256</code> çš„è¡¨è¾¾å¼ï¼‰ã€‚ <code>x[start:end]</code> çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ <code>x[start]</code> ï¼Œ æœ€åä¸€ä¸ªå…ƒç´ æ˜¯ <code>x[end - 1]</code> ã€‚(åŒ…å« startï¼Œä¸åŒ…å« end)</p> <ul><li>ç›®å‰æ•°ç»„åˆ‡ç‰‡ï¼Œä»…å¯ä½¿ç”¨äº <code>calldata</code> æ•°ç»„.</li> <li>å¦‚æœ <code>start</code> æ¯” <code>end</code> å¤§æˆ–è€… <code>end</code> æ¯”æ•°ç»„é•¿åº¦è¿˜å¤§ï¼Œå°†ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li> <li><code>start</code> å’Œ <code>end</code> éƒ½å¯ä»¥æ˜¯å¯é€‰çš„ï¼š <code>start</code> é»˜è®¤æ˜¯ 0ï¼Œ è€Œ <code>end</code> é»˜è®¤æ˜¯æ•°ç»„é•¿åº¦ã€‚</li></ul> <p>æ•°ç»„åˆ‡ç‰‡æ²¡æœ‰ä»»ä½•æˆå‘˜ã€‚ å®ƒä»¬å¯ä»¥éšå¼è½¬æ¢ä¸ºå…¶â€œèƒŒåâ€ç±»å‹çš„æ•°ç»„ï¼Œå¹¶æ”¯æŒç´¢å¼•è®¿é—®ã€‚ ç´¢å¼•è®¿é—®ä¹Ÿæ˜¯ç›¸å¯¹äºåˆ‡ç‰‡çš„å¼€å§‹ä½ç½®ã€‚ æ•°ç»„åˆ‡ç‰‡æ²¡æœ‰ç±»å‹åç§°ï¼Œè¿™æ„å‘³ç€æ²¡æœ‰å˜é‡å¯ä»¥å°†æ•°ç»„åˆ‡ç‰‡ä½œä¸ºç±»å‹ï¼Œå®ƒä»¬ä»…å­˜åœ¨äºä¸­é—´è¡¨è¾¾å¼ä¸­ã€‚</p> <h4 id="â“»-æ¨¡æ‹Ÿåˆ‡ç‰‡çš„-slice-æ–¹æ³•"><a href="#â“»-æ¨¡æ‹Ÿåˆ‡ç‰‡çš„-slice-æ–¹æ³•" class="header-anchor">#</a> â“» æ¨¡æ‹Ÿåˆ‡ç‰‡çš„ slice æ–¹æ³•</h4> <p>åˆ‡ç‰‡å½“å‰ä»…æ”¯æŒ calldata çš„æ•°æ®ï¼Œå¦‚æœæ˜¯ memory å°±ä¸æ”¯æŒäº†ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract FunctionOutputs {
    function slice(
        uint256[] memory arr,
        uint256 begin,
        uint256 end
    ) internal pure returns (uint256[] memory) {
        require(begin &lt; arr.length, &quot;index out of bound&quot;);

        //å¦‚æœèµ·å§‹ä½ç½®è¶Šç•Œï¼Œè¿”å›ç©ºæ•°ç»„
        if (begin &gt;= arr.length) return arr;

        //å¤„ç† begin å’Œ endå°äº0çš„æƒ…å†µï¼Œä½¿ç”¨ uint256 ï¼Œä¸å­˜åœ¨è´Ÿæ•°
        // if (begin &lt; 0) {
        //     begin = begin + arr.length &lt; 0 ? 0 : begin + arr.length;
        // }
        // if (end &lt; 0) {
        //     end = end + arr.length &lt; 0 ? 0 : end + arr.length;
        // }

        //å£°æ˜ä¸€ä¸ªç©ºæ•°ç»„ï¼Œä½œä¸ºå¤åˆ¶åè¿”å›å€¼
        uint256[] memory temp = new uint256[](end - begin);

        //å¤åˆ¶beginè‡³endçš„å…ƒç´ åˆ° temp ä¸­ åŒ…æ‹¬arr[begin] ä¸åŒ…æ‹¬arr[end]
        for (uint256 index = begin; index &lt; end; index++) {
            temp[index - begin] = arr[index];
        }
        return temp;
    }

    function test()
        external
        pure
        returns (
            uint256[] memory arr,
            uint256[] memory temp1,
            uint256[] memory temp2,
            uint256[] memory temp3
        )
    {
        arr = new uint256[](5);
        arr[0] = 1;
        arr[1] = 2;
        arr[2] = 3;
        arr[3] = 4;
        arr[4] = 5;

        temp1 = slice(arr, 1, 3); // [2,3]
        temp2 = slice(arr, 1, 4); // [2,3,4]
        temp3 = slice(arr, 1, 5); // [2,3,4,5]
    }
}
</code></pre></div><h4 id="â“¼-delete-å®Œå…¨åˆ é™¤æ•°ç»„çš„æŒ‡å®šç´¢å¼•"><a href="#â“¼-delete-å®Œå…¨åˆ é™¤æ•°ç»„çš„æŒ‡å®šç´¢å¼•" class="header-anchor">#</a> â“¼ delete å®Œå…¨åˆ é™¤æ•°ç»„çš„æŒ‡å®šç´¢å¼•</h4> <p>åˆ é™¤æ•°ç»„çš„æŒ‡å®šç´¢å¼•ï¼Œæ•°ç»„çš„é•¿åº¦ä¹Ÿä¼šæ”¹å˜</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract FunctionOutputs {
    function deletePro(uint256[] memory arr, uint256 _index)
        internal
        pure
        returns (uint256[] memory temp)
    {
        require(_index &lt; arr.length, &quot;index out of bound&quot;);
        temp = new uint256[](arr.length - 1);
        for (uint256 index = 0; index &lt;= temp.length - 1; index++) {
            if (index &gt;= _index) {
                temp[_index] = arr[_index + 1];
            } else {
                temp[index] = arr[index];
            }
        }
    }

    function test()
        external
        pure
        returns (uint256[] memory arr, uint256[] memory temp)
    {
        arr = new uint256[](3);
        arr[0] = 1;
        arr[1] = 2;
        arr[2] = 3;
        assert(arr[0] == 1);
        assert(arr[1] == 2);
        assert(arr[2] == 3);
        assert(arr.length == 3);

        temp = deletePro(arr, 1);
        assert(temp[0] == 1);
        assert(temp[1] == 3);
        assert(temp.length == 2);
    }
}
</code></pre></div><h3 id="_2-bytes"><a href="#_2-bytes" class="header-anchor">#</a> 2.bytes</h3> <p><code>string</code> å’Œ <code>bytes</code> ç±»å‹çš„å˜é‡æ˜¯ç‰¹æ®Šçš„æ•°ç»„ã€‚ <code>bytes</code> å¯ä»¥é€šè¿‡ç´¢å¼•æˆ–è€…<code>.length</code>æ¥è®¿é—®æ•°æ®ã€‚string ä¸ bytes ç›¸åŒï¼Œä½†ä¸å…è®¸ç”¨<code>.length</code>æˆ–ç´¢å¼•æ¥è®¿é—®æ•°æ®ã€‚</p> <ul><li>å¯¹ä»»æ„é•¿åº¦çš„åŸå§‹å­—èŠ‚æ•°æ®ä½¿ç”¨ <code>bytes</code>ï¼Œå¯¹ä»»æ„é•¿åº¦å­—ç¬¦ä¸²ï¼ˆUTF-8ï¼‰æ•°æ®ä½¿ç”¨ <code>string</code> ã€‚</li> <li>å¦‚æœä½¿ç”¨ä¸€ä¸ªé•¿åº¦é™åˆ¶çš„å­—èŠ‚æ•°ç»„ï¼Œåº”è¯¥ä½¿ç”¨ä¸€ä¸ª <code>bytes1</code> åˆ° <code>bytes32</code> çš„å…·ä½“ç±»å‹ï¼Œå› ä¸ºå®ƒä»¬ä¾¿å®œå¾—å¤šã€‚</li> <li><code>bytesN[]</code> å’Œ <code>bytes</code> å¯ä»¥è½¬æ¢: bytes1 æ˜¯å€¼ç±»å‹ï¼Œæ¯”å¦‚ <code>0x61</code>; <code>bytes</code>æ˜¯å¯å˜å­—èŠ‚æ•°ç»„,å¦‚æœ bytes1 æƒ³è¦å€Ÿç”¨ bytes çš„æ–¹æ³•ï¼Œå°±éœ€è¦è½¬æ¢æˆ bytes;</li> <li>åŸºæœ¬è§„åˆ™:å¯¹ä»»æ„é•¿åº¦çš„åŸå§‹å­—èŠ‚æ•°æ®ä½¿ç”¨ <code>bytes</code>ï¼Œå¯¹ä»»æ„é•¿åº¦å­—ç¬¦ä¸²ï¼ˆUTF-8ï¼‰æ•°æ®ä½¿ç”¨ <code>string</code> ã€‚</li></ul> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-20"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-20" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=33" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 7 èŠ‚å¼•ç”¨ç±»å‹: bytes</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=0QfJRgBOOCg&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=33" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 7 èŠ‚å¼•ç”¨ç±»å‹: bytes</a></li></ul> <h4 id="â“µ-åˆ›å»º"><a href="#â“µ-åˆ›å»º" class="header-anchor">#</a> â“µ åˆ›å»º</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    bytes public welcome = bytes(&quot;1.Welcome&quot;);
    bytes public temp1 = new bytes(2); // å¯å˜å­—èŠ‚æ•°ç»„åˆ›å»ºæ–¹å¼

    function test1(uint256 len_) public pure  returns(bytes memory){
        bytes memory temp2 = new bytes(len_);
        temp2[0] = &quot;a&quot;;
        return temp2;
    }
    function test2() public{
        temp1[0] = &quot;a&quot;;
    }
}
</code></pre></div><p>çŠ¶æ€å˜é‡çš„åˆ›å»ºæ–¹å¼</p> <div class="language- extra-class"><pre class="language-text"><code>bytes public welcome = bytes(&quot;1.Welcome&quot;);
</code></pre></div><p>å‡½æ•°ä¸­å¯å˜å­—èŠ‚æ•°ç»„åˆ›å»ºæ–¹å¼ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>bytes memory temp2 = new bytes(length); // å¯å˜å­—èŠ‚æ•°ç»„åˆ›å»ºæ–¹å¼
</code></pre></div><h4 id="â“¶-bytes-å’Œ-bytes32-åŒºåˆ«"><a href="#â“¶-bytes-å’Œ-bytes32-åŒºåˆ«" class="header-anchor">#</a> â“¶ bytes å’Œ <code>bytes32[]</code> åŒºåˆ«</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// bytes / bytes32 / bytes32[] åŒºåˆ«
// bytes:å¯å˜å­—èŠ‚æ•°ç»„ ï¼š å¼•ç”¨ç±»å‹
// bytes32: å›ºå®šé•¿åº¦çš„å­—èŠ‚æ•°ç»„ ï¼š å€¼ç±»å‹
// bytes32[]: ç”±â€œå›ºå®šé•¿åº¦çš„å­—èŠ‚æ•°ç»„â€ ç»„æˆçš„ æ•°ç»„ç±»å‹
contract Demo {
    bytes public welcome1 = bytes(&quot;1.Welcome&quot;);
    bytes32 public welcome2 = &quot;a&quot;;
    bytes32[] public welcome3 = [bytes32(&quot;a&quot;)];
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    bytes32[] public abcArray = [bytes1(&quot;a&quot;), bytes1(&quot;b&quot;), bytes1(&quot;c&quot;)];

    // 0x616263
    bytes public abcBytes = bytes(&quot;abc&quot;);

    function getAbcArr() external view returns (bytes32[] memory) {
        return abcArray;
    }
}
</code></pre></div><p><code>abcBytes</code> çš„å€¼æ˜¯: <code>0x616263</code>;</p> <p><code>abcArray</code> çš„å€¼æ˜¯ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>[
    0x6100000000000000000000000000000000000000000000000000000000000000,
    0x6200000000000000000000000000000000000000000000000000000000000000,
    0x6300000000000000000000000000000000000000000000000000000000000000
]
</code></pre></div><p><code>bytes</code> æœ‰ç‚¹ç±»ä¼¼äº <code>bytes1[]</code>çš„ç´§æ‰“åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸Šé¢ä¾‹å­ä¸­ bytes32 æ”¹ä¸º bytes1 ç±»å‹è¿›è¡Œå¯¹æ¯”ã€‚</p> <p>æˆ‘ä»¬æ›´å¤šæ—¶å€™åº”è¯¥ä½¿ç”¨ <code>bytes</code> è€Œä¸æ˜¯ <code>bytes32[]</code>è¿™ç§æ•°ç»„ç±»å‹ ï¼Œå› ä¸º Gas è´¹ç”¨æ›´ä½;</p> <ul><li><code>bytes32[]</code> ä¼šåœ¨å…ƒç´ ä¹‹é—´æ·»åŠ  31 ä¸ªå¡«å……å­—èŠ‚ã€‚</li> <li><code>bytes</code> ç”±äºç´§å¯†åŒ…è£…ï¼Œè¿™æ²¡æœ‰å¡«å……å­—èŠ‚ã€‚</li></ul> <h4 id="â“·-å±æ€§-2"><a href="#â“·-å±æ€§-2" class="header-anchor">#</a> â“· å±æ€§</h4> <ul><li>è·å– bytes é•¿åº¦
<ul><li>bytesVar.length:ä»¥å­—èŠ‚é•¿åº¦è¡¨ç¤ºå­—ç¬¦ä¸²çš„é•¿åº¦</li></ul></li> <li>è·å–æŒ‡å®šç´¢å¼•çš„æ•°æ®<div class="language- extra-class"><pre class="language-text"><code>bytes1 temp1 = bytes(welcome)[_index]; // è¿”å›å›ºå®šé•¿åº¦çš„ bytes1
</code></pre></div></li> <li>ä¿®æ”¹ bytes
<ul><li><code>bytesVar[7] = 'x'</code></li></ul></li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    bytes public welcome = bytes(&quot;1.Welcome&quot;);

    function getLength() public view returns (uint256 welcomeLength) {
        welcomeLength = welcome.length;
    }

    function modi() public {
        welcome[0] = bytes1(&quot;2&quot;);
    }
}
</code></pre></div><h4 id="â“¸-æ–¹æ³•"><a href="#â“¸-æ–¹æ³•" class="header-anchor">#</a> â“¸ æ–¹æ³•</h4> <ul><li>bytes æ‹¼æ¥
<ul><li><code>bytes.concat(...) returns (bytes memory):</code></li> <li>å¦‚æœä¸ä½¿ç”¨å‚æ•°è°ƒç”¨ bytes.concat å°†è¿”å›ç©ºæ•°ç»„ã€‚</li></ul></li> <li>push æ–¹æ³•
<ul><li><code>a.push(b)</code> å¾€å­—èŠ‚æ•°ç»„æ·»åŠ å­—èŠ‚</li></ul></li> <li><code>delete bys;</code>:æ¸…ç©ºå­—èŠ‚æ•°ç»„</li> <li><code>x[start:end]</code>: æ•°ç»„åˆ‡ç‰‡</li> <li><code>bytes()</code>: å°†å­—ç¬¦ä¸²è½¬æ¢åˆ° bytes</li> <li><code>string()</code>:å°† bytes æ•°æ®è½¬æ¢åˆ°å­—ç¬¦ä¸²</li> <li>æ¯”è¾ƒä¸¤ä¸ª bytes
<ul><li><code>keccak256(bytes1) == keccak256(bytes2)</code></li></ul></li></ul> <h5 id="bytes-concat-æ‹¼æ¥"><a href="#bytes-concat-æ‹¼æ¥" class="header-anchor">#</a> bytes.concat æ‹¼æ¥</h5> <ul><li><code>bytes.concat(...) returns (bytes memory)</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    bytes public welcome = bytes(&quot;a&quot;);
    bytes public concatBytes = bytes.concat(welcome, bytes(&quot;b&quot;), bytes1(&quot;c&quot;),&quot;a&quot;);
}
</code></pre></div><p>bytes.concat å‡½æ•°å¯ä»¥è¿æ¥ä»»æ„æ•°é‡çš„ <code>bytes</code> æˆ– <code>bytes1</code> ... <code>bytes32</code> å€¼ã€‚ è¯¥å‡½æ•°è¿”å›ä¸€ä¸ª <code>bytes memory</code> ï¼ŒåŒ…å«æ‰€æœ‰å‚æ•°çš„å†…å®¹ï¼Œæ— å¡«å……æ–¹å¼æ‹¼æ¥åœ¨ä¸€èµ·ã€‚ å¦‚æœä½ æƒ³ä½¿ç”¨å­—ç¬¦ä¸²å‚æ•°æˆ–å…¶ä»–ä¸èƒ½éšå¼è½¬æ¢ä¸º <code>bytes</code> çš„ç±»å‹ï¼Œä½ éœ€è¦å…ˆå°†å®ƒä»¬è½¬æ¢ä¸º <code>bytes</code>æˆ– <code>bytes1/â€¦/ bytes32</code>ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    bytes public welcome = bytes(&quot;a&quot;);
    bytes public concatBytes = bytes.concat();
}
</code></pre></div><p>å¦‚æœä½ ä¸ä½¿ç”¨å‚æ•°è°ƒç”¨ <code>bytes.concat</code> å°†è¿”å›ç©ºæ•°ç»„ã€‚</p> <h5 id="push-æ–¹æ³•"><a href="#push-æ–¹æ³•" class="header-anchor">#</a> push æ–¹æ³•</h5> <p>æ³¨æ„ï¼š push æ˜¯å•ä¸ªå­—èŠ‚ï¼Œæ˜¯ <code>bytes1</code>çš„å›ºå®šé•¿åº¦,è€Œä¸æ˜¯ <code>bytes</code>ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    bytes public welcome1 = bytes(&quot;Welcome&quot;);
    bytes public welcome2 = new bytes(10);

    function testPush() public {
        welcome1.push(bytes(&quot;A&quot;)[0]);
        welcome2.push(bytes(&quot;B&quot;)[0]);
    }
}
</code></pre></div><h5 id="pop-æ–¹æ³•"><a href="#pop-æ–¹æ³•" class="header-anchor">#</a> pop æ–¹æ³•</h5> <p>åˆ é™¤æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    bytes public welcome1 = bytes(&quot;Welcome&quot;);
    bytes public welcome2 = new bytes(10);

    function testPop() public {
        welcome1.pop();
        welcome2.pop();
    }
}
</code></pre></div><h5 id="delete-æ¸…ç©ºå­—èŠ‚æ•°ç»„"><a href="#delete-æ¸…ç©ºå­—èŠ‚æ•°ç»„" class="header-anchor">#</a> <code>delete</code> æ¸…ç©ºå­—èŠ‚æ•°ç»„</h5> <p>ä½¿ç”¨ <code>delete</code> å…¨å±€å…³é”®å­—;</p> <ul><li><code>delete bytesName</code></li> <li><code>delete bytesName[index]</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    bytes public welcome1 = bytes(&quot;Welcome&quot;);

    function deleteAll() public {
        delete welcome1;
    }

    function deleteIndex(uint256 index_) public {
        delete welcome1[index_];
    }
}
</code></pre></div><h5 id="x-start-end-æ•°ç»„åˆ‡ç‰‡"><a href="#x-start-end-æ•°ç»„åˆ‡ç‰‡" class="header-anchor">#</a> <code>x[start:end]</code>:æ•°ç»„åˆ‡ç‰‡</h5> <p>æ³¨æ„ï¼šæ•°ç»„åˆ‡ç‰‡åªèƒ½ç”¨åœ¨ calldata ç±»å‹ä¸Šã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Proxy {
    bytes public welcome1 = bytes(&quot;Welcome&quot;);
    bytes4 public temp1 = bytes4(welcome1); // 0x57656c63

    // æŠŠ welcome1 çš„å€¼ä¼ å…¥å‚æ•°
    function forward(bytes calldata payload)
        external pure
        returns(bytes memory temp2,bytes4 temp3)
    {
        // åˆ‡ç‰‡æ–¹æ³•åªèƒ½ç”¨åœ¨ calldata ä¸Šã€‚
        temp2 = payload[:4];
        temp3 = bytes4(payload[:4]);
    }
}
</code></pre></div><p>å¦ä¸€ä¸ªä¾‹å­: <code>bts_[:4]</code> å’Œ <code>bytes4(bts_)</code> ç»“æœä¸ä¸€æ ·ï¼</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// x[start:end]
//      1.åªèƒ½ç”¨åœ¨ caldata ç±»å‹çš„æ•°æ®ä¸Š
//      2.åˆ‡å‡ºæ¥çš„æ˜¯æ•°ç»„ï¼š`bts_[:4]` å’Œ `bytes4(bts_)` ç»“æœä¸ä¸€æ ·ï¼
//          ä¸¤è€…è™½ç„¶çœ‹èµ·æ¥å€¼æ„ä¹‰ï¼Œä½†æ˜¯ç±»å‹ä¸ä¸€æ ·ï¼å¤„ç†çš„æ—¶å€™ä¹Ÿéœ€è¦æ³¨æ„
contract Demo {
    // 0x57656c636f6d65
    bytes public welcome1 = bytes(&quot;Welcome&quot;);
    bytes4 public welcome2 = bytes4(welcome1);

    // bytes: temp1 0x57656c63
    // bytes4: temp2 0x57656c63
    function test(bytes calldata bts_) public pure returns(
        bytes memory temp1,
        bytes4 temp2,
        bytes4 temp3
    ){
        temp1 = bts_[:4]; // åˆ‡çš„è¿”å›å€¼æ˜¯æ•°ç»„
        temp2 = bytes4(bts_[:4]); //
        temp3 = bytes4(bts_); // åˆ‡ï¼š ç”±å¤§åˆ°å° =&gt; åˆ‡å‡ºæ¥çš„æ˜¯å€¼ç±»å‹
    }

}
</code></pre></div><p>ä¾‹å­: <strong>æ•°ç»„åˆ‡ç‰‡åœ¨ ABI è§£ç æ•°æ®çš„æ—¶å€™éå¸¸æœ‰ç”¨</strong>ï¼Œå¦‚ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Proxy {
    /// è¢«å½“å‰åˆçº¦ç®¡ç†çš„ å®¢æˆ·ç«¯åˆçº¦åœ°å€
    address client;

    constructor(address client_) {
        client = client_;
    }

    /// åœ¨è¿›è¡Œå‚æ•°éªŒè¯ä¹‹åï¼Œè½¬å‘åˆ°ç”±clientå®ç°çš„ &quot;setOwner(address)&quot;
    function forward(bytes calldata payload) external {
        bytes4 sig = bytes4(payload[:4]);

        // ç”±äºæˆªæ–­è¡Œä¸ºï¼Œä¸æ‰§è¡Œ bytes4(payload) æ˜¯ç›¸åŒçš„
        // bytes4 sig = bytes4(payload);

        if (sig == bytes4(keccak256(&quot;setOwner(address)&quot;))) {
            address owner = abi.decode(payload[4:], (address));
            require(owner != address(0), &quot;Address of owner cannot be zero.&quot;);
        }
        (bool status, ) = client.delegatecall(payload);
        require(status, &quot;Forwarded call failed.&quot;);
    }
}
</code></pre></div><h4 id="â“¹-å­—ç¬¦ä¸²-åˆ°-bytes-çš„è½¬æ¢"><a href="#â“¹-å­—ç¬¦ä¸²-åˆ°-bytes-çš„è½¬æ¢" class="header-anchor">#</a> â“¹ å­—ç¬¦ä¸² åˆ° bytes çš„è½¬æ¢</h4> <p>è½¬æ¢æ–¹æ³•: å¯ä»¥ä½¿ç”¨ <code>bytes()</code> æ„é€ å‡½æ•°å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º <code>bytes</code>ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    function trans(string memory _str) external pure returns (bytes memory) {
        return bytes(_str);
    }
}
</code></pre></div><h4 id="â“º-bytes-åˆ°-å­—ç¬¦ä¸²-çš„è½¬æ¢"><a href="#â“º-bytes-åˆ°-å­—ç¬¦ä¸²-çš„è½¬æ¢" class="header-anchor">#</a> â“º bytes åˆ° å­—ç¬¦ä¸² çš„è½¬æ¢</h4> <p>è½¬æ¢æ–¹æ³•: å¯ä»¥ä½¿ç”¨ <code>string()</code> æ„é€ å‡½æ•°å°† <code>bytes</code> è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</p> <p>æ³¨æ„: å­—èŠ‚æ•°ç»„åˆ†ä¸ºåŠ¨æ€å¤§å°å’Œå›ºå®šå¤§å°çš„ã€‚å¦‚æœæ˜¯å›ºå®šå¤§å°å­—èŠ‚æ•°ç»„ï¼Œéœ€è¦å…ˆè½¬ä¸ºåŠ¨æ€å¤§å°å­—èŠ‚æ•°ç»„ã€‚</p> <ul><li><code>åŠ¨æ€å¤§å°å­—èŠ‚æ•°ç»„</code> â€”&gt; <code>string</code></li> <li><code>å›ºå®šå¤§å°å­—èŠ‚æ•°ç»„</code> â€”&gt; <code>åŠ¨æ€å¤§å°å­—èŠ‚æ•°ç»„</code> â€”&gt; <code>string</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Test {
    string public data1;
    string public data2;

    // `åŠ¨æ€å¤§å°å­—èŠ‚æ•°ç»„` â€”&gt; `string`
    function trans1() external {
        bytes memory bstr = new bytes(2);
        bstr[0] = &quot;a&quot;;
        bstr[1] = &quot;b&quot;;
        data1 = string(bstr);
    }

    // `å›ºå®šå¤§å°å­—èŠ‚æ•°ç»„` â€”&gt; `åŠ¨æ€å¤§å°å­—èŠ‚æ•°ç»„` â€”&gt; `string`
    function trans2() external {
        // å›ºå®šå¤§å°å­—èŠ‚æ•°ç»„
        bytes2 ab = 0x6162;

        // `å›ºå®šå¤§å°å­—èŠ‚æ•°ç»„` â€”&gt; `åŠ¨æ€å¤§å°å­—èŠ‚æ•°ç»„`
        bytes memory temp = new bytes(ab.length); // å¯å˜å­—èŠ‚æ•°ç»„åˆ›å»ºæ–¹å¼
        for (uint256 i = 0; i &lt; ab.length; i++) {
            temp[i] = ab[i];
        }

        // `åŠ¨æ€å¤§å°å­—èŠ‚æ•°ç»„` â€”&gt; `string`
        data2 = string(temp);
    }
}
</code></pre></div><h4 id="â“»-æ¯”è¾ƒ-2-ä¸ª-bytes-å€¼æ˜¯å¦ç›¸ç­‰"><a href="#â“»-æ¯”è¾ƒ-2-ä¸ª-bytes-å€¼æ˜¯å¦ç›¸ç­‰" class="header-anchor">#</a> â“» æ¯”è¾ƒ 2 ä¸ª bytes å€¼æ˜¯å¦ç›¸ç­‰</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    bytes welcome1 = bytes(&quot;Welcome&quot;);
    bytes welcome2 = bytes(&quot;Welcome&quot;);

    function test1() public view returns (bool) {
        return keccak256(welcome2) == keccak256(welcome1);
    }
}
</code></pre></div><h3 id="_3-string"><a href="#_3-string" class="header-anchor">#</a> 3.string</h3> <p>Solidity ä¸­ï¼Œå­—ç¬¦ä¸²å€¼ä½¿ç”¨åŒå¼•å·(<code>&quot;&quot;</code>)æˆ–å•å¼•å·(<code>''</code>)åŒ…æ‹¬ï¼Œå­—ç¬¦ä¸²ç±»å‹ç”¨ string è¡¨ç¤ºã€‚<code>string</code> å’Œ <code>bytes</code> ç±»å‹çš„å˜é‡æ˜¯ç‰¹æ®Šçš„æ•°ç»„ï¼Œæ˜¯å¼•ç”¨ç±»å‹ã€‚</p> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-21"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-21" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=34" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 7 èŠ‚å¼•ç”¨ç±»å‹: string</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=nnJgvvObd5o&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=34" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 7 èŠ‚å¼•ç”¨ç±»å‹: string</a></li></ul> <h4 id="â“µ-æ ¼å¼"><a href="#â“µ-æ ¼å¼" class="header-anchor">#</a> â“µ æ ¼å¼</h4> <div class="language- extra-class"><pre class="language-text"><code>&quot;abc&quot;
'hello'
</code></pre></div><p>ä¾‹å­</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract For {
    string public a = &quot;a&quot; &quot;b&quot; &quot;c&quot;;
    string public b = &quot;abc&quot;;
    string public c = 'x' 'y' 'z';
    string public d = 'xyz';
}
</code></pre></div><h4 id="â“¶-å±æ€§"><a href="#â“¶-å±æ€§" class="header-anchor">#</a> â“¶ å±æ€§</h4> <p>string å¹¶æ²¡æœ‰è·å–å…¶å­—ç¬¦ä¸²é•¿åº¦çš„ length å±æ€§; ä¹Ÿæ²¡æä¾›è·å–æŸä¸ªç´¢å¼•å­—èŠ‚ç çš„ç´¢å¼•å±æ€§ã€‚</p> <p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æŠŠ string è½¬æ¢æˆ <code>bytes</code>ï¼Œå€ŸåŠ©<code>bytes</code> çš„å±æ€§ã€‚</p> <p>ä¾‹å­: ä¸‹é¢æ˜¯ä½¿ç”¨ <code>getLength()</code> è·å–é•¿åº¦ï¼Œä½¿ç”¨<code>modi()</code>ä¿®æ”¹å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ <code>getIndexValue()</code> è·å–å­—ç¬¦ä¸²çš„æŒ‡å®šç´¢å¼•çš„æ•°æ®ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    string public welcome = &quot;1.Welcome&quot;;

    function getLength() public view returns (uint256 welcomeLength) {
        welcomeLength = bytes(welcome).length;
    }

    function getIndexValue(uint256 _index) public view returns (string memory) {
        bytes1 temp1 = bytes(welcome)[_index]; // è¿”å›å›ºå®šé•¿åº¦çš„ bytes1
        bytes memory temp2 = new bytes(1); // å¯å˜å­—èŠ‚æ•°ç»„åˆ›å»ºæ–¹å¼
        temp2[0] = temp1;
        return string(temp2);
    }

    function modi() public {
        bytes(welcome)[0] = bytes1(&quot;2&quot;);
    }
}
</code></pre></div><ul><li>è·å–å­—ç¬¦ä¸²çš„é•¿åº¦
<ul><li><code>bytes(str).length</code>:ä»¥å­—èŠ‚é•¿åº¦è¡¨ç¤ºå­—ç¬¦ä¸²çš„é•¿åº¦</li></ul></li> <li>æŸä¸ªå­—ç¬¦ä¸²ç´¢å¼•çš„å­—èŠ‚ç 
<ul><li><code>bytes1 temp1 = bytes(str)[_index];</code><div class="language- extra-class"><pre class="language-text"><code>function getIndexValue(uint256 _index) public view return(string memory) {
    bytes1 temp1 = bytes(welcome)[_index]; // è¿”å›å›ºå®šé•¿åº¦çš„ bytes1
    bytes memory temp2 = new bytes(1); // å¯å˜å­—èŠ‚æ•°ç»„åˆ›å»ºæ–¹å¼
    temp2[0] = temp1;
    return string(temp2);
}
</code></pre></div></li></ul></li> <li>ä¿®æ”¹å­—ç¬¦ä¸²
<ul><li><code>bytes(s)[7] = 'x'</code></li></ul></li></ul> <h4 id="â“·-æ–¹æ³•"><a href="#â“·-æ–¹æ³•" class="header-anchor">#</a> â“· æ–¹æ³•</h4> <p>Solidity string æœ¬èº«å¹¶æ²¡æœ‰æ“ä½œå‡½æ•°ï¼Œéœ€è¦å€ŸåŠ©å…¨å±€çš„å‡½æ•°</p> <ul><li><p>å­—ç¬¦ä¸²æ‹¼æ¥</p> <ul><li><code>string.concat()</code></li> <li>å¦‚æœä¸ä½¿ç”¨å‚æ•°è°ƒç”¨ string.concat å°†è¿”å›ç©ºæ•°ç»„ã€‚</li></ul></li> <li><p>å°† bytes è½¬æ¢åˆ° å­—ç¬¦ä¸²</p> <ul><li><code>string()</code></li></ul></li> <li><p>å°† å­—ç¬¦ä¸² è½¬æ¢åˆ° bytes</p> <ul><li><code>bytes()</code></li></ul></li> <li><p>æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²</p> <ul><li><code>keccak256(abi.encodePacked(s1)) == keccak256(abi.encodePacked(s2))</code></li> <li><code>keccak256(bytes(s1)) == keccak256(bytes(s2))</code>:æ›´çœ gas</li></ul></li> <li><p>æœ‰æ²¡æœ‰å¦‚ä¸‹åŠæ³•å‘¢ï¼Ÿ</p> <ul><li>push</li> <li>pop</li> <li>delete</li> <li><code>x[start:end]</code></li></ul></li></ul> <h4 id="â“¸-å­—ç¬¦ä¸²æ‹¼æ¥"><a href="#â“¸-å­—ç¬¦ä¸²æ‹¼æ¥" class="header-anchor">#</a> â“¸ å­—ç¬¦ä¸²æ‹¼æ¥</h4> <p>å¯ä»¥ä½¿ç”¨ <code>string.concat</code> è¿æ¥ä»»æ„æ•°é‡çš„ string å­—ç¬¦ä¸²ã€‚ è¯¥å‡½æ•°è¿”å›ä¸€ä¸ª <code>string memory</code> ï¼ŒåŒ…å«æ‰€æœ‰å‚æ•°çš„å†…å®¹ï¼Œæ— å¡«å……æ–¹å¼æ‹¼æ¥åœ¨ä¸€èµ·ã€‚ å¦‚æœä½ æƒ³ä½¿ç”¨ä¸èƒ½éšå¼è½¬æ¢ä¸º string çš„å…¶ä»–ç±»å‹ä½œä¸ºå‚æ•°ï¼Œä½ éœ€è¦å…ˆæŠŠå®ƒä»¬è½¬æ¢ä¸º stringã€‚</p> <p><strong>string.concat ä¾‹å­</strong></p> <p>è¾“å…¥å­—ç¬¦ä¸²ï¼Œè¾“å‡ºæ‹¼æ¥åçš„å­—ç¬¦ä¸²</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    string public welcome = &quot;Welcome&quot;;

    // å†™ä¸€ä¸ª welcome username çš„å°æ–¹æ³•
    // Welcome Anbang!
    function test(string memory name_)
        public
        view
        returns(string memory concatString){
            bytes memory bs = bytes(&quot;!&quot;);
            // welcome + name_ + bs
            // å†…éƒ¨æ˜¯ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œå¦‚æœæ˜¯bytesï¼Œéœ€è¦è½¬æ¢ä¸º string ç±»å‹
            concatString = string.concat(
                welcome,
                name_,
                string(bs)
            );
        }
}
</code></pre></div><p>å¦‚æœä½ ä¸ä½¿ç”¨å‚æ•°è°ƒç”¨ <code>string.concat</code> æˆ– <code>bytes.concat</code> å°†è¿”å›ç©ºæ•°ç»„ã€‚</p> <p>æ¨èäº†è§£ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// è¿™æ˜¯ä¸€ç§ string.concat æ–¹æ³•çš„å®ç°
function strConcat(string memory _a, string memory _b)
    internal
    pure
    returns (string memory)
{
    bytes memory _ba = bytes(_a);
    bytes memory _bb = bytes(_b);
    string memory ret = new string(_ba.length + _bb.length);
    bytes memory bret = bytes(ret);
    uint256 k = 0;
    for (uint256 i = 0; i &lt; _ba.length; i++) bret[k++] = _ba[i];
    for (uint256 i = 0; i &lt; _bb.length; i++) bret[k++] = _bb[i];
    return string(ret);
}
</code></pre></div><h4 id="â“¹-bytes-å’Œ-å­—ç¬¦ä¸²-ä¹‹é—´è½¬æ¢"><a href="#â“¹-bytes-å’Œ-å­—ç¬¦ä¸²-ä¹‹é—´è½¬æ¢" class="header-anchor">#</a> â“¹ bytes å’Œ å­—ç¬¦ä¸² ä¹‹é—´è½¬æ¢</h4> <p>è§ bytes ç« èŠ‚ä¸­çš„å†…å®¹ï¼Œè¿™é‡Œä¸å†é‡å¤ä»‹ç»ã€‚</p> <h4 id="â“º-æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰"><a href="#â“º-æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰" class="header-anchor">#</a> â“º æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰</h4> <p>æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²å€ŸåŠ© keccak256 æ¥ä½¿ç”¨:</p> <ul><li><code>keccak256(abi.encodePacked(s1)) == keccak256(abi.encodePacked(s2))</code></li> <li><code>keccak256(bytes(s1)) == keccak256(bytes(s2))</code> : æ›´æ¨èè¿™ä¸ªï¼Œçœ gas</li></ul> <p>æ³¨æ„ï¼šä¸Šé¢ <code>abi.encodePacked</code> çš„è¿”å›å€¼æ˜¯ <code>bytes</code> ç±»å‹ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    string public hello = &quot;Hello&quot;;

    // string è½¬æˆ bytes
    function test1() public view
        returns (bytes memory,bytes memory) {
        return (abi.encodePacked(hello),bytes(hello));
    }

    function test2(string calldata hello_) public view returns (bool) {
        // è¿™é‡Œåªè¦èƒ½å¤Ÿè½¬æ¢æˆ bytesçš„éƒ½å¯ä»¥ã€‚
        // æ›´å¤šæ–¹æ³•å¯ä»¥å‚è€ƒåé¢ä»‹ç»çš„ å…¨å±€ ABI ç¼–ç å‡½æ•°
        return
            keccak256(abi.encodePacked(hello)) ==
            keccak256(abi.encodePacked(hello_));
    }

    function test3(string calldata hello_) public view returns (bool) {
        return keccak256(bytes(hello)) == keccak256(bytes(hello_));
    }

}
</code></pre></div><p>å‡ ä¸ªå¸¸ç”¨çš„å…¨å±€ ABI ç¼–ç å‡½æ•°çš„ç®€å•ç”¨æ³•ä»‹ç»ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    string public hello = &quot;Hello Anbang&quot;;
    bytes public temp1 = abi.encodePacked(hello);
    bytes public temp2 = abi.encode(hello);

    bytes public temp3 = abi.encodeWithSignature(hello);
    bytes public temp4 = abi.encodeWithSignature(&quot;Hello Anbang1&quot;);
}
</code></pre></div><p>å¦‚æœæ¯”è¾ƒå¤šä¸ªå‚æ•°çš„æ‹¼æ¥å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œè°¨æ…ä½¿ç”¨ <code>abi.encodePacked</code>äº†ï¼Œå› ä¸ºç´§å‹ç¼©æœºåˆ¶çš„é—®é¢˜ã€‚è¯¦ç»†å¯ä»¥åœ¨ <code>abi.encodePacked</code> ä¸­äº†è§£</p> <h3 id="_4-mapping-æ˜ å°„"><a href="#_4-mapping-æ˜ å°„" class="header-anchor">#</a> 4.mapping æ˜ å°„</h3> <p>mapping å¯ä»¥çœ‹ä½œä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œä¼šæ‰§è¡Œè™šæ‹ŸåŒ–åˆå§‹åŒ–ï¼Œä½¿æ‰€æœ‰å¯èƒ½çš„å€¼éƒ½æ˜¯è¯¥ç±»å‹çš„é»˜è®¤å€¼ã€‚å…¶å® mapping å¹¶ä¸æ˜¯ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œæ²¡æœ‰ key é›†åˆï¼Œä¹Ÿæ²¡æœ‰ value é›†åˆï¼Œæ‰€ä»¥ mapping æ²¡åŠæ³•éå†/è¿­ä»£ã€‚</p> <p>æ•°ç»„ä¸­æ‰¾æŸä¸€ä¸ªå€¼ï¼Œéœ€è¦å¾ªç¯éå†ï¼Œè¿™æ˜¯å¾ˆæ¶ˆè€— Gas çš„ï¼Œè€Œä½¿ç”¨ mapping å°±å¯ä»¥å¾ˆå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ˜ å°„å¯ä»¥å¾ˆæ–¹ä¾¿çš„è·å–æŸä¸ªå€¼ã€‚æ˜ å°„å¹¶æ²¡æœ‰åšè¿­ä»£çš„æ–¹æ³•ã€‚</p> <ul><li>æ˜ å°„å£°æ˜</li> <li>æ˜ å°„çš„è®¾ç½®ï¼Œè·å–ï¼Œåˆ é™¤</li></ul> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-22"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-22" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=35" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 7 èŠ‚å¼•ç”¨ç±»å‹: mapping æ˜ å°„</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=bNc2nJX4cT0&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=35" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 7 èŠ‚å¼•ç”¨ç±»å‹: mapping æ˜ å°„</a></li></ul> <h4 id="â“µ-æœ¬èŠ‚é‡ç‚¹"><a href="#â“µ-æœ¬èŠ‚é‡ç‚¹" class="header-anchor">#</a> â“µ æœ¬èŠ‚é‡ç‚¹</h4> <p>å£°æ˜æ˜ å°„ç±»å‹çš„è¯­æ³•ï¼š<code>mapping(_KeyType =&gt; _ValueType)</code></p> <ul><li><code>_KeyType</code>ï¼šå¯ä»¥æ˜¯ä»»ä½•å†…ç½®ç±»å‹ï¼Œæˆ–è€… bytes å’Œ å­—ç¬¦ä¸²ã€‚
<ul><li>é”®æ˜¯å”¯ä¸€çš„ï¼Œå…¶èµ‹å€¼æ–¹å¼ä¸ºï¼š<code>map[a]=test</code>; æ„æ€æ˜¯é”®ä¸º a,å€¼ä¸º testï¼›ã€‚</li></ul></li> <li><code>_ValueType</code>ï¼š å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ä¹Ÿå¯ä»¥ã€‚</li> <li>mapping æ”¯æŒåµŒå¥—ã€‚</li> <li>æ˜ å°„çš„æ•°æ®ä½ç½®(data location)åªèƒ½æ˜¯ <code>storage</code>ï¼Œé€šå¸¸ç”¨äºçŠ¶æ€å˜é‡ã€‚</li> <li><code>mapping</code> ä¸èƒ½ç”¨äº <code>public</code> å‡½æ•°çš„å‚æ•°æˆ–è¿”å›ç»“æœ
<ul><li>æ˜ å°„åªèƒ½æ˜¯ storage çš„æ•°æ®ä½ç½®ï¼Œå› æ­¤åªå…è®¸ä½œä¸ºçŠ¶æ€å˜é‡ æˆ– ä½œä¸ºå‡½æ•°å†…çš„ storage å¼•ç”¨ æˆ– ä½œä¸ºåº“å‡½æ•°çš„å‚æ•°ã€‚å®ƒä»¬ä¸èƒ½ç”¨åˆçº¦å…¬æœ‰å‡½æ•°çš„å‚æ•°æˆ–è¿”å›å€¼ã€‚</li> <li>è¿™äº›é™åˆ¶åŒæ ·é€‚ç”¨äºåŒ…å«æ˜ å°„çš„æ•°ç»„å’Œç»“æ„ä½“ã€‚</li></ul></li> <li>æ˜ å°„å¯ä»¥æ ‡è®°ä¸º <code>public</code>ï¼ŒSolidity è‡ªåŠ¨ä¸ºå®ƒåˆ›å»º getter å‡½æ•°ã€‚
<ul><li><code>_KeyType</code> å°†æˆä¸º <code>getter</code> çš„å¿…é¡»å‚æ•°ï¼Œå¹¶ä¸” getter ä¼šè¿”å› <code>_ValueType</code>ã€‚</li> <li>å¦‚æœ <code>ValueType</code> æ˜¯ä¸€ä¸ªæ˜ å°„ã€‚è¿™æ—¶åœ¨ä½¿ç”¨ <code>getter</code> æ—¶å°†éœ€è¦é€’å½’åœ°ä¼ å…¥æ¯ä¸ª <code>KeyType</code> å‚æ•°ï¼Œ</li></ul></li></ul> <p>é—®ç­”é¢˜ï¼šä¸ºä»€ä¹ˆæ˜ å°„ä¸èƒ½åƒå“ˆå¸Œè¡¨ä¸€æ ·éå†ï¼Ÿ</p> <p>æ˜ å°„ä¸å“ˆå¸Œè¡¨ä¸åŒçš„åœ°æ–¹ï¼š<strong>åœ¨æ˜ å°„ä¸­,å¹¶ä¸å­˜å‚¨ keyï¼Œè€Œæ˜¯å­˜å‚¨å®ƒçš„ <code>keccak256</code> å“ˆå¸Œå€¼ï¼Œä»è€Œä¾¿äºæŸ¥è¯¢å®é™…çš„å€¼</strong>ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œæ˜ å°„æ˜¯æ²¡æœ‰é•¿åº¦çš„ï¼Œä¹Ÿæ²¡æœ‰ <code>key çš„é›†åˆ</code>æˆ– <code>value çš„é›†åˆ</code>çš„æ¦‚å¿µã€‚æ˜ å°„åªèƒ½æ˜¯å­˜å‚¨çš„æ•°æ®ä½ç½®ï¼Œå› æ­¤åªå…è®¸ä½œä¸ºçŠ¶æ€å˜é‡æˆ–ä½œä¸ºå‡½æ•°å†…çš„å­˜å‚¨å¼•ç”¨ æˆ– ä½œä¸ºåº“å‡½æ•°çš„å‚æ•°ã€‚</p> <h4 id="â“¶-åˆ›å»ºæ ¼å¼"><a href="#â“¶-åˆ›å»ºæ ¼å¼" class="header-anchor">#</a> â“¶ åˆ›å»ºæ ¼å¼</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Mapping {
    // æ™®é€š
    mapping(address =&gt; uint256) public balances;

    // åµŒå¥—
    mapping(address =&gt; mapping(address =&gt; bool)) public friends;
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// ä¸èƒ½åƒ array ä¸€æ ·è¿”å›æ‰€æœ‰
contract Demo {
    mapping(address =&gt; uint256) public balances;

    function getAllBalance() public view
        returns(mapping(address =&gt; uint256) memory){
        return balances;
    }

}
</code></pre></div><h4 id="â“·-å¦‚ä½•è·å–-è®¾ç½®-åˆ é™¤"><a href="#â“·-å¦‚ä½•è·å–-è®¾ç½®-åˆ é™¤" class="header-anchor">#</a> â“· å¦‚ä½•è·å–-è®¾ç½®-åˆ é™¤</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Mapping {
    // æ™®é€š
    mapping(address =&gt; uint256) public balances;

    // åµŒå¥—
    mapping(address =&gt; mapping(address =&gt; bool)) public friends;

    constructor() {
        balances[msg.sender] = 100;
    }

    function blanceGet() external view returns (uint256) {
        // è·å–
        return balances[msg.sender];
    }

    function blanceSet(uint256 amount) external {
        // è®¾ç½®
        balances[msg.sender] += amount;
    }

    function blanceDelete() external {
        // åˆ é™¤
        delete balances[msg.sender];
    }

    function friendGet() external view returns (bool) {
        // è·å–
        return friends[msg.sender][address(0)];
    }

    function friendSet() external {
        // è®¾ç½®
        friends[msg.sender][address(0)] = true;
    }

    function friendDelete() external {
        // åˆ é™¤
        delete friends[msg.sender][address(0)];
        // delete friends[msg.sender];
    }
}
</code></pre></div><h4 id="â“¸-ä½œä¸ºå±€éƒ¨å˜é‡çš„ä½¿ç”¨"><a href="#â“¸-ä½œä¸ºå±€éƒ¨å˜é‡çš„ä½¿ç”¨" class="header-anchor">#</a> â“¸ ä½œä¸ºå±€éƒ¨å˜é‡çš„ä½¿ç”¨</h4> <p><code>mapping</code> ç±»å‹å¯ä»¥ç”¨åšå±€éƒ¨å˜é‡ï¼Œä½†åªèƒ½å¼•ç”¨çŠ¶æ€å˜é‡ï¼Œè€Œä¸”å­˜å‚¨ä½ç½®ä¸º storageã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// ä½œä¸ºå±€éƒ¨å˜é‡çš„ä½¿ç”¨
contract Demo {
    // æ™®é€š mapping
    mapping(address =&gt; uint256) public balances; // æ™®é€šmapping

    // storage: æ”¹å˜å†…éƒ¨ refï¼Œä¼šå½±å“ balances çš„å€¼
    // ä¸èƒ½å£°æ˜ä¸º memory
    function updataBalance() public returns(uint256){
        // mapping(address=&gt;uint256) memory ref = balances; // âŒ
        mapping(address=&gt;uint256) storage ref = balances;
        ref[msg.sender] += 3;
        return ref[msg.sender];
    }

}
</code></pre></div><h4 id="â“¹-åœ¨-erc20-token-ä¸­çš„ç”¨æ³•"><a href="#â“¹-åœ¨-erc20-token-ä¸­çš„ç”¨æ³•" class="header-anchor">#</a> â“¹ åœ¨ ERC20 token ä¸­çš„ç”¨æ³•</h4> <p>ä¸‹é¢çš„ä¾‹å­æ˜¯ã€€ ERC20 token ã€€çš„ç®€å•ç‰ˆæœ¬ï¼ <code>_allowances</code> æ˜¯ä¸€ä¸ªåµŒå¥— mapping çš„ä¾‹å­ï¼ <code>_allowances</code> ç”¨æ¥è®°å½•å…¶ä»–çš„è´¦å·ï¼Œå¯ä»¥å…è®¸ä»å…¶è´¦å·ä½¿ç”¨å¤šå°‘æ•°é‡çš„å¸ï¼</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// mapping åœ¨ ERC20 token ä¸­çš„ç”¨æ³•
contract MappingExample {
    // ä½™é¢
    mapping(address =&gt; uint256) private _balances;
    // æˆæƒ:
    // æˆæƒäºº - ä»£ç†äºº - æˆæƒé‡‘é¢
    mapping(address =&gt; mapping(address =&gt; uint256)) private _allowances;

    event Transfer(address indexed from, address indexed to, uint256 value);
    event Approval(
        address indexed owner,
        address indexed spender,
        uint256 value
    );

    // è·å–ï¼šæˆæƒé‡‘é¢
    function allowance(address owner, address spender)
        public
        view
        returns (uint256)
    {
        return _allowances[owner][spender];
    }

    // æ£€æŸ¥ï¼šæˆæƒé‡‘é¢å¤§äºç­‰äºéœ€è¦æ“ä½œçš„é‡‘é¢
    function transferFrom(
        address sender,
        address recipient,
        uint256 amount
    ) public returns (bool) {
        require(
            _allowances[sender][msg.sender] &gt;= amount,
            &quot;ERC20: Allowance not high enough.&quot;
        );
        _allowances[sender][msg.sender] -= amount; // è®¾ç½®é¢åº¦
        _transfer(sender, recipient, amount);
        return true;
    }
    // è®¾ç½®ï¼š
    function approve(address spender, uint256 amount) public returns (bool) {
        require(spender != address(0), &quot;ERC20: approve to the zero address&quot;);

        _allowances[msg.sender][spender] = amount;
        emit Approval(msg.sender, spender, amount);
        return true;
    }

    function _transfer(
        address sender,
        address recipient,
        uint256 amount
    ) internal {
        require(sender != address(0), &quot;ERC20: transfer from the zero address&quot;);
        require(recipient != address(0), &quot;ERC20: transfer to the zero address&quot;);
        require(_balances[sender] &gt;= amount, &quot;ERC20: Not enough funds.&quot;);

        _balances[sender] -= amount;
        _balances[recipient] += amount;
        emit Transfer(sender, recipient, amount);
    }
}
</code></pre></div><h4 id="â“º-å¯è¿­ä»£æ˜ å°„"><a href="#â“º-å¯è¿­ä»£æ˜ å°„" class="header-anchor">#</a> â“º å¯è¿­ä»£æ˜ å°„</h4> <p>éå†æ‰€æœ‰ Mapping å†…çš„æ•°æ®ï¼Œï¼ˆMapping é…åˆ array ï¼‰</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    mapping(address =&gt; uint256) public balances;
    // ç”¨äºæ£€æŸ¥:åœ°å€æ˜¯å¦å·²ç»å­˜åœ¨äº balancesKey
    mapping(address =&gt; bool) public balancesInserted;
    address[] public balancesKey; // æ‰€æœ‰åœ°å€

    // è®¾ç½®
    function set(address ads_,uint256 amount_) external{
        balances[ads_] = amount_;
        // 1.æ£€æŸ¥
        if(!balancesInserted[ads_]){
            // 2.ä¿®æ”¹æ£€æŸ¥æ¡ä»¶
            balancesInserted[ads_] = true;
            // 3.æ­£åœ¨çš„æ“ä½œ
            balancesKey.push(ads_);
        }
    }
    // è·å–
    function get(uint256 index_) external view returns(uint256){
        require(index_&lt;balancesKey.length,&quot;index_ error&quot;);
        return balances[balancesKey[index_]];
    }
    // è·å–æ‰€æœ‰
    function totalAddress() external view returns(uint256){
        return balancesKey.length;
    }

    // è·å–ç¬¬ä¸€ä¸ªå€¼
    function first() external view returns(uint256){
        return balances[balancesKey[0]];
    }
    // æœ€åä¸€ä¸ªå€¼
    function latest() external view returns(uint256){
        return balances[balancesKey[balancesKey.length-1]];
    }
}
</code></pre></div><ul><li><p>æ›´å®Œå–„çš„å®ç°: https://github.com/ethereum/dapp-bin/blob/master/library/iterable_mapping.sol</p></li> <li><p>æ›´æ–°çš„å®ç°: https://learnblockchain.cn/docs/solidity/types.html#iterable-mappings</p></li></ul> <h3 id="_5-struct-ç»“æ„ä½“"><a href="#_5-struct-ç»“æ„ä½“" class="header-anchor">#</a> 5.struct ç»“æ„ä½“</h3> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-23"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-23" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=36" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 7 èŠ‚å¼•ç”¨ç±»å‹: struct ç»“æ„ä½“</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=US5_yCXw1kE&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=36" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 7 èŠ‚å¼•ç”¨ç±»å‹: struct ç»“æ„ä½“</a></li></ul> <h4 id="â“µ-åˆ›å»ºè¯­æ³•"><a href="#â“µ-åˆ›å»ºè¯­æ³•" class="header-anchor">#</a> â“µ åˆ›å»ºè¯­æ³•</h4> <p>è¦å®šä¹‰ç»“æ„ä½“ï¼Œä½¿ç”¨ <code>struct</code> å…³é”®å­—ã€‚<code>struct</code> å…³é”®å­—å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æ•°æ®ç±»å‹ï¼ŒåŒ…å«å¤šä¸ªæˆå‘˜ã€‚ç»“æ„ä½“æ˜¯å¯ä»¥å°†å¤šä¸ªå˜é‡è¿›è¡Œç¼–ç»„çš„è‡ªå®šä¹‰ç±»å‹</p> <p>struct è¯­å¥çš„æ ¼å¼å¦‚ä¸‹</p> <div class="language- extra-class"><pre class="language-text"><code>struct StructName {
   type1 typeName1;
   type2 typeName2;
   type3 typeName3;
}
</code></pre></div><p>ä¾‹å­:</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    struct Book {
        string title;
        string author;
        uint256 book_id;
    }
    Book public book = Book(&quot;Solidity&quot;, &quot;Anbang&quot;, 1);
}
</code></pre></div><h4 id="â“¶-ä¸‰ç§åˆ›å»ºæ–¹æ³•"><a href="#â“¶-ä¸‰ç§åˆ›å»ºæ–¹æ³•" class="header-anchor">#</a> â“¶ ä¸‰ç§åˆ›å»ºæ–¹æ³•</h4> <p>åŸºç¡€æ–¹å¼ï¼š<code>Test t = Test(1,2);</code></p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Structs {
    struct Book {
        string title;
        string author;
        uint256 book_id;
    }

    uint256 private bookId;
    Book[] public bookcase; // ä¹¦æŸœ:æ•°ç»„ç±»å‹

    function setA1Bookcase() external {
        // ç¬¬1ç§ç”Ÿæˆæ–¹æ³•ï¼šé¡ºåºä¸€å®šè¦å’Œç»“æ„ä¸€è‡´
        Book memory temp = Book(
            unicode&quot;Solidity é«˜çº§ç¨‹åºè®¾è®¡&quot;,
            &quot;Anbang&quot;,
            ++bookId
        );
        bookcase.push(temp);
    }

    // âœ… æœ€ä¼˜æ–¹æ¡ˆï¼Œæ¨è: å…ˆå†™å…¥å†…å­˜ï¼Œç„¶åpush
    function setB1Bookcase() external {
        // ç¬¬ 2 ç§ç”Ÿæˆ
        Book memory temp = Book({
            title: unicode&quot;Solidity é«˜çº§ç¨‹åºè®¾è®¡&quot;,
            author: &quot;Anbang&quot;,
            book_id: ++bookId
        });
        bookcase.push(temp);
    }

    function setB2Bookcase() external {
        // ç¬¬ 2 ç§ç”Ÿæˆ: ç›´æ¥ pushï¼Œæ— å˜é‡
        bookcase.push(
            Book({
                title: unicode&quot;Solidity é«˜çº§ç¨‹åºè®¾è®¡&quot;,
                author: &quot;Anbang&quot;,
                book_id: ++bookId
            })
        );
    }

    function setC1Bookcase() external {
        // ç¬¬ 3 ç§ç”Ÿæˆ: æ¨è
        Book memory temp;
        temp.title = unicode&quot;Solidity é«˜çº§ç¨‹åºè®¾è®¡&quot;;
        temp.author = &quot;Anbang&quot;;
        temp.book_id = ++bookId;
        bookcase.push(temp);
    }
}
</code></pre></div><p>æ€»ç»“ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// ç¬¬ 1 ç§ç”Ÿæˆ
Book memory solidity1 = Book(unicode&quot;Solidity é«˜çº§ç¨‹åºè®¾è®¡&quot;, &quot;Anbang&quot;, ++bookId);

// ç¬¬ 2 ç§ç”Ÿæˆ
Book memory solidity2 = Book({
    title: unicode&quot;Solidity é«˜çº§ç¨‹åºè®¾è®¡&quot;,
    author: &quot;Anbang&quot;,
    book_id: ++bookId,
});

// ç¬¬ 3 ç§ç”Ÿæˆ
Book memory temp;
temp.title = unicode&quot;Solidity é«˜çº§ç¨‹åºè®¾è®¡&quot;;
temp.author = &quot;Anbang&quot;;
temp.book_id = ++bookId;
</code></pre></div><h4 id="â“·-è¯»å–"><a href="#â“·-è¯»å–" class="header-anchor">#</a> â“· è¯»å–</h4> <p>å‡½æ•°å†…ä»…è¯»å–ç»“æ„ä½“ï¼Œä½¿ç”¨ memory å’Œ storage åŒºåˆ«:</p> <ol><li>å‡½æ•°å†…è¯»å–å¹¶è¿”å›,å¦‚æœä½¿ç”¨ memory å˜é‡æ¥æ”¶:
<ol><li>ä»çŠ¶æ€å˜é‡æ‹·è´åˆ°å†…å­˜ä¸­ï¼Œç„¶åå†…å­˜ä¸­çš„å˜é‡æ‹·è´åˆ°è¿”å›å€¼ã€‚ä¸¤æ¬¡æ‹·è´ï¼Œæ¶ˆè€— gas å¤š</li> <li><code>Book memory _book = book;</code></li></ol></li> <li>å‡½æ•°å†…è¯»å–å¹¶è¿”å›ï¼Œå¦‚æœä½¿ç”¨ storage å˜é‡æ¥æ”¶:
<ol><li>ç›´æ¥ä»çŠ¶æ€å˜é‡è¯»å–ï¼ŒçŠ¶æ€å˜é‡æ‹·è´åˆ°è¿”å›å€¼ã€‚1 æ¬¡æ‹·è´ï¼Œæ¶ˆè€— gas å°</li></ol></li> <li>æ€»ç»“: è¯»å–æ—¶å€™æ¨èä½¿ç”¨ <code>storage</code></li></ol> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// è¯»å–
contract Demo {
    struct Book {
        string title;
        string author;
        uint256 book_id;
    }
    Book public book = Book(&quot;Solidity&quot;, &quot;Anbang&quot;, 1);

    // memory  30029 gas
    // å‡½æ•°å†…è¯»å–å¹¶è¿”å›ï¼šä½¿ç”¨ memory å˜é‡æ¥æ”¶
    //  ä¸¤æ¬¡æ‹·è´ï¼Œæ‰€ä»¥æ¶ˆè€—çš„ gas å¤š
    function get1() external view
        returns(
            string memory,
            string memory,
            uint256
        )
    {
         // ä»çŠ¶æ€å˜é‡æ‹·è´åˆ°å†…å­˜ä¸­
        Book memory _book = book;
        // å†…å­˜ä¸­çš„å˜é‡æ‹·è´åˆ°è¿”å›å€¼ï¼›2æ¬¡æ‹·è´
        return (_book.title,_book.author,_book.book_id);
    }

    // storage 29983 gas
    // å‡½æ•°å†…è¯»å–å¹¶è¿”å›ï¼šä½¿ç”¨ storage å˜é‡æ¥æ”¶
    function get2() external view
        returns(
            string memory,
            string memory,
            uint256
        )
    {
        // ä»çŠ¶æ€å˜é‡è¯»å–ï¼Œæ²¡æœ‰æ‹·è´çš„è¡Œä¸º
        Book storage _book = book;

        // çŠ¶æ€å˜é‡æ‹·è´åˆ°è¿”å›å€¼ã€‚1æ¬¡æ‹·è´
        return (_book.title,_book.author,_book.book_id);
    }

}
</code></pre></div><h4 id="â“¸-ä¿®æ”¹"><a href="#â“¸-ä¿®æ”¹" class="header-anchor">#</a> â“¸ ä¿®æ”¹</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// ä¿®æ”¹
contract Demo {
    struct Book {
        string title;
        string author;
        uint256 book_id;
    }
    Book public book = Book(&quot;Solidity&quot;, &quot;Anbang&quot;, 1);

    function modi() external {
        book.title = &quot;Solidity 666&quot;;
    }
}
</code></pre></div><p>å‡½æ•°å†…è¯»å–æ—¶ï¼Œæ ‡è®° <code>memory</code> / <code>storage</code>,ä¼šäº§ç”Ÿå®Œå…¨ä¸åŒçš„ç»“æœï¼›</p> <p>ç‰¹åˆ«æ³¨æ„ï¼š<strong>å¦‚æœç»“æ„ä½“å†…åŒ…å« <code>mapping</code> ç±»å‹ï¼Œåˆ™å¿…é¡»ä½¿ç”¨ <code>storage</code>ï¼Œä¸å¯ä»¥ä½¿ç”¨ memeory.</strong>ï¼Œå¦åˆ™æŠ¥é”™ <code>Type struct ContractName.StructName memory is only valid in storage because it contains a (nested) mapping.</code></p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    struct Book {
        string title;
        string author;
        uint256 book_id;
    }
    Book public book = Book(&quot;Solidity&quot;, &quot;Anbang&quot;, 1);

    // view
    function test1() external view {
        Book memory bookLocal = book;
        bookLocal.author = &quot;Anbang666&quot;;
    }
    // ä¸èƒ½ç”¨viewï¼šå› ä¸ºå†™çŠ¶æ€å˜é‡äº†
    function test2() external {
        Book storage bookLocal = book;
        bookLocal.author = &quot;Anbang777&quot;;
    }
}
</code></pre></div><p>å‡½æ•°å†…è·å–å¹¶ä¿®æ”¹ç»“æ„ä½“ï¼š</p> <ul><li>å› ä¸ºè¦ä¿®æ”¹çŠ¶æ€å˜é‡ï¼Œæ‰€ä»¥ä½¿ç”¨ storage</li> <li>å‡½æ•°å†…ç›´æ¥ä¿®æ”¹å˜é‡; åœ¨ä¿®æ”¹ä¸€ä¸ªå±æ€§æ—¶æ¯”è¾ƒçœ Gas è´¹ç”¨</li> <li>å‡½æ•°å†…å…ˆè·å–å­˜å‚¨åˆ° storage å†ä¿®æ”¹:ä¿®æ”¹å¤šä¸ªå±æ€§çš„æ—¶å€™æ¯”è¾ƒçœ Gas è´¹ç”¨</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Structs {
    struct Book {
        string title;
        string author;
        uint256 book_id;
    }
    uint256 private bookId;
    Book public book1; // Bookç±»å‹
    Book public book2; // Bookç±»å‹

    mapping(address =&gt; Book) public students; // mapping ç±»å‹

    // è®¾ç½® book1
    function setBook1() external {
        Book memory temp;
        temp.title = unicode&quot;Solidity é«˜çº§ç¨‹åºè®¾è®¡&quot;;
        temp.author = &quot;Anbang&quot;;
        temp.book_id = ++bookId;
        book1 = temp;
    }

    // è®¾ç½® book2
    // âœ… æœ€ä¼˜æ–¹æ¡ˆï¼Œæ¨è:ç›´æ¥ä¿®æ”¹
    function setBook2() external {
        book2.title = unicode&quot;Solidity é«˜çº§ç¨‹åºè®¾è®¡&quot;;
        book2.author = &quot;Anbang&quot;;
        book2.book_id = ++bookId;
    }

    // âœ… æœ€ä¼˜æ–¹æ¡ˆï¼Œæ¨è:ç›´æ¥ä¿®æ”¹
    function set1Student() external {
        Book storage temp = students[msg.sender];
        temp.title = unicode&quot;Solidity é«˜çº§ç¨‹åºè®¾è®¡&quot;;
        temp.author = &quot;Anbang&quot;;
        temp.book_id = ++bookId;
    }

    function set2Student() external {
        Book memory temp;
        temp.title = unicode&quot;Solidity é«˜çº§ç¨‹åºè®¾è®¡&quot;;
        temp.author = &quot;Anbang&quot;;
        temp.book_id = ++bookId;
        students[msg.sender] = temp;
    }
}
</code></pre></div><h4 id="â“¹-åˆ é™¤"><a href="#â“¹-åˆ é™¤" class="header-anchor">#</a> â“¹ åˆ é™¤</h4> <p>åˆ é™¤ç»“æ„ä½“çš„å˜é‡ï¼Œä»…ä»…æ˜¯é‡ç½®æ•°æ®ï¼Œå¹¶ä¸æ˜¯å®Œå…¨çš„åˆ é™¤ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    struct Book {
        string title;
        string author;
        uint256 book_id;
    }
    Book public book = Book(&quot;Solidity&quot;, &quot;Anbang&quot;, 1);

    function del() external
    {
        delete book;
    }
}
</code></pre></div><h2 id="_8ï¸âƒ£-ç±»å‹è½¬æ¢"><a href="#_8ï¸âƒ£-ç±»å‹è½¬æ¢" class="header-anchor">#</a> 8ï¸âƒ£ ç±»å‹è½¬æ¢</h2> <p>Solidity å…è®¸ç±»å‹ä¹‹é—´è¿›è¡Œéšå¼è½¬æ¢å’Œæ˜¾å¼è½¬æ¢ã€‚</p> <p><strong>å‰æ–‡å›é¡¾</strong>: <code>bytes1</code> å¯¹åº” <code>uint8</code>ï¼Œå¯¹åº”ä¸¤ä½è¿ç»­çš„åå…­è¿›åˆ¶æ•°å­— <code>0xXX</code>ã€‚</p> <h3 id="æœ¬èŠ‚é…å¥—è§†é¢‘-24"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-24" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h3> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=37" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 8 èŠ‚: ç±»å‹è½¬æ¢</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=uJ0DDcietlw&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=37" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 8 èŠ‚: ç±»å‹è½¬æ¢</a></li></ul> <h3 id="_1-éšå¼è½¬æ¢-2"><a href="#_1-éšå¼è½¬æ¢-2" class="header-anchor">#</a> 1.éšå¼è½¬æ¢</h3> <h4 id="â“µ-å‘ç”Ÿåœºæ™¯"><a href="#â“µ-å‘ç”Ÿåœºæ™¯" class="header-anchor">#</a> â“µ å‘ç”Ÿåœºæ™¯</h4> <p>åœ¨<strong>èµ‹å€¼</strong>, <strong>å‡½æ•°å‚æ•°ä¼ é€’</strong>ä»¥åŠåº”ç”¨è¿ç®—ç¬¦æ—¶ï¼Œä¼šå‘ç”Ÿéšå¼è½¬æ¢ã€‚</p> <h4 id="â“¶-è½¬æ¢çš„æ ‡å‡†"><a href="#â“¶-è½¬æ¢çš„æ ‡å‡†" class="header-anchor">#</a> â“¶ è½¬æ¢çš„æ ‡å‡†</h4> <ol><li>å€¼ç±»å‹</li> <li>æºç±»å‹å¿…é¡»æ˜¯ç›®æ ‡ç±»å‹çš„å­é›†ã€‚</li></ol> <p>ä¾‹å¦‚ï¼Œ<code>uint8</code> å¯ä»¥è½¬æ¢ä¸º <code>uint16</code>/<code>uint24</code>../<code>uint256</code>ï¼Œå› ä¸º<code>uint8</code>æ˜¯<code>uint16</code>è¿™äº›ç±»å‹çš„å­é›†ã€‚ä½†æ˜¯ <code>int8</code> ä¸å¯ä»¥è½¬æ¢ä¸º <code>uint256</code>ï¼Œå› ä¸º <code>int8</code> å¯ä»¥åŒ…å« <code>uint256</code> ä¸­ä¸å…è®¸çš„è´Ÿå€¼ï¼Œæ¯”å¦‚ <code>-1</code>ã€‚</p> <h4 id="â“·-ç›¸äº¤é›†åˆçš„ç±»å‹-ä¸èƒ½éšå¼è½¬æ¢ã€‚"><a href="#â“·-ç›¸äº¤é›†åˆçš„ç±»å‹-ä¸èƒ½éšå¼è½¬æ¢ã€‚" class="header-anchor">#</a> â“· ç›¸äº¤é›†åˆçš„ç±»å‹ï¼Œä¸èƒ½éšå¼è½¬æ¢ã€‚</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    int8 public a1 = 3;

    // Type int8 is not implicitly convertible to expected type uint16.
    // uint16 public a2 = a1;

    uint8 public b1 = 3;
    uint16 public b2 = b1;
}
</code></pre></div><h4 id="â“¸-æŠŠæ•´æ•°å­—é¢é‡èµ‹å€¼ç»™æ•´å‹æ—¶-ä¸èƒ½è¶…å‡ºèŒƒå›´è€Œå‘ç”Ÿæˆªæ–­-å¦åˆ™ä¼šæŠ¥é”™ã€‚"><a href="#â“¸-æŠŠæ•´æ•°å­—é¢é‡èµ‹å€¼ç»™æ•´å‹æ—¶-ä¸èƒ½è¶…å‡ºèŒƒå›´è€Œå‘ç”Ÿæˆªæ–­-å¦åˆ™ä¼šæŠ¥é”™ã€‚" class="header-anchor">#</a> â“¸ æŠŠæ•´æ•°å­—é¢é‡èµ‹å€¼ç»™æ•´å‹æ—¶ï¼Œä¸èƒ½è¶…å‡ºèŒƒå›´è€Œå‘ç”Ÿæˆªæ–­ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo1 {
    uint8 public a = 12; // no error
    uint32 public b = 1234; // no error
    uint16 public c = 0x01;

    // Type int_const 123456 is not implicitly convertible
    // to expected type uint8. Literal is too large to fit in uint8.
    // uint8 d = 123456;
}
</code></pre></div><h4 id="â“¹-å‡½æ•°å‚æ•°ä¼ é€’"><a href="#â“¹-å‡½æ•°å‚æ•°ä¼ é€’" class="header-anchor">#</a> â“¹ å‡½æ•°å‚æ•°ä¼ é€’</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// å‡½æ•°çš„ä¼ å‚
contract Demo {
    uint256 public a;

    function test1(uint256 u_) public {
        a = u_;
    }

    function test2() external {
        uint8 temp = 3;
        test1(temp); //
    }
}
</code></pre></div><p>æ•°ç»„ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// å‡½æ•°çš„ä¼ å‚
contract Demo {
    uint256 public a;

    function test1(uint256[3] memory u_) public {
        a = u_[0];
    }

    // ç¦æ­¢çš„ï¼š
    function test2() external {
        // function call. Invalid implicit conversion from uint8[3]
        // memory to uint256[3] memory requested.
        // test1([1,2,3]);
        test1([uint256(1),uint256(2),uint256(3)]);
    }
}
</code></pre></div><h4 id="â“º-è¿ç®—ç¬¦åº”ç”¨"><a href="#â“º-è¿ç®—ç¬¦åº”ç”¨" class="header-anchor">#</a> â“º è¿ç®—ç¬¦åº”ç”¨</h4> <p>åˆ™ç¼–è¯‘å™¨å°†å°è¯•å°†<strong>å…¶ä¸­ä¸€ä¸ªæ“ä½œæ•°</strong>éšå¼è½¬æ¢ä¸º<strong>å¦ä¸€ä¸ªæ“ä½œæ•°çš„ç±»å‹</strong>ï¼ˆèµ‹å€¼ä¹Ÿæ˜¯å¦‚æ­¤ï¼‰ã€‚ è¿™æ„å‘³ç€æ“ä½œå§‹ç»ˆä»¥æ“ä½œæ•°ä¹‹ä¸€çš„ç±»å‹æ‰§è¡Œã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// è¿ç®—ç¬¦
contract Demo {
    uint8 public  x = 1;
    uint16 public  y = 2;

    // uint8 + uint16 =&gt; uint16 + uint16 = uint16
    // uint16 =&gt; uint32
    uint32 public  z = x + y;
}
</code></pre></div><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼ŒåŠ æ³•çš„æ“ä½œæ•° x å’Œ y æ²¡æœ‰ç›¸åŒçš„ç±»å‹ï¼Œuint8 å¯ä»¥è¢«éšå¼è½¬æ¢ä¸º uint16ï¼Œç›¸åå´ä¸å¯ä»¥ã€‚ å› æ­¤åœ¨æ‰§è¡ŒåŠ æ³•ä¹‹å‰ï¼Œå°† uint8 è½¬æ¢ä¸º uint16 çš„ç±»å‹ï¼Œç»“æœç±»å‹æ˜¯ uint16ã€‚å› ä¸ºå®ƒè¢«èµ‹å€¼ç»™ uint32 ç±»å‹çš„å˜é‡ï¼Œåˆè¿›è¡Œäº†å¦ä¸€ä¸ªç±»ä¼¼é€»è¾‘çš„éšå¼è½¬æ¢.</p> <h3 id="_2-æ˜¾å¼è½¬æ¢"><a href="#_2-æ˜¾å¼è½¬æ¢" class="header-anchor">#</a> 2.æ˜¾å¼è½¬æ¢</h3> <p>å¯ä»¥ä½¿ç”¨ç±»å‹å…³é”®å­—ï¼Œæ˜¾å¼åœ°å°†æ•°æ®ç±»å‹è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    // uint8 =&gt; uint16
    uint8 public a1 = 3;
    uint16 public a2 = uint16(a1);

    int8 public b1 = 3;
    //Explicit type conversion not allowed from &quot;int8&quot; to &quot;uint256&quot;.
    // uint256 b2 = uint256(b1);
}
</code></pre></div><h4 id="â“µ-int-uint-æ•´å‹è½¬æ¢"><a href="#â“µ-int-uint-æ•´å‹è½¬æ¢" class="header-anchor">#</a> â“µ int/uint æ•´å‹è½¬æ¢</h4> <p>æ•´å‹åŠ å¤§æ•°æ®ä½ç½®æ˜¯ä»å·¦ä¾§å¢åŠ ï¼Œå‡å°æ•°æ®ä½ç½®ä¹Ÿæ˜¯ä»å·¦ä¾§ç§»é™¤ï¼›ï¼ˆ<strong>æ•´å‹æ˜¯å³å¯¹é½</strong>ï¼‰</p> <ul><li>æ•´å‹è½¬æ¢æˆæ›´å¤§çš„ç±»å‹ï¼Œä»å·¦ä¾§æ·»åŠ å¡«å……ä½ã€‚</li> <li>æ•´å‹è½¬æ¢æˆæ›´å°çš„ç±»å‹ï¼Œä¼šä¸¢å¤±å·¦ä¾§æ•°æ®ã€‚</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    // æ•´å‹è½¬æ¢æˆæ›´å¤§çš„ç±»å‹ï¼Œä»å·¦ä¾§æ·»åŠ å¡«å……ä½ã€‚
    // uint16 =&gt; uint32
    uint16 public a1 = 22136;       // ç­‰äº 0x5678
    uint32 public a2 = uint32(a1); // a2 = 22136

    // uint16 =&gt; uint8
    uint8 public a3 = uint8(a1); // b4 = 0x78
    uint8 public a4 = 0x78;

    // æ•´å‹è½¬æ¢æˆæ›´å°çš„ç±»å‹ï¼Œä¼šä¸¢å¤±å·¦ä¾§æ•°æ®ã€‚
    // uint32 =&gt; uint16
    uint32 public b1 = 0x12345678; // 0x12345678
    uint16 public b2 = uint16(b1); // 0x5678 | b2 = 22136
}
</code></pre></div><p><strong>æ•´æ•°æ˜¾å¼è½¬æ¢ä¸ºæ›´å¤§çš„ç±»å‹</strong></p> <div class="language- extra-class"><pre class="language-text"><code>uint16 a = 0x1234;
uint32 b = uint32(a); // b ä¸º 0x00001234 now
</code></pre></div><p><strong>æ•´æ•°æ˜¾å¼è½¬æ¢æˆæ›´å°çš„ç±»å‹</strong></p> <div class="language- extra-class"><pre class="language-text"><code>uint32 a = 0x12345678;
uint16 b = uint16(a); // æ­¤æ—¶ b çš„å€¼æ˜¯ 0x5678
</code></pre></div><h4 id="â“¶-bytes-å­—èŠ‚ç±»å‹è½¬æ¢"><a href="#â“¶-bytes-å­—èŠ‚ç±»å‹è½¬æ¢" class="header-anchor">#</a> â“¶ bytes å­—èŠ‚ç±»å‹è½¬æ¢</h4> <p>å­—èŠ‚åŠ å¤§æ•°æ®ä½ç½®æ˜¯ä»å³ä¾§å¢åŠ ï¼Œå‡å°æ•°æ®ä½ç½®ä¹Ÿæ˜¯ä»å³ä¾§ç§»é™¤ï¼›ï¼ˆ<strong>å­—èŠ‚æ˜¯å·¦å¯¹é½</strong>ï¼‰</p> <ul><li>å­—èŠ‚è½¬æ¢ä¸ºæ›´å¤§çš„ç±»å‹æ—¶ï¼Œä»å³ä¾§æ·»åŠ å¡«å……ä½ã€‚</li> <li>å­—èŠ‚è½¬æ¢åˆ°æ›´å°çš„ç±»å‹æ—¶ï¼Œä¸¢å¤±å³ä¾§æ•°æ®ã€‚</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    // å­—èŠ‚è½¬æ¢ä¸ºæ›´å¤§çš„ç±»å‹æ—¶ï¼Œä»å³ä¾§æ·»åŠ å¡«å……ä½ã€‚
    // bytes2 =&gt;bytes4
    bytes2 public a1 = 0x5678;
    bytes4 public a2 = bytes4(a1); // a2 = 0x56780000

    // å­—èŠ‚è½¬æ¢åˆ°æ›´å°çš„ç±»å‹æ—¶ï¼Œä¸¢å¤±å³ä¾§æ•°æ®ã€‚
    // bytes4 =&gt; bytes2
    bytes4 public b1 = 0x12345678;
    bytes2 public b2 = bytes2(b1); // b2 = 0x1234
}
</code></pre></div><p><strong>bytes æ˜¾å¼è½¬æ¢æˆæ›´å°çš„ç±»å‹</strong></p> <div class="language- extra-class"><pre class="language-text"><code>bytes2 a = 0x1234;
bytes1 b = bytes1(a); // b ä¸º 0x12
</code></pre></div><p><strong>bytes æ˜¾å¼è½¬æ¢æˆæ›´å¤§çš„ç±»å‹</strong></p> <div class="language- extra-class"><pre class="language-text"><code>bytes2 a = 0x1234;
bytes4 b = bytes4(a); // b ä¸º 0x12340000
</code></pre></div><h4 id="â“·-bytes-ä¸-uint-è½¬æ¢"><a href="#â“·-bytes-ä¸-uint-è½¬æ¢" class="header-anchor">#</a> â“· bytes ä¸ uint è½¬æ¢</h4> <p>åªæœ‰å½“å­—èŠ‚ç±»å‹å’Œæ•´æ•°ç±»å‹å¤§å°ç›¸åŒæ—¶ï¼Œæ‰å¯ä»¥è¿›è¡Œè½¬æ¢ã€‚</p> <p>å› ä¸ºæ•´æ•°å’Œå®šé•¿å­—èŠ‚æ•°ç»„åœ¨æˆªæ–­ï¼ˆæˆ–å¡«å……ï¼‰æ—¶è¡Œä¸ºæ˜¯ä¸åŒçš„ï¼Œå¦‚æœè¦åœ¨ä¸åŒçš„å¤§å°çš„æ•´æ•°å’Œå®šé•¿å­—èŠ‚æ•°ç»„ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼Œ<strong>å¿…é¡»ä½¿ç”¨ä¸€ä¸ªä¸­é—´ç±»å‹æ¥æ˜ç¡®è¿›è¡Œæ‰€éœ€æˆªæ–­å’Œå¡«å……çš„è§„åˆ™</strong></p> <div class="language- extra-class"><pre class="language-text"><code>bytes2 a = 0x1234;
uint32 b = uint16(a);           // b ä¸º 0x00001234
uint32 c = uint32(bytes4(a));   // c ä¸º 0x12340000

uint8  d = uint8(uint16(a));    // d ä¸º 0x34
uint8  e = uint8(bytes1(a));    // e ä¸º 0x12
</code></pre></div><p><strong>1.bytes è½¬æ¢æˆ uint</strong>: <strong>å…ˆè½¬ç±»å‹ï¼Œå†è½¬å¤§å°</strong></p> <ul><li>æ¨èå…ˆæŠŠ bytes æ˜¾ç¤ºè½¬æ¢æˆæ•°å­—ç±»å‹åï¼Œå†è½¬æ¢æˆæ›´å¤§æˆ–æ›´å°çš„æ•°å­—</li></ul> <div class="language-code-block:: solidity extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

// - `uint8`  ç­‰äºä¸¤ä½è¿ç»­çš„åå…­è¿›åˆ¶æ•°å­— `0xXX`
// - `bytes1` ç­‰äºä¸¤ä½è¿ç»­çš„åå…­è¿›åˆ¶æ•°å­— `0xXX`
// - `bytes1` ç­‰äº `uint8`
contract Demo1 {
    // bytes =&gt; uint
    bytes2 public a1 = 0x5678; // : åè¿›åˆ¶æ•°å­— = 22136
    bytes4 public a2 = bytes4(a1); // a2 = 0x56780000 : åè¿›åˆ¶æ•°å­— = 1450704896
    bytes1 public a3 = bytes1(a1); // a3 = 0x56 : åè¿›åˆ¶æ•°å­— = 86

    // -- å¢å¤§
    // bytes æ˜¾ç¤ºè½¬æ¢æˆæ•°å­—åï¼Œæ˜¾ç¤ºè½¬æ¢æ›´å¤§çš„æ•°å­— (è¿™é‡Œä¹Ÿå¯ä»¥éšå¼å®Œæˆ)
    uint32 public a4 = uint32(uint16(a1)); // âœ… a4 = 0x00005678 : åè¿›åˆ¶ = 22136
    // bytes æ˜¾ç¤ºè½¬æ¢æˆæ›´å¤§æ•°å­—å¯¹åº”çš„çš„bytesï¼Œç„¶åbytesæ˜¾ç¤ºè½¬æ¢æˆåŒ¹é…çš„æ•°å­—
    uint32 public a5 = uint32(bytes4(a1)); // âŒ a5 = 0x56780000 : åè¿›åˆ¶ = 1450704896

    // -- å‡å°
    // bytes æ˜¾ç¤ºè½¬æ¢æˆæ•°å­—åï¼Œæ˜¾ç¤ºè½¬æ¢æˆæ›´å°çš„æ•°å­—
    uint8 public a6 = uint8(uint16(a1)); // âœ… a6 = 0x78 : åè¿›åˆ¶ = 120
    // bytes æ˜¾ç¤ºè½¬æ¢æˆæ›´å°æ•°å­—å¯¹åº”çš„çš„bytesï¼Œç„¶åbytesæ˜¾ç¤ºè½¬æ¢æˆåŒ¹é…çš„æ•°å­—
    uint8 public a7 = uint8(bytes1(a1)); // âŒ a7 = 0x56 : åè¿›åˆ¶ = 86
}
</code></pre></div><p><strong>2.uint è½¬æ¢æˆ bytes</strong>: <strong>å…ˆè½¬å¤§å°ï¼Œå†è½¬ç±»å‹</strong></p> <ul><li>æ¨èå…ˆæŠŠ uint æ˜¾ç¤ºè½¬æ¢æˆæ›´å¤§ bytes å¯¹åº”çš„ uintï¼Œç„¶å uint å†æ˜¾ç¤ºè½¬æ¢æˆåŒ¹é…çš„ bytes</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo2 {
    // uint =&gt; bytes
    uint16 public b1 = 0x5678; // 0x5678 : åè¿›åˆ¶ = 22136
    uint32 public b2 = uint32(b1); // b2 = 0x00005678 : åè¿›åˆ¶ = 22136
    uint8 public b3 = uint8(b1); // b3 = 0x78 : åè¿›åˆ¶ = 120
    // -- å¢å¤§
    // uint æ˜¾ç¤ºè½¬æ¢æˆbytesç±»å‹åï¼Œå†æ˜¾ç¤ºè½¬æ¢æˆæ›´å¤§æˆ–æ›´å°çš„bytes
    bytes4 public b4 = bytes4(bytes2(b1)); // âŒ b4 = 0x56780000
    // uint æ˜¾ç¤ºè½¬æ¢æˆæ›´å¤§byteså¯¹åº”çš„uintï¼Œç„¶åuintå†æ˜¾ç¤ºè½¬æ¢æˆåŒ¹é…çš„bytes
    bytes4 public b5 = bytes4(uint32(b1)); //  âœ… b5 = 0x00005678

    // -- å‡å°
    // uint æ˜¾ç¤ºè½¬æ¢æˆbytesç±»å‹åï¼Œå†æ˜¾ç¤ºè½¬æ¢æˆæ›´å¤§æˆ–æ›´å°çš„bytes
    bytes1 public b6 = bytes1(bytes2(b1)); // âŒ b4 = 0x56
    // uint æ˜¾ç¤ºè½¬æ¢æˆæ›´å¤§byteså¯¹åº”çš„uintï¼Œç„¶åuintå†æ˜¾ç¤ºè½¬æ¢æˆåŒ¹é…çš„bytes
    bytes1 public b7 = bytes1(uint8(b1)); // âœ… b4 = 0x78
}
</code></pre></div><h4 id="â“¸-bytes-å’Œ-bytesn-ä¹‹é—´è½¬æ¢"><a href="#â“¸-bytes-å’Œ-bytesn-ä¹‹é—´è½¬æ¢" class="header-anchor">#</a> â“¸ bytes å’Œ bytesN ä¹‹é—´è½¬æ¢</h4> <p><code>bytes</code> æ•°ç»„å’Œ <code>bytes calldata</code> åˆ‡ç‰‡å¯ä»¥æ˜¾ç¤ºè½¬æ¢ä¸ºå›ºå®šé•¿åº¦çš„ bytes ç±»å‹(<code>bytes1...bytes32</code>).</p> <ul><li>å¦‚æœæ•°ç»„æ¯”å›ºå®šé•¿åº¦çš„ bytes ç±»å‹é•¿ï¼Œåˆ™åœ¨æœ«å°¾å¤„ä¼šå‘ç”Ÿæˆªæ–­ã€‚</li> <li>å¦‚æœæ•°ç»„æ¯”ç›®æ ‡ç±»å‹çŸ­ï¼Œå®ƒå°†åœ¨æœ«å°¾ç”¨é›¶å¡«å……ã€‚</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract C {
    // 0x6162636465666768
    bytes public bts = &quot;abcdefgh&quot;;
    bytes3 public b1 = bytes3(bts);
    bytes8 public b2 = bytes8(bts);
    bytes16 public b3 = bytes16(bts);
    bytes32 public b4 = bytes32(bts);
}
</code></pre></div><p><strong>è¡¥å……</strong>ï¼šä½¿ç”¨åˆ‡ç‰‡ä¹Ÿå¯ä»¥æŠŠæ•°æ®ä» bytes è½¬ä¸º bytesNã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract C {
    // 0x6162636465666768
    bytes public bts = &quot;abcdefgh&quot;;

    function f(bytes calldata bts_)
        public
        pure
        returns (bytes3,bytes16)
    {

        bytes3 b1 = bytes3(bts_);
        bytes16 b2 = bytes16(bts_[:8]);
        return (b1, b2);
    }
}
</code></pre></div><h4 id="â“¹-bytes-ä¸-address-è½¬æ¢"><a href="#â“¹-bytes-ä¸-address-è½¬æ¢" class="header-anchor">#</a> â“¹ bytes ä¸ address è½¬æ¢</h4> <p>address çš„æ ¼å¼æ˜¯ <code>0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926ac</code>ï¼Œæ˜¯ä¸€ä¸ª <strong>bytes20</strong> çš„æ•°æ®ã€‚</p> <p>åœ°å€æ˜¯å– <code>bytes32</code> æ•°æ®ä¸­çš„å 20 ä½ã€‚å¦‚æœæƒ³åˆ é™¤å‰é¢çš„ 12 ä½æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ solidity assembly (å†…è”æ±‡ç¼–) æ¥æˆªå–ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ© <code>uint</code> è½¬æ¢æˆæ›´å°çš„ç±»å‹ï¼Œä¼šä¸¢å¤±å·¦ä¾§æ•°æ®çš„ç‰¹æ€§æ¥å®Œæˆã€‚</p> <p>ä»£ç å¦‚ä¸‹:</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    // è·å–å³å°†éƒ¨ç½²çš„åœ°å€
    function getAddress(bytes memory bytecode, uint256 _salt)
        external
        view
        returns (address)
    {
        bytes32 hash = keccak256(
            abi.encodePacked(
                bytes1(0xff), // å›ºå®šå­—ç¬¦ä¸²
                address(this), // å½“å‰å·¥å‚åˆçº¦åœ°å€
                _salt, // salt
                keccak256(bytecode) //éƒ¨ç½²åˆçº¦çš„ bytecode
            )
        );
        // bytes è½¬æ¢æˆ uint: å…ˆè½¬ç±»å‹ï¼Œå†è½¬å¤§å°
        //      bytes32 =&gt; uint256 =&gt; uint160
        // uint160 è½¬ address
        //      uint160 =&gt; address
        return address(uint160(uint256(hash)));
    }
}
</code></pre></div><p>å‰æ–‡ä»‹ç»è¿‡ç¼–ç çš„æ–¹å¼: <code>keccak256(abi.encodePacked())</code>ï¼Œè¿”å›çš„æ˜¯ <code>bytes32</code> ç±»å‹ã€‚</p> <p>è¿™ä¸ªå°ä¾‹å­æ˜¯<strong>åˆçº¦éƒ¨ç½²åˆçº¦</strong>é‚£ç« èŠ‚ä¸­ create2 ä»£ç çš„ä¸€éƒ¨åˆ†ï¼Œç›¸å…³çš„æ›´å¤šæ¼”ç¤ºè¯·æŸ¥çœ‹ create2 åˆ›å»ºã€‚</p> <h3 id="_3-æ•°å­—è½¬æ¢æˆå­—ç¬¦ä¸²"><a href="#_3-æ•°å­—è½¬æ¢æˆå­—ç¬¦ä¸²" class="header-anchor">#</a> 3.æ•°å­—è½¬æ¢æˆå­—ç¬¦ä¸²</h3> <h4 id="æœ¬èŠ‚é…å¥—è§†é¢‘-25"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-25" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h4> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=38" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 8 èŠ‚: ç±»å‹è½¬æ¢ æ•°å­—è½¬æ¢æˆå­—ç¬¦ä¸²</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=BoiR3shgaic&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=38" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 8 èŠ‚: ç±»å‹è½¬æ¢ æ•°å­—è½¬æ¢æˆå­—ç¬¦ä¸²</a></li></ul> <h4 id="â“µ-ç›´æ¥å€ŸåŠ©-bytes-å’Œ-string-æœªå®Œæˆ"><a href="#â“µ-ç›´æ¥å€ŸåŠ©-bytes-å’Œ-string-æœªå®Œæˆ" class="header-anchor">#</a> â“µ ç›´æ¥å€ŸåŠ© bytes å’Œ stringï¼ˆæœªå®Œæˆï¼‰</h4> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    // `å›ºå®šå¤§å°å­—èŠ‚æ•°ç»„` â€”&gt; `åŠ¨æ€å¤§å°å­—èŠ‚æ•°ç»„` â€”&gt; `string`
    function test(uint8 num_) public pure returns (bytes1 ab,string memory data) {
        // å›ºå®šå¤§å°å­—èŠ‚æ•°ç»„
        ab = bytes1(num_);

        // `å›ºå®šå¤§å°å­—èŠ‚æ•°ç»„` â€”&gt; `åŠ¨æ€å¤§å°å­—èŠ‚æ•°ç»„`
        bytes memory temp = new bytes(ab.length); // å¯å˜å­—èŠ‚æ•°ç»„åˆ›å»ºæ–¹å¼
        for (uint8 i = 0; i &lt; ab.length; i++) {
            temp[i] = ab[i];
        }

        // `åŠ¨æ€å¤§å°å­—èŠ‚æ•°ç»„` â€”&gt; `string`
        data = string(temp);
    }
}
</code></pre></div><h4 id="â“¶-å€ŸåŠ©å•ä¸ªæ•°å­—è½¬æ¢-æ¨è"><a href="#â“¶-å€ŸåŠ©å•ä¸ªæ•°å­—è½¬æ¢-æ¨è" class="header-anchor">#</a> â“¶ å€ŸåŠ©å•ä¸ªæ•°å­—è½¬æ¢ï¼ˆæ¨èï¼‰</h4> <p>è¿™ç§æ–¹æ³•æ˜¯å€ŸåŠ©å°† 0-9 çš„æ•°å­—è¿›è¡Œè½¬æ¢ï¼Œç„¶åè¶…è¿‡åä½çš„æ•°å­—ï¼Œé€šè¿‡ <code>%</code> æ¥å¾—åˆ°ï¼Œå¹¶ä¸”æ‹¼æ¥åœ¨ä¸€èµ·ã€‚
æ¨èæ–¹æ³•ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    function uintToString(uint256 _uint)
        public
        pure
        returns (string memory str)
    {
        if (_uint == 0) return &quot;0&quot;;
        while (_uint != 0) {
            //å–æ¨¡
            uint256 remainder = _uint % 10;
            //æ¯å–ä¸€ä½å°±ç§»åŠ¨ä¸€ä½ï¼Œä¸ªä½ã€åä½ã€ç™¾ä½ã€åƒä½â€¦â€¦
            _uint = _uint / 10;
            //å°†å­—ç¬¦æ‹¼æ¥ï¼Œæ³¨æ„å­—ç¬¦ä½ç½®
            str =  string.concat(toStr(remainder), str);
        }
    }

    function toStr(uint256 num_) internal pure returns (string memory) {
        require(num_ &lt; 10,&quot;error&quot;);
        bytes memory alphabet = &quot;0123456789&quot;;
        bytes memory str = new bytes(1);
        str[0] = alphabet[num_];
        return string(str);
    }
}
</code></pre></div><p>ä¸Šé¢ä»£ç çš„ toStr åƒä¸‡ä¸è¦å†™ä¸‹é¢çš„è¿™ç§åƒåœ¾ä»£ç ï¼Œå†™ä¸‹é¢è¿™ç§åƒåœ¾æ˜¯å¯¹è‡ªå·±èŒä¸šçš„ä¸å°Šé‡ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    function toStr(uint8 step) external pure returns (string memory str) {
        string memory str;
        if (step == 0) {
            str = &quot;0&quot;;
        } else if (step == 1) {
            str = &quot;1&quot;;
        } else if (step == 2) {
            str = &quot;2&quot;;
        } else if (step == 3) {
            str = &quot;3&quot;;
        } else if (step == 4) {
            str = &quot;4&quot;;
        } else {
            str = &quot;?&quot;;
        }
    }
}
</code></pre></div><p>toStr çš„å¦å¤–ä¸€ç§å®ç°ï¼Œæ¨èäº†è§£ä¸€ä¸‹ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    //è¿™ä¸ªå‡½æ•°æœ€å…³é”®ï¼Œæ¯”è¾ƒå–å·§ï¼Œç”¨æ¥å°†uint256ç±»å‹çš„ 0-9 æ•°å­—è½¬æˆå­—ç¬¦
    function toStr2(uint256 value) public pure returns (string memory) {
        bytes memory alphabet = &quot;0123456789abcdef&quot;;
        //è¿™é‡ŒæŠŠæ•°å­—è½¬æˆäº†bytes32ç±»å‹ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬çŸ¥é“æ•°å­—æ˜¯ 0-9 ï¼Œæ‰€ä»¥å‰é¢å…¶å®éƒ½æ˜¯å¡«å……äº†0
        bytes memory data = abi.encodePacked(value);
        bytes memory str = new bytes(1);
        //æ‰€ä»¥æœ€åä¸€ä½æ‰æ˜¯çœŸæ­£çš„æ•°å­—
        uint256 i = data.length - 1;
        str[0] = alphabet[uint256(uint8(data[i] &amp; 0x0f))];
        return string(str);
    }
}
</code></pre></div><h2 id="_9ï¸âƒ£-å­—é¢å¸¸é‡ä¸åŸºæœ¬ç±»å‹çš„è½¬æ¢"><a href="#_9ï¸âƒ£-å­—é¢å¸¸é‡ä¸åŸºæœ¬ç±»å‹çš„è½¬æ¢" class="header-anchor">#</a> 9ï¸âƒ£ å­—é¢å¸¸é‡ä¸åŸºæœ¬ç±»å‹çš„è½¬æ¢</h2> <h3 id="æœ¬èŠ‚é…å¥—è§†é¢‘-26"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-26" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h3> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=39" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 9 èŠ‚: å­—é¢å¸¸é‡ä¸åŸºæœ¬ç±»å‹çš„è½¬æ¢</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=oRtB3wH5Z0I&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=39" target="_blank" rel="noreferrer">ç¬¬äºŒç« ç¬¬ 9 èŠ‚: å­—é¢å¸¸é‡ä¸åŸºæœ¬ç±»å‹çš„è½¬æ¢</a></li></ul> <h3 id="_1-åè¿›åˆ¶å’Œåå…­è¿›åˆ¶å­—é¢å¸¸é‡"><a href="#_1-åè¿›åˆ¶å’Œåå…­è¿›åˆ¶å­—é¢å¸¸é‡" class="header-anchor">#</a> 1.åè¿›åˆ¶å’Œåå…­è¿›åˆ¶å­—é¢å¸¸é‡</h3> <p>åè¿›åˆ¶å’Œåå…­è¿›åˆ¶å­—é¢å¸¸é‡å¯ä»¥éšå¼è½¬æ¢ä¸ºä»»ä½•è¶³ä»¥è¡¨ç¤ºå®ƒè€Œä¸ä¼šæˆªæ–­çš„æ•´æ•°ç±»å‹ï¼š</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token comment">// SPDX-License-Identifier: MIT</span>
<span class="token keyword">pragma</span> <span class="token keyword">solidity</span> <span class="token operator">^</span><span class="token version number">0.8.17</span><span class="token punctuation">;</span>

<span class="token keyword">contract</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
    <span class="token builtin">uint8</span> <span class="token keyword">public</span> a <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span> <span class="token comment">//  å¯è¡Œ</span>
    <span class="token builtin">uint32</span> <span class="token keyword">public</span> b <span class="token operator">=</span> <span class="token number">1234</span><span class="token punctuation">;</span> <span class="token comment">// å¯è¡Œ</span>
    <span class="token builtin">uint16</span> <span class="token keyword">public</span> c <span class="token operator">=</span> <span class="token number">0x01</span><span class="token punctuation">;</span>
    <span class="token comment">// uint16 d = 0x123456; // å¤±è´¥, ä¼šæˆªæ–­ä¸º 0x3456</span>
<span class="token punctuation">}</span>
</code></pre></div><p>âš ï¸ï¼šåœ¨ 0.8.0 ä¹‹å‰,ä»»ä½•åè¿›åˆ¶å’Œåå…­è¿›åˆ¶å¸¸é‡éƒ½å¯ä»¥æ˜¾ç¤ºè½¬åŒ–ä¸ºæ•´å‹ï¼Œä¸è¿‡ä» 0.8.0 å¼€å§‹ï¼Œåªæœ‰åœ¨åŒ¹é…æ•°æ®èŒƒå›´æ—¶ï¼Œæ‰èƒ½è¿›è¡Œè¿™ä¸ªè½¬æ¢ï¼Œå°±åƒéšå¼è½¬æ¢é‚£æ ·ã€‚</p> <h3 id="_2-æ•´å‹å­—é¢å¸¸é‡ä¸-bytesn"><a href="#_2-æ•´å‹å­—é¢å¸¸é‡ä¸-bytesn" class="header-anchor">#</a> 2.æ•´å‹å­—é¢å¸¸é‡ä¸ bytesN</h3> <ul><li>åè¿›åˆ¶å­—é¢å¸¸é‡ä¸èƒ½éšå¼è½¬æ¢ä¸ºå®šé•¿å­—èŠ‚æ•°ç»„ã€‚</li> <li>åå…­è¿›åˆ¶å­—é¢å¸¸é‡å¯ä»¥è½¬æ¢ä¸ºå®šé•¿å­—èŠ‚æ•°ç»„ï¼Œä½†ä»…å½“åå…­è¿›åˆ¶æ•°å­—å¤§å°å®Œå…¨ç¬¦åˆå®šé•¿å­—èŠ‚æ•°ç»„é•¿åº¦çš„æ—¶å€™ã€‚</li> <li>é›¶çš„<strong>åè¿›åˆ¶</strong>å’Œ<strong>åå…­è¿›åˆ¶å­—é¢å¸¸é‡</strong>éƒ½å¯ä»¥è½¬æ¢ä¸ºä»»ä½•å®šé•¿å­—èŠ‚æ•°ç»„ç±»å‹ï¼Œé›¶å€¼æ˜¯ä¾‹å¤–ï¼Œæ¯”è¾ƒç‰¹æ®Š</li></ul> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token comment">// SPDX-License-Identifier: MIT</span>
<span class="token keyword">pragma</span> <span class="token keyword">solidity</span> <span class="token operator">^</span><span class="token version number">0.8.17</span><span class="token punctuation">;</span>

<span class="token keyword">contract</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
    <span class="token comment">// åå…­è¿›åˆ¶</span>
    <span class="token builtin">bytes2</span> <span class="token keyword">public</span> a <span class="token operator">=</span> <span class="token number">0x1234</span><span class="token punctuation">;</span> <span class="token comment">// å¯è¡Œ</span>
    <span class="token builtin">bytes2</span> <span class="token keyword">public</span> b <span class="token operator">=</span> <span class="token number">0x0012</span><span class="token punctuation">;</span> <span class="token comment">// å¯è¡Œ</span>
    <span class="token comment">// bytes2 public c = 0x12; // 0x12ä¸å¯è¡Œ ,0x1200 å¯è¡Œï¼Œéœ€è¦å®Œå…¨ç¬¦åˆé•¿åº¦</span>

    <span class="token comment">// åè¿›åˆ¶</span>
    <span class="token comment">// bytes4 public x = 1; // ä¸å¯è¡Œ</span>
    <span class="token comment">// bytes2 public y = 2; // ä¸å¯è¡Œ</span>

    <span class="token comment">// 0 å’Œ 0x0</span>
    <span class="token builtin">bytes4</span> <span class="token keyword">public</span> d <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span> <span class="token comment">// å¯è¡Œ</span>
    <span class="token builtin">bytes4</span> <span class="token keyword">public</span> e <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// å¯è¡Œ</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-å­—ç¬¦ä¸²å­—é¢å¸¸é‡ä¸-bytesn"><a href="#_3-å­—ç¬¦ä¸²å­—é¢å¸¸é‡ä¸-bytesn" class="header-anchor">#</a> 3.å­—ç¬¦ä¸²å­—é¢å¸¸é‡ä¸ bytesN</h3> <p>å­—ç¬¦ä¸²å­—é¢å¸¸é‡å’Œåå…­è¿›åˆ¶å­—ç¬¦ä¸²å­—é¢å¸¸é‡å¯ä»¥éšå¼è½¬æ¢ä¸ºå®šé•¿å­—èŠ‚æ•°ç»„ï¼ˆéœ€è¦å®ƒä»¬çš„å­—ç¬¦æ•°ä¸å­—èŠ‚ç±»å‹çš„å¤§å°ç›¸åŒ¹é…ï¼‰</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    bytes2 public a = hex&quot;1234&quot;; // å¯è¡Œ
    bytes2 public b = hex&quot;12&quot;; // å¯è¡Œ
    bytes2 public c = &quot;xy&quot;; // å¯è¡Œ
    bytes2 public d = &quot;x&quot;; // å¯è¡Œ
    // bytes2 public e = hex&quot;123&quot;; // ä¸å¯è¡Œ
    // bytes2 public f = &quot;xyz&quot;; // ä¸å¯è¡Œ
}
</code></pre></div><h3 id="_4-åå…­è¿›åˆ¶å­—é¢å¸¸é‡ä¸åœ°å€ç±»å‹"><a href="#_4-åå…­è¿›åˆ¶å­—é¢å¸¸é‡ä¸åœ°å€ç±»å‹" class="header-anchor">#</a> 4.åå…­è¿›åˆ¶å­—é¢å¸¸é‡ä¸åœ°å€ç±»å‹</h3> <p>é€šè¿‡æ ¡éªŒå’Œæµ‹è¯•çš„æ­£ç¡®å¤§å°çš„åå…­è¿›åˆ¶å­—é¢å¸¸é‡ä¼šä½œä¸º <code>address</code>ç±»å‹ã€‚æ²¡æœ‰å…¶ä»–å­—é¢å¸¸é‡å¯ä»¥éšå¼è½¬æ¢ä¸º <code>address</code> ç±»å‹ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    address public ads1 = 0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926ac;
    // address public ads2 = 0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926ab; // âŒ
}
</code></pre></div><h2 id="ğŸ†—-å®æˆ˜-1-todo-list"><a href="#ğŸ†—-å®æˆ˜-1-todo-list" class="header-anchor">#</a> ğŸ†— å®æˆ˜ 1: Todo List</h2> <p>TodoList: æ˜¯ç±»ä¼¼ä¾¿ç­¾ä¸€æ ·åŠŸèƒ½çš„ä¸œè¥¿ï¼Œè®°å½•æˆ‘ä»¬éœ€è¦åšçš„äº‹æƒ…ï¼Œä»¥åŠå®ŒæˆçŠ¶æ€ã€‚</p> <h3 id="æœ¬èŠ‚é…å¥—è§†é¢‘-27"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-27" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h3> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=40" target="_blank" rel="noreferrer">ç¬¬äºŒç« å®æˆ˜ 1: Todo List</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=jkYlSW9XJjo&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=40" target="_blank" rel="noreferrer">ç¬¬äºŒç« å®æˆ˜ 1: Todo List</a></li></ul> <h3 id="_1-éœ€è¦å®Œæˆçš„åŠŸèƒ½"><a href="#_1-éœ€è¦å®Œæˆçš„åŠŸèƒ½" class="header-anchor">#</a> 1.éœ€è¦å®Œæˆçš„åŠŸèƒ½</h3> <ul><li>åˆ›å»ºä»»åŠ¡</li> <li>ä¿®æ”¹ä»»åŠ¡åç§°
<ul><li>ä»»åŠ¡åå†™é”™çš„æ—¶å€™</li></ul></li> <li>ä¿®æ”¹å®ŒæˆçŠ¶æ€ï¼š
<ul><li>æ‰‹åŠ¨æŒ‡å®šå®Œæˆæˆ–è€…æœªå®Œæˆ</li> <li>è‡ªåŠ¨åˆ‡æ¢
<ul><li>å¦‚æœæœªå®ŒæˆçŠ¶æ€ä¸‹ï¼Œæ”¹ä¸ºå®Œæˆ</li> <li>å¦‚æœå®ŒæˆçŠ¶æ€ï¼Œæ”¹ä¸ºæœªå®Œæˆ</li></ul></li></ul></li> <li>è·å–ä»»åŠ¡</li></ul> <h3 id="_2-æ€è€ƒä»£ç å†…çŠ¶æ€å˜é‡æ€ä¹ˆå®‰æ’"><a href="#_2-æ€è€ƒä»£ç å†…çŠ¶æ€å˜é‡æ€ä¹ˆå®‰æ’" class="header-anchor">#</a> 2.æ€è€ƒä»£ç å†…çŠ¶æ€å˜é‡æ€ä¹ˆå®‰æ’ï¼Ÿ</h3> <p>æ€è€ƒ 1ï¼šæ€è€ƒä»»åŠ¡ ID çš„æ¥æºï¼Ÿ</p> <p>æˆ‘ä»¬åœ¨ä¼ ç»Ÿä¸šåŠ¡é‡Œï¼Œè¿™é‡Œçš„ä»»åŠ¡éƒ½ä¼šæœ‰ä¸€ä¸ªä»»åŠ¡ IDï¼Œåœ¨åŒºå—é“¾é‡Œæ€ä¹ˆå®ç°ï¼Ÿï¼Ÿ</p> <p>ç­”ï¼šä¼ ç»Ÿä¸šåŠ¡é‡Œï¼ŒID å¯ä»¥æ˜¯æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä¹Ÿå¯ä»¥ç”¨ç®—æ³•æ¥è®¡ç®—å‡ºæ¥çš„ï¼Œæ¯”å¦‚ä½¿ç”¨é›ªèŠ±ç®—æ³•è®¡ç®—å‡º ID ç­‰ã€‚åœ¨åŒºå—é“¾é‡Œæˆ‘ä»¬ä½¿ç”¨æ•°ç»„çš„ index ç´¢å¼•ä½œä¸ºä»»åŠ¡çš„ IDï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå¢çš„æ•´å‹æ•°æ®æ¥è¡¨ç¤ºã€‚</p> <p>æ€è€ƒ 2: æˆ‘ä»¬ä½¿ç”¨ä»€ä¹ˆæ•°æ®ç±»å‹æ¯”è¾ƒå¥½ï¼Ÿ</p> <p>ç­”ï¼šå› ä¸ºéœ€è¦ä»»åŠ¡ IDï¼Œå¦‚æœä½¿ç”¨æ•°ç»„ index ä½œä¸ºä»»åŠ¡ IDã€‚åˆ™æ•°æ®çš„å…ƒç´ å†…éœ€è¦è®°å½•ä»»åŠ¡åç§°ï¼Œä»»åŠ¡å®ŒæˆçŠ¶æ€ï¼Œæ‰€ä»¥å…ƒç´ ä½¿ç”¨ struct æ¯”è¾ƒå¥½ã€‚</p> <p>å¦‚æœä½¿ç”¨è‡ªå¢çš„æ•´å‹ä½œä¸ºä»»åŠ¡ IDï¼Œåˆ™æ•´å‹ ID å¯¹åº”ä»»åŠ¡ï¼Œä½¿ç”¨ mapping ç±»å‹æ¯”è¾ƒç¬¦åˆã€‚</p> <h3 id="_3-æ¼”ç¤ºä»£ç "><a href="#_3-æ¼”ç¤ºä»£ç " class="header-anchor">#</a> 3.æ¼”ç¤ºä»£ç </h3> <div class="language- extra-class"><pre class="language-text"><code>contract Demo {
    struct Todo {
        string name;
        bool isCompleted;
    }
    Todo[] public list; // 29414

    // åˆ›å»ºä»»åŠ¡
    function create(string memory name_) external {
        list.push(
            Todo({
                name:name_, // ,
                isCompleted:false
            })
        );
    }

    // ä¿®æ”¹ä»»åŠ¡åç§°
    function modiName1(uint256 index_,string memory name_) external {
        // æ–¹æ³•1: ç›´æ¥ä¿®æ”¹ï¼Œä¿®æ”¹ä¸€ä¸ªå±æ€§æ—¶å€™æ¯”è¾ƒçœ gas
        list[index_].name = name_;
    }

    function modiName2(uint256 index_,string memory name_) external {
        // æ–¹æ³•2: å…ˆè·å–å‚¨å­˜åˆ° storageï¼Œåœ¨ä¿®æ”¹ï¼Œåœ¨ä¿®æ”¹å¤šä¸ªå±æ€§çš„æ—¶å€™æ¯”è¾ƒçœ gas
        Todo storage temp = list[index_];
        temp.name = name_;
    }

    // ä¿®æ”¹å®ŒæˆçŠ¶æ€1:æ‰‹åŠ¨æŒ‡å®šå®Œæˆæˆ–è€…æœªå®Œæˆ
    function modiStatus1(uint256 index_,bool status_) external {
        list[index_].isCompleted = status_;
    }

    // ä¿®æ”¹å®ŒæˆçŠ¶æ€2:è‡ªåŠ¨åˆ‡æ¢ toggle
    function modiStatus2(uint256 index_) external {
        list[index_].isCompleted = !list[index_].isCompleted;
    }

    // è·å–ä»»åŠ¡1: memory : 2æ¬¡æ‹·è´
    // 29448 gas
    function get1(uint256 index_) external view
        returns(string memory name_,bool status_){
        Todo memory temp = list[index_];
        return (temp.name,temp.isCompleted);
    }

    // è·å–ä»»åŠ¡2: storage : 1æ¬¡æ‹·è´
    // é¢„æœŸï¼šget2 çš„ gas è´¹ç”¨æ¯”è¾ƒä½ï¼ˆç›¸å¯¹ get1ï¼‰
    // 29388 gas
    function get2(uint256 index_) external view
        returns(string memory name_,bool status_){
        Todo storage temp = list[index_];
        return (temp.name,temp.isCompleted);
    }

}
</code></pre></div><h3 id="_4-è‡ªå·±åŠ¨æ‰‹"><a href="#_4-è‡ªå·±åŠ¨æ‰‹" class="header-anchor">#</a> 4. è‡ªå·±åŠ¨æ‰‹</h3> <p>è‡ªåŠ¨åŠ¨æ‰‹å†™ä¸€ä¸‹ï¼ŒæŒ‰ç…§ä½¿ç”¨è‡ªå¢æ•´å‹ä½œä¸ºä»»åŠ¡ IDï¼Œé…åˆ mapping å®ç°ä¸Šé¢é€»è¾‘ã€‚çŠ¶æ€æŒ‰ç…§ã€æœªå®Œæˆï¼Œè¿›è¡Œä¸­ï¼Œå·²å®Œæˆï¼Œå·²å–æ¶ˆã€‘å››ç§çŠ¶æ€æ¥åšã€‚</p> <h2 id="ğŸ†—-å®æˆ˜-2-ä¼—ç­¹åˆçº¦"><a href="#ğŸ†—-å®æˆ˜-2-ä¼—ç­¹åˆçº¦" class="header-anchor">#</a> ğŸ†— å®æˆ˜ 2: ä¼—ç­¹åˆçº¦</h2> <p>ä¼—ç­¹åˆçº¦æ˜¯ä¸€ä¸ªå‹Ÿé›†èµ„é‡‘çš„åˆçº¦ï¼Œåœ¨åŒºå—é“¾ä¸Šï¼Œæˆ‘ä»¬æ˜¯å‹Ÿé›†ä»¥å¤ªå¸ï¼Œç±»ä¼¼äº’è”ç½‘ä¸šåŠ¡çš„æ°´æ»´ç­¹ã€‚åŒºå—é“¾æ—©èµ·çš„ ICO å°±æ˜¯ç±»ä¼¼ä¸šåŠ¡ã€‚</p> <h3 id="æœ¬èŠ‚é…å¥—è§†é¢‘-28"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-28" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h3> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=41" target="_blank" rel="noreferrer">ç¬¬äºŒç« å®æˆ˜ 2: ä¼—ç­¹åˆçº¦</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=lE5zPY4-OR8&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=41" target="_blank" rel="noreferrer">ç¬¬äºŒç« å®æˆ˜ 2: ä¼—ç­¹åˆçº¦</a></li></ul> <h3 id="_1-éœ€æ±‚åˆ†æ"><a href="#_1-éœ€æ±‚åˆ†æ" class="header-anchor">#</a> 1.éœ€æ±‚åˆ†æ</h3> <p>ä¼—ç­¹åˆçº¦åˆ†ä¸ºä¸¤ç§è§’è‰²ï¼šä¸€ä¸ªæ˜¯å—ç›Šäººï¼Œä¸€ä¸ªæ˜¯èµ„åŠ©è€…ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// ä¸¤ç§è§’è‰²:
//      å—ç›Šäºº   beneficiary =&gt; address         =&gt; address ç±»å‹
//      èµ„åŠ©è€…   funders     =&gt; address:amount  =&gt; mapping ç±»å‹ æˆ–è€… struct ç±»å‹
</code></pre></div><p>çŠ¶æ€å˜é‡æŒ‰ç…§ä¼—ç­¹çš„ä¸šåŠ¡ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// çŠ¶æ€å˜é‡
//      ç­¹èµ„ç›®æ ‡æ•°é‡    fundingGoal
//      å½“å‰å‹Ÿé›†æ•°é‡    fundingAmount
//      èµ„åŠ©è€…åˆ—è¡¨      funders
//      èµ„åŠ©è€…äººæ•°      fundersKey
</code></pre></div><p>éœ€è¦éƒ¨ç½²æ—¶å€™ä¼ å…¥çš„æ•°æ®:</p> <div class="language- extra-class"><pre class="language-text"><code>//      å—ç›Šäºº
//      ç­¹èµ„ç›®æ ‡æ•°é‡
</code></pre></div><h3 id="_2-æ¼”ç¤ºä»£ç "><a href="#_2-æ¼”ç¤ºä»£ç " class="header-anchor">#</a> 2.æ¼”ç¤ºä»£ç </h3> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract CrowdFunding {
    address public immutable beneficiary;   // å—ç›Šäºº
    uint256 public immutable fundingGoal;   // ç­¹èµ„ç›®æ ‡æ•°é‡

    uint256 public fundingAmount;       // å½“å‰çš„ é‡‘é¢
    mapping(address=&gt;uint256) public funders;

    // å¯è¿­ä»£çš„æ˜ å°„
    mapping(address=&gt;bool) private fundersInserted;
    address[] public fundersKey; // length

    // ä¸ç”¨è‡ªé”€æ¯æ–¹æ³•ï¼Œä½¿ç”¨å˜é‡æ¥æ§åˆ¶
    bool public AVAILABLED = true; // çŠ¶æ€

    // éƒ¨ç½²çš„æ—¶å€™ï¼Œå†™å…¥å—ç›Šäºº+ç­¹èµ„ç›®æ ‡æ•°é‡
    constructor(address beneficiary_,uint256 goal_){
        beneficiary = beneficiary_;
        fundingGoal = goal_;
    }

    // èµ„åŠ©
    //      å¯ç”¨çš„æ—¶å€™æ‰å¯ä»¥æ
    //      åˆçº¦å…³é—­ä¹‹åï¼Œå°±ä¸èƒ½åœ¨æ“ä½œäº†
    function contribute() external payable{
        require(AVAILABLED,&quot;CrowdFunding is closed&quot;);
        funders[msg.sender] += msg.value;
        fundingAmount += msg.value;
        // 1.æ£€æŸ¥
        if(!fundersInserted[msg.sender]){
            // 2.ä¿®æ”¹
            fundersInserted[msg.sender] = true;
            // 3.æ“ä½œ
            fundersKey.push(msg.sender);
        }
    }

    // å…³é—­
    function close() external returns(bool){
        // 1.æ£€æŸ¥
        if(fundingAmount&lt;fundingGoal){
            return false;
        }
        uint256 amount = fundingAmount;

        // 2.ä¿®æ”¹
        fundingAmount = 0;
        AVAILABLED = false;

        // 3. æ“ä½œ
        payable(beneficiary).transfer(amount);
        return true;
    }

    function fundersLenght() public view returns(uint256){
        return fundersKey.length;
    }

}
</code></pre></div><p>ä¸Šé¢çš„åˆçº¦åªæ˜¯ä¸€ä¸ªç®€åŒ–ç‰ˆçš„ ä¼—ç­¹åˆçº¦ï¼Œä½†å®ƒå·²ç»è¶³ä»¥è®©æˆ‘ä»¬ç†è§£æœ¬èŠ‚ä»‹ç»çš„ç±»å‹æ¦‚å¿µã€‚</p> <h3 id="_3-è‡ªå·±åŠ¨æ‰‹"><a href="#_3-è‡ªå·±åŠ¨æ‰‹" class="header-anchor">#</a> 3.è‡ªå·±åŠ¨æ‰‹</h3> <p>ä¸Šé¢å†™çš„æ˜¯é¡¹ç›®æ–¹è§’åº¦çš„å‹Ÿé›†è‡ªå·±ã€‚å¦‚æœæ˜¯å‹Ÿé›†å¹³å°ï¼Œè‚¯å®šæ˜¯ä¼šå‘ Todo List é‚£ä¸ªç»ƒä¹ ä¸­ä¸€æ ·ï¼Œæ˜¯æœ‰ä¼—ç­¹ ID çš„ï¼›è¯·æŒ‰ç…§ä¼—ç­¹å¹³å°çš„è§’åº¦æ¥å†™ä¸€ä¸ªä¼—ç­¹åè®®ã€‚</p> <ul><li>ä½¿ç”¨å¹³å°è§’åº¦å†™åˆçº¦</li> <li>ä½¿ç”¨ stuct æ ¼å¼ã€‚</li> <li>ã€é€‰åšã€‘ï¼šå¢åŠ ä¼—ç­¹æ—¶é—´çš„é™åˆ¶
<ul><li>å¦‚æœè§„å®šæ—¶é—´å†…å®Œæˆï¼Œåˆ™ç»“æŸåè½¬é’±ç»™å—ç›Šäºº</li> <li>å¦‚æœè§„å®šæ—¶é—´å†…æ²¡æœ‰å®Œæˆï¼Œåˆ™èµ„é‡‘é‡Šæ”¾ï¼Œæèµ è€…è‡ªå·±å–å›æèµ èµ„é‡‘ã€‚</li></ul></li></ul> <h2 id="ğŸ†—-å®æˆ˜-3-åŒå¿—ä»¬å¥½å¢åŠ æç¤º"><a href="#ğŸ†—-å®æˆ˜-3-åŒå¿—ä»¬å¥½å¢åŠ æç¤º" class="header-anchor">#</a> ğŸ†— å®æˆ˜ 3: åŒå¿—ä»¬å¥½å¢åŠ æç¤º</h2> <h3 id="æœ¬èŠ‚é…å¥—è§†é¢‘-29"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-29" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h3> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=42" target="_blank" rel="noreferrer">ç¬¬äºŒç« å®æˆ˜ 3: åŒå¿—ä»¬å¥½å¢åŠ æç¤º</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=bVrIUwrJrjo&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=42" target="_blank" rel="noreferrer">ç¬¬äºŒç« å®æˆ˜ 3: åŒå¿—ä»¬å¥½å¢åŠ æç¤º</a></li></ul> <h3 id="_1-éœ€æ±‚åˆ†æ-2"><a href="#_1-éœ€æ±‚åˆ†æ-2" class="header-anchor">#</a> 1.éœ€æ±‚åˆ†æ</h3> <p>éœ€è¦ç‚¹å‡»ä¸€ä¸ªæ–¹æ³•ï¼ŒæŸ¥çœ‹å½“å‰çš„ step åˆ°å“ªé‡Œäº†ï¼Ÿç„¶åæç¤ºä¸‹ä¸€æ­¥è¯¥å¹²ä»€ä¹ˆã€‚</p> <p>æ¯”å¦‚ï¼š<strong>å½“å‰çš„ step æ˜¯:0 å¯ä»¥æ‰§è¡Œ hello ,é¢†å¯¼è¯´:åŒå¿—ä»¬å¥½</strong>ã€‚</p> <p><strong>éš¾ç‚¹ï¼šæ•°å­—æ€ä¹ˆè½¬æ¢æˆ string</strong>ï¼Ÿ</p> <h3 id="_2-ä»£ç å¦‚ä¸‹"><a href="#_2-ä»£ç å¦‚ä¸‹" class="header-anchor">#</a> 2.ä»£ç å¦‚ä¸‹</h3> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    uint8 public step = 0;

    /// @notice ç”¨äºè¾…åŠ©è·å–ä¸‹ä¸€æ­¥è¯¥åšä»€ä¹ˆçš„æ–¹æ³•
    /// @dev æ•´ç†stepå¯¹åº”çš„é”™è¯¯ï¼Œæ³¨æ„æ•°å­—è½¬ä¸ºå­—ç¬¦ä¸²æ—¶å€™çš„é€”å¾„
    /// @return å½“å‰çš„æç¤ºä¿¡æ¯
    function helperInfo() external view returns (string memory) {
        string memory stepDes = unicode&quot;å½“å‰çš„stepæ˜¯:&quot;;
        string memory info;

        if (step == 0) {
            info = unicode&quot;å¯ä»¥æ‰§è¡Œ hello ,é¢†å¯¼è¯´:åŒå¿—ä»¬å¥½&quot;;
        } else if (step == 1) {
            info = unicode&quot;å¯ä»¥æ‰§è¡Œ helloRes ,åŒå¿—ä»¬è¯´:é¢†å¯¼å¥½&quot;;
        } else if (step == 2) {
            info = unicode&quot;å¯ä»¥æ‰§è¡Œ comfort ,é¢†å¯¼å¿…é¡»ç»™é’±ï¼Œå¹¶ä¸”è¯´:åŒå¿—ä»¬è¾›è‹¦äº†&quot;;
        } else if (step == 3) {
            info = unicode&quot;å¯ä»¥æ‰§è¡Œ comfortRes ,åŒå¿—ä»¬è¯´:ä¸ºäººæ°‘æœåŠ¡&quot;;
        } else if (step == 4) {
            info = unicode&quot;å¯ä»¥æ‰§è¡Œ selfdestruct&quot;;
        } else {
            info = unicode&quot;æœªçŸ¥&quot;;
        }

        return string.concat(stepDes, uintToString(step), &quot; &quot;, info);
    }

    // å¦å¤–ä¸€ç§è½¬æ¢æ–¹æ³•
    //è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œé€šè¿‡å–æ¨¡çš„æ–¹å¼ï¼Œä¸€ä½ä¸€ä½è½¬æ¢
    function uintToString(uint256 _uint)
        internal
        pure
        returns (string memory str)
    {
        if (_uint == 0) return &quot;0&quot;;
        while (_uint != 0) {
            //å–æ¨¡
            uint256 remainder = _uint % 10;
            //æ¯å–ä¸€ä½å°±ç§»åŠ¨ä¸€ä½ï¼Œä¸ªä½ã€åä½ã€ç™¾ä½ã€åƒä½â€¦â€¦
            _uint = _uint / 10;
            //å°†å­—ç¬¦æ‹¼æ¥ï¼Œæ³¨æ„å­—ç¬¦ä½ç½®
            str =  string.concat(toStr(remainder), str);
        }
    }

    function toStr(uint256 num_) internal pure returns (string memory) {
        require(num_ &lt; 10,&quot;error&quot;);
        bytes memory alphabet = &quot;0123456789&quot;;
        bytes memory str = new bytes(1);
        str[0] = alphabet[num_];
        return string(str);
    }
}
</code></pre></div><h2 id="ğŸ†—-å®æˆ˜-4-eth-é’±åŒ…"><a href="#ğŸ†—-å®æˆ˜-4-eth-é’±åŒ…" class="header-anchor">#</a> ğŸ†— å®æˆ˜ 4: ETH é’±åŒ…</h2> <h3 id="æœ¬èŠ‚é…å¥—è§†é¢‘-30"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-30" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h3> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=43" target="_blank" rel="noreferrer">ç¬¬äºŒç« å®æˆ˜ 4: ETH é’±åŒ…</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=-VYk-kEVrLg&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=43" target="_blank" rel="noreferrer">ç¬¬äºŒç« å®æˆ˜ 4: ETH é’±åŒ…</a></li></ul> <h3 id="å†…å®¹-2"><a href="#å†…å®¹-2" class="header-anchor">#</a> å†…å®¹</h3> <p>è¿™ä¸€ä¸ªå®æˆ˜ä¸»è¦æ˜¯åŠ æ·±å¤§å®¶å¯¹ 3 ä¸ªå–é’±æ–¹æ³•çš„ä½¿ç”¨ã€‚</p> <ul><li>ä»»ä½•äººéƒ½å¯ä»¥å‘é€é‡‘é¢åˆ°åˆçº¦</li> <li>åªæœ‰ owner å¯ä»¥å–æ¬¾</li> <li>3 ç§å–é’±æ–¹å¼</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract EtherWallet {
    address payable public immutable owner;
    event Log(string funName, address from, uint256 value, bytes data);

    constructor() {
        owner = payable(msg.sender);
    }

    receive() external payable {
        emit Log(&quot;receive&quot;, msg.sender, msg.value, &quot;&quot;);
    }

    function withdraw1() external {
        require(msg.sender == owner, &quot;Not owner&quot;);
        // owner.transfer ç›¸æ¯” msg.sender æ›´æ¶ˆè€—Gas
        // owner.transfer(address(this).balance);
        payable(msg.sender).transfer(100);
    }

    function withdraw2() external {
        require(msg.sender == owner, &quot;Not owner&quot;);
        bool success = payable(msg.sender).send(200);
        require(success, &quot;Send Failed&quot;);
    }

    function withdraw3() external {
        require(msg.sender == owner, &quot;Not owner&quot;);
        (bool success, ) = msg.sender.call{value: address(this).balance}(&quot;&quot;);
        require(success, &quot;Call Failed&quot;);
    }

    function getBalance() external view returns (uint256) {
        return address(this).balance;
    }
}
</code></pre></div><h2 id="ğŸ†—-å®æˆ˜-5-å¤šç­¾é’±åŒ…"><a href="#ğŸ†—-å®æˆ˜-5-å¤šç­¾é’±åŒ…" class="header-anchor">#</a> ğŸ†— å®æˆ˜ 5: å¤šç­¾é’±åŒ…</h2> <p>å¤šç­¾é’±åŒ…çš„åŠŸèƒ½: åˆçº¦æœ‰å¤šä¸ª ownerï¼Œä¸€ç¬”äº¤æ˜“å‘å‡ºåï¼Œéœ€è¦å¤šä¸ª owner ç¡®è®¤ï¼Œç¡®è®¤æ•°è¾¾åˆ°æœ€ä½è¦æ±‚æ•°ä¹‹åï¼Œæ‰å¯ä»¥çœŸæ­£çš„æ‰§è¡Œã€‚</p> <h3 id="æœ¬èŠ‚é…å¥—è§†é¢‘-31"><a href="#æœ¬èŠ‚é…å¥—è§†é¢‘-31" class="header-anchor">#</a> æœ¬èŠ‚é…å¥—è§†é¢‘</h3> <ul><li>BiliBili: <a href="https://www.bilibili.com/video/BV1HR4y197Ag?p=44" target="_blank" rel="noreferrer">ç¬¬äºŒç« å®æˆ˜ 5: å¤šç­¾é’±åŒ…</a></li> <li>Youtube: <a href="https://www.youtube.com/watch?v=PK3u8XXSbVg&amp;list=PLdXBX6Eqe4Net43OWIZychHW0n6CX_8Ih&amp;index=44" target="_blank" rel="noreferrer">ç¬¬äºŒç« å®æˆ˜ 5: å¤šç­¾é’±åŒ…</a></li></ul> <h3 id="_1-åŸç†"><a href="#_1-åŸç†" class="header-anchor">#</a> 1.åŸç†</h3> <ul><li>éƒ¨ç½²æ—¶å€™ä¼ å…¥åœ°å€å‚æ•°å’Œéœ€è¦çš„ç­¾åæ•°
<ul><li>å¤šä¸ª owner åœ°å€</li> <li>å‘èµ·äº¤æ˜“çš„æœ€ä½ç­¾åæ•°</li></ul></li> <li>æœ‰æ¥å— ETH ä¸»å¸çš„æ–¹æ³•ï¼Œ</li> <li>é™¤äº†å­˜æ¬¾å¤–ï¼Œå…¶ä»–æ‰€æœ‰æ–¹æ³•éƒ½éœ€è¦ owner åœ°å€æ‰å¯ä»¥è§¦å‘</li> <li>å‘é€å‰éœ€è¦æ£€æµ‹æ˜¯å¦è·å¾—äº†è¶³å¤Ÿçš„ç­¾åæ•°</li> <li>ä½¿ç”¨å‘å‡ºçš„äº¤æ˜“æ•°é‡å€¼ä½œä¸ºç­¾åçš„å‡­æ® IDï¼ˆç±»ä¼¼ä¸Šä¹ˆï¼‰</li> <li>æ¯æ¬¡ä¿®æ”¹çŠ¶æ€å˜é‡éƒ½éœ€è¦æŠ›å‡ºäº‹ä»¶</li> <li>å…è®¸æ‰¹å‡†çš„äº¤æ˜“ï¼Œåœ¨æ²¡æœ‰çœŸæ­£æ‰§è¡Œå‰å–æ¶ˆã€‚</li> <li>è¶³å¤Ÿæ•°é‡çš„ approve åï¼Œæ‰å…è®¸çœŸæ­£æ‰§è¡Œã€‚</li></ul> <h3 id="_2-ä»£ç "><a href="#_2-ä»£ç " class="header-anchor">#</a> 2.ä»£ç </h3> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract MultiSigWallet {
    // çŠ¶æ€å˜é‡
    address[] public owners;
    mapping(address =&gt; bool) public isOwner;
    uint256 public required;

    struct Transaction {
        address to;
        uint256 value;
        bytes data;
        bool exected;
    }
    Transaction[] public transactions;
    mapping(uint256 =&gt; mapping(address =&gt; bool)) public approved;

    // äº‹ä»¶
    event Deposit(address indexed sender, uint256 amount);
    event Submit(uint256 indexed txId);
    event Approve(address indexed owner, uint256 indexed txId);
    event Revoke(address indexed owner, uint256 indexed txId);
    event Execute(uint256 indexed txId);

    // receive
    receive() external payable {
        emit Deposit(msg.sender, msg.value);
    }

    // å‡½æ•°ä¿®æ”¹å™¨
    modifier onlyOwner() {
        require(isOwner[msg.sender], &quot;not owner&quot;);
        _;
    }
    modifier txExists(uint256 _txId) {
        require(_txId &lt; transactions.length, &quot;tx doesn't exist&quot;);
        _;
    }
    modifier notApproved(uint256 _txId) {
        require(!approved[_txId][msg.sender], &quot;tx already approved&quot;);
        _;
    }
    modifier notExecuted(uint256 _txId) {
        require(!transactions[_txId].exected, &quot;tx is exected&quot;);
        _;
    }

    // æ„é€ å‡½æ•°
    constructor(address[] memory _owners, uint256 _required) {
        require(_owners.length &gt; 0, &quot;owner required&quot;);
        require(
            _required &gt; 0 &amp;&amp; _required &lt;= _owners.length,
            &quot;invalid required number of owners&quot;
        );

        for (uint256 index = 0; index &lt; _owners.length; index++) {
            address owner = _owners[index];
            require(owner != address(0), &quot;invalid owner&quot;);
            require(!isOwner[owner], &quot;owner is not unique&quot;); // å¦‚æœé‡å¤ä¼šæŠ›å‡ºé”™è¯¯
            isOwner[owner] = true;
            owners.push(owner);
        }
        required = _required;
    }

    // å‡½æ•°
    function getBalance() external view returns (uint256) {
        return address(this).balance;
    }

    function submit(
        address _to,
        uint256 _value,
        bytes calldata _data
    ) external onlyOwner returns(uint256){
        transactions.push(
            Transaction({to: _to, value: _value, data: _data, exected: false})
        );
        emit Submit(transactions.length - 1);
        return transactions.length - 1;
    }

    function approv(uint256 _txId)
        external
        onlyOwner
        txExists(_txId)
        notApproved(_txId)
        notExecuted(_txId)
    {
        approved[_txId][msg.sender] = true;
        emit Approve(msg.sender, _txId);
    }

    function execute(uint256 _txId)
        external
        onlyOwner
        txExists(_txId)
        notExecuted(_txId)
    {
        require(getApprovalCount(_txId) &gt;= required, &quot;approvals &lt; required&quot;);

        Transaction storage transaction = transactions[_txId];
        transaction.exected = true;

        (bool sucess, ) = transaction.to.call{value: transaction.value}(
            transaction.data
        );
        require(sucess, &quot;tx failed&quot;);
        emit Execute(_txId);
    }

    function getApprovalCount(uint256 _txId)
        public
        view
        returns (uint256 count)
    {
        for (uint256 index = 0; index &lt; owners.length; index++) {
            if (approved[_txId][owners[index]]) {
                count += 1;
            }
        }
    }

    function revoke(uint256 _txId)
        external
        onlyOwner
        txExists(_txId)
        notExecuted(_txId)
    {
        require(approved[_txId][msg.sender], &quot;tx not approved&quot;);
        approved[_txId][msg.sender] = false;
        emit Revoke(msg.sender, _txId);
    }
}
</code></pre></div><h3 id="_3-æµ‹è¯•æµç¨‹"><a href="#_3-æµ‹è¯•æµç¨‹" class="header-anchor">#</a> 3.æµ‹è¯•æµç¨‹</h3> <ol><li>éƒ¨ç½²åˆçº¦
<ol><li>ä¼ å…¥æ‰€æœ‰ owner åœ°å€</li> <li>ä¼ å…¥éœ€è¦çš„æ‰¹å‡†æ•°: ä¾‹å­æ˜¯ 3</li></ol></li> <li>è°ƒç”¨ <code>required</code> æŸ¥è¯¢éœ€è¦çš„æ•°é‡</li> <li>è·å– <code>getBalance</code> æŸ¥è¯¢å½“å‰åœ°å€çš„ ETH ä¸»å¸ä½™é¢</li> <li>ä½¿ç”¨ <code>isOwner</code> æŸ¥è¯¢å¤šä¸ªåœ°å€çš„æƒé™ï¼Œçœ‹æ˜¯å¦ç¬¦åˆé¢„æœŸ</li> <li>ä½¿ç”¨ <code>owners</code> æŸ¥è¯¢ä¸åŒçš„ç´¢å¼•æ˜¯å¦ç¬¦åˆé¢„æœŸ</li> <li>ä½¿ç”¨ <code>transactions</code> æŸ¥è¯¢åˆå§‹æ˜¯å¦ä¸ºæ²¡æœ‰å€¼</li> <li><strong>ä½¿ç”¨å…¶ä»–åœ°å€å‘åˆçº¦å†…è½¬å…¥ ETH ä¸»å¸</strong></li> <li>ä½¿ç”¨ <code>getBalance</code> æŸ¥è¯¢å½“å‰åœ°å€çš„ ETH ä½™é¢æ˜¯å¦ç¬¦åˆé¢„æœŸ</li> <li>è°ƒç”¨ <code>submit</code>ï¼Œç”³è¯·è½¬å‡ºä¸€ç¬”é’±åˆ°æŒ‡å®šåœ°å€
<ol><li><code>_to</code> åœ°å€</li> <li><code>_value</code> éœ€è¦çš„é‡‘é¢</li> <li><code>_data</code>: å¦‚æœæ²¡æœ‰éœ€è¦çš„æ‰§è¡Œçš„ä»£ç ï¼Œä¼ å…¥é»˜è®¤çš„ <code>0x</code>å³å¯</li> <li>è¿”å›å€¼ä¸ºæœ¬æ¬¡äº¤æ˜“çš„ <code>txId</code></li> <li>è®°å½• <code>_to</code> çš„å½“å‰ä½™é¢</li> <li>è®°å½• åˆçº¦çš„å½“å‰ä½™é¢ï¼Œä½¿ç”¨ <code>getBalance</code> è·å–</li></ol></li> <li>ä½¿ç”¨ <code>transactions</code> æŸ¥è¯¢ <code>txId</code> æ˜¯å¦ä¸ºé¢„æœŸ</li> <li>ä½¿ç”¨ <code>getApprovalCount</code> æŸ¥è¯¢æ‰¹å‡†æ•°é‡æ˜¯å¦ä¸º 0</li> <li>ä½¿ç”¨ <code>getBalance</code> æŸ¥è¯¢å½“å‰åœ°å€çš„ ETH ï¼Œç¡®è®¤é’±æ²¡æœ‰è¢«è½¬å‡º</li> <li>ä½¿ç”¨ <code>approved</code> æŸ¥è¯¢å½“å‰ <code>txId</code> æ˜¯å¦è¢« owner1 æ‰¹å‡†</li> <li><strong>ä½¿ç”¨ owner1 è°ƒç”¨ <code>approv</code> å¯¹ <code>txId</code> è¿›è¡Œæ‰¹å‡†</strong></li> <li>ä½¿ç”¨ <code>getApprovalCount</code> æŸ¥è¯¢æ‰¹å‡†æ•°é‡æ˜¯å¦ä¸º 1</li> <li>ä½¿ç”¨ owner1 è°ƒç”¨ <code>approv</code> å¯¹ <code>txId</code> è¿›è¡Œå†æ¬¡æ‰¹å‡†
<ol><li>æŸ¥çœ‹æ˜¯å¦æŠ¥é”™ <code>tx already approved</code></li></ol></li> <li>ä½¿ç”¨ <code>approved</code> æŸ¥è¯¢å½“å‰ <code>txId</code> æ˜¯å¦è¢«æŸä¸ª owner1 æ‰¹å‡†</li> <li>ä½¿ç”¨ <code>getBalance</code> å’Œ <code>transactions</code> æŸ¥è¯¢ <code>txId</code> æ˜¯å¦ä¸ºé¢„æœŸ</li> <li><strong>ä½¿ç”¨ <code>owner2</code> <code>owner3</code> åœ°å€è°ƒç”¨ <code>approv</code> å¯¹ <code>txId</code> è¿›è¡Œæ‰¹å‡†</strong> <ol><li>ä½¿ç”¨ <code>approved</code> æŸ¥è¯¢å½“å‰ <code>txId</code> æ˜¯å¦è¢« owner1 æ‰¹å‡†</li></ol></li> <li>ç”¨ <code>getApprovalCount</code> æŸ¥è¯¢æ‰¹å‡†æ•°é‡æ˜¯å¦ä¸º 3</li> <li><strong>ä½¿ç”¨ owner1 è°ƒç”¨ <code>revoke</code> å¯¹ <code>txId</code> è¿›è¡Œæ‰¹å‡†æ’¤é”€</strong></li> <li>ç”¨ <code>getApprovalCount</code> æŸ¥è¯¢æ‰¹å‡†æ•°é‡æ˜¯å¦ä¸º 2</li> <li>ä½¿ç”¨ owner1 è°ƒç”¨ <code>execute</code> è¿›è¡Œæ­£å¼æ‰§è¡Œ
<ol><li>æŸ¥çœ‹æ˜¯å¦æŠ¥é”™ <code>&quot;approvals &lt; required&quot;</code>.</li></ol></li> <li><strong>ä½¿ç”¨ owner1 è°ƒç”¨ <code>revoke</code> å¯¹ <code>txId</code> è¿›è¡Œå†æ¬¡æ‰¹å‡†</strong> <ol><li>ä½¿ç”¨ <code>approved</code> æŸ¥è¯¢å½“å‰ <code>txId</code> æ˜¯å¦è¢« owner1 æ‰¹å‡†</li></ol></li> <li>ç”¨ <code>getApprovalCount</code> æŸ¥è¯¢æ‰¹å‡†æ•°é‡æ˜¯å¦ä¸º 3</li> <li><strong>ä½¿ç”¨ owner1 å†æ¬¡è°ƒç”¨ <code>execute</code> è¿›è¡Œæ­£å¼æ‰§è¡Œ</strong> <ol><li>æŸ¥è¯¢å½“å‰äº¤æ˜“æ˜¯å¦æ­£ç¡®æ‰§è¡Œ</li></ol></li> <li>ç¡®è®¤æ‰§è¡Œçš„ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸ
<ol><li>ä½¿ç”¨ <code>transactions</code> æŸ¥è¯¢ <code>txId</code> çš„ <code>exected</code> æ˜¯å¦ä¸º true</li> <li><code>_to</code> åœ°å€æ˜¯å¦æ”¶åˆ°é‡‘é¢ï¼Œ</li> <li>ä½¿ç”¨ <code>getBalance</code> æŸ¥è¯¢å½“å‰åœ°å€çš„ ETH ä½™é¢æ˜¯å¦æ­£ç¡®</li></ol></li></ol> <h2 id="ï¸âƒ£-é—®ç­”é¢˜"><a href="#ï¸âƒ£-é—®ç­”é¢˜" class="header-anchor">#</a> #ï¸âƒ£ é—®ç­”é¢˜</h2> <ul><li>ä¸ºä»€ä¹ˆ <code>uint8/int8</code>è‡³ <code>uint256/uint256</code> éƒ½æ˜¯ä»¥ 8 çš„å€æ•°é€’å¢ï¼Œä¸”æœ€å¤§å€¼æ˜¯ 256ã€‚
<ul><li>1 å­—èŠ‚æ˜¯ 8 ä½ï¼Œæ‰€ä»¥åé¢ 8,16,éƒ½éœ€è¦æ˜¯ 8 çš„æ•´æ•°å€ï¼Œint8 æ˜¯ 8 ä½ã€‚EVM ä¸ºåœ°å€è®¾ç½®çš„æœ€å¤§é•¿åº¦æ˜¯ 256 ä½ï¼Œæ‰€ä»¥æœ€å¤§å€¼æ˜¯<code>uint256/uint256</code>ã€‚</li></ul></li> <li>ä¸ºä»€ä¹ˆ <code>uint256</code> çš„æœ€å¤§å€¼æ˜¯ <code>2**256 -1</code>ï¼Œè€Œä¸æ˜¯ <code>2**256</code> å‘¢ï¼Ÿ
<ul><li>1 å­—èŠ‚æ˜¯ 8 ä½ï¼Œint8 æ˜¯ 8 ä½ï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºä¸º<code>0000 0000</code>è‡³<code>1000 0000</code>ï¼Œç¬¬ä¸€ä½æ˜¯ç¬¦å·ä½;ç¬¬ä¸€ä½ä¸º 0 æ˜¯æ­£å€¼ï¼Œç¬¬ä¸€ä½ä¸º 1 æ˜¯è´Ÿå€¼ï¼›å› ä¸º int8 æ€»å…±èƒ½å¤Ÿè¡¨ç¤º 2 çš„ 8 æ¬¡æ–¹ï¼Œæ‰€ä»¥å¸¦ç¬¦å·çš„æ­£å€¼ä¸º 128 ä¸ªæ•°ï¼Œè´Ÿå€¼ä¸º 128 ä¸ªæ•°ï¼›</li> <li>è®¡ç®—æœºé‡Œæ˜¯å°† 0 ç®—åœ¨æ­£å€¼å†…ï¼Œè´Ÿå€¼çš„èŒƒå›´è¿˜æ˜¯-128ï¼›ä½†æ˜¯ <strong>0 ä¸æ˜¯æ­£æ•°ä¹Ÿä¸æ˜¯è´Ÿæ•°</strong>ï¼Œæ‰€ä»¥æ­£å€¼èŒƒå›´å°‘äº†ä¸€ä¸ªä½ç½®ï¼Œå°±å‰© 127 ä¸ªä½ç½®äº†ã€‚</li></ul></li> <li>è®¡ç®—æœºä¸­ å­—èŠ‚ &amp; bit &amp; åå…­è¿›åˆ¶æ•°å­—çš„å…³ç³»
<ul><li>bytes1 æ˜¯æŒ‡ 1 ä¸ªå­—èŠ‚ï¼Œ1 ä¸ªå­—èŠ‚å¯ä»¥è¡¨ç¤ºæˆ 2 ä¸ªè¿ç»­çš„ 16 è¿›åˆ¶æ•°å­—ã€‚æœ€å¤§å€¼æ˜¯ <code>0xff</code></li> <li>bytes1 æ˜¯æŒ‡ 1 ä¸ªå­—èŠ‚ï¼Œ1 ä¸ªå­—èŠ‚å¯ä»¥è¡¨ç¤ºæˆ 8 ä¸ªè¿ç»­çš„ bit æ•°å­—ã€‚æœ€å¤§å€¼æ˜¯ <code>11111111</code> <ul><li><code>bytes1</code> ç­‰äºä¸¤ä½è¿ç»­çš„åå…­è¿›åˆ¶æ•°å­— <code>0xXX</code></li></ul></li> <li>8 ä¸ª bit æœ€å¤§å€¼æ˜¯ <code>11111111</code>,8 ä¸ª bit å¯¹åº” 2 ä¸ªè¿ç»­çš„åå…­è¿›åˆ¶æ•°å­—ï¼Œæœ€å¤§æ˜¯ <code>0xff</code>;
<ul><li><code>uint8</code> ç­‰äºä¸¤ä½è¿ç»­çš„åå…­è¿›åˆ¶æ•°å­— <code>0xXX</code></li></ul></li></ul></li> <li>Solidity çš„å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹åˆ†åˆ«æœ‰å“ªäº›ï¼Ÿ
<ul><li>å€¼ç±»å‹
<ul><li>boolean</li> <li>integer æ•´å‹</li> <li>integer æ•´å‹å­—é¢é‡<code>123_456_789</code>/<code>uint8 public a = (2**800 + 1) - 2**800;</code></li> <li>Fixed å®šé•¿æµ®ç‚¹å‹,å¯ä»¥å£°æ˜å®šé•¿æµ®ç‚¹å‹çš„å˜é‡ï¼Œä½†ä¸èƒ½ç»™å®ƒä»¬èµ‹å€¼æˆ–æŠŠå®ƒä»¬èµ‹å€¼ç»™å…¶ä»–å˜é‡ã€‚</li> <li>BytesN å®šé•¿å­—èŠ‚æ•°ç»„</li> <li>å­—ç¬¦ä¸²å­—é¢é‡ï¼Œæ¯”å¦‚ <code>bytes1 public a8 = &quot;a&quot;;</code>,ä¹ŸåŒ…æ‹¬ unicode å­—é¢å¸¸é‡ã€‚</li> <li>åå…­è¿›åˆ¶å­—é¢å¸¸é‡<div class="language- extra-class"><pre class="language-text"><code>contract Test {
    string public a1 = &quot;a&quot;;
    bytes1 public a2 = &quot;a&quot;;
    bytes1 public a3 = 0x61;
    bytes1 public a4 = hex&quot;61&quot;;
}
</code></pre></div></li> <li>Enum:æšä¸¾</li> <li>ç”¨æˆ·å®šä¹‰çš„å€¼ç±»å‹;ç”¨æˆ·å®šä¹‰å€¼ç±»å‹ä½¿ç”¨ type UserType is DefaultType æ¥å®šä¹‰ï¼Œå…¶ä¸­ UserType æ˜¯æ–°å¼•å…¥çš„ç±»å‹çš„åç§°ï¼Œ DefaultType å¿…é¡»æ˜¯å†…ç½®çš„å€¼ç±»å‹ï¼ˆâ€åº•å±‚ç±»å‹â€ï¼‰ã€‚</li> <li>åœ°å€ç±»å‹/åˆç±»å‹çº¦</li> <li>å‡½æ•°ç±»å‹</li></ul></li> <li>å¼•ç”¨ç±»å‹
<ul><li>array</li> <li>bytesï¼ˆbytes å’Œ bytes32[] åŒºåˆ«ï¼‰</li> <li>string</li> <li>mapping</li> <li>struct</li></ul></li></ul></li></ul> <p><strong>int/uint</strong></p> <ul><li><p>å¦‚ä½•è·å–æ•´å‹çš„æœ€å¤§å€¼å’Œæœ€å°å€¼</p> <ul><li>å¯ä»¥ä½¿ç”¨ <code>type(int8).max</code> è·å–è¯¥ç±»å‹çš„æœ€å¤§å€¼</li> <li>å¯ä»¥ä½¿ç”¨ <code>type(int8).min</code> è·å–è¯¥ç±»å‹çš„æœ€å°å€¼</li></ul></li> <li><p>èŠä¸€èŠ <code>checked</code> å’Œ <code>unchecked</code></p> <ul><li>0.8.0 å¼€å§‹ï¼Œç®—æœ¯è¿ç®—æœ‰ä¸¤ç§è®¡ç®—æ¨¡å¼ï¼šä¸€ç§æ˜¯<code>checked</code>ï¼ˆæ£€æŸ¥ï¼‰æ¨¡å¼ï¼Œå¦ä¸€ç§æ˜¯ <code>unchecked</code>ï¼ˆä¸æ£€æŸ¥ï¼‰æ¨¡å¼ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œç®—æœ¯è¿ç®—åœ¨ <code>checked</code> æ¨¡å¼ä¸‹ï¼Œå³éƒ½ä¼šè¿›è¡Œæº¢å‡ºæ£€æŸ¥ï¼Œå¦‚æœç»“æœè½åœ¨å–å€¼èŒƒå›´ä¹‹å¤–ï¼Œè°ƒç”¨ä¼šé€šè¿‡ å¤±è´¥å¼‚å¸¸ å›é€€ã€‚ ä½ ä¹Ÿå¯ä»¥é€šè¿‡ <code>unchecked{ ... }</code> åˆ‡æ¢åˆ° â€œuncheckedâ€æ¨¡å¼ï¼Œæ›´å¤šå¯å‚è€ƒ <code>unchecked</code> .</li> <li>ç°åœ¨ä¸éœ€è¦å› ä¸º safeMath åº“äº†ã€‚</li></ul></li> <li><p>ä¸‹é¢ä»£ç ä¼šæŠ¥é”™ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p> <div class="language- extra-class"><pre class="language-text"><code>uint8 public a = (2**800 + 1) - 2**800; // 1
uint8 public b = 0.5 * 8; // 4
uint8 public c = 2.5 + b + 0.5;
</code></pre></div><ul><li><code>(2**800 + 1) - 2**800</code> çš„ç»“æœæ˜¯å­—é¢å¸¸é‡ 1 ï¼ˆå±äº uint8 ç±»å‹ï¼‰ï¼Œå°½ç®¡è®¡ç®—çš„ä¸­é—´ç»“æœå·²ç»è¶…è¿‡äº† ä»¥å¤ªåŠè™šæ‹Ÿæœºçš„æœºå™¨å­—é•¿åº¦ã€‚ æ­¤å¤–ï¼Œ <code>.5 * 8</code> çš„ç»“æœæ˜¯æ•´å‹ <code>4</code> ï¼ˆå°½ç®¡æœ‰éæ•´å‹å‚ä¸äº†è®¡ç®—ï¼‰ã€‚</li> <li>å°½ç®¡æˆ‘ä»¬çŸ¥é“ b çš„å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä½† <code>2.5 + a</code> è¿™éƒ¨åˆ†è¡¨è¾¾å¼å¹¶ä¸è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œå› æ­¤ç¼–è¯‘ä¸èƒ½é€šè¿‡ã€‚</li></ul></li> <li><p>ä¸‹é¢ä»£ç ä¸­çš„<code>c1</code>/<code>c2</code>ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</p> <div class="language- extra-class"><pre class="language-text"><code>uint256 a = 1;
uint256 b = 4;
uint256 c1 = (1 / 4) * 4; // 1 =&gt; æœªæˆªæ–­
uint256 c2 = (a / b) * b; // 0 =&gt; æˆªæ–­
</code></pre></div><ul><li>æ•´æ•°çš„é™¤æ³•ä¼šè¢«æˆªæ–­ï¼ˆä¾‹å¦‚ï¼š<code>1/4</code> ç»“æœä¸º 0ï¼‰,ä½†æ˜¯ä½¿ç”¨å­—é¢é‡çš„æ–¹å¼ä¸ä¼šè¢«æˆªæ–­</li></ul></li> <li><p>ä¸‹é¢ä¸¤ä¸ªå‡½æ•°éƒ½ä¼šè¿è¡ŒæˆåŠŸä¹ˆï¼Ÿ</p> <div class="language- extra-class"><pre class="language-text"><code>function test1() public pure returns (int256 a) {
    a = type(int256).min / (-2);
}

// VM error: revert.
function test2() public pure returns (int256 a) {
    a = type(int256).min / (-1);
}
</code></pre></div><ul><li>è¡¨è¾¾å¼ <code>type(int).min / (-1)</code> æ˜¯ä»…æœ‰çš„æ•´é™¤ä¼šå‘ç”Ÿå‘ä¸Šæº¢å‡ºçš„æƒ…å†µã€‚ åœ¨ç®—æœ¯æ£€æŸ¥æ¨¡å¼ä¸‹ï¼Œè¿™ä¼šè§¦å‘ä¸€ä¸ªå¤±è´¥å¼‚å¸¸ï¼Œåœ¨æˆªæ–­æ¨¡å¼ä¸‹ï¼Œè¡¨è¾¾å¼çš„å€¼å°†æ˜¯ <code>type(int).min</code> ã€‚</li></ul></li> <li><p>ä¸‹é¢ä¾‹å­è¾“å‡ºä»€ä¹ˆï¼Ÿ</p> <ul><li>ä½ å¯èƒ½è®¤ä¸ºåƒ<code>255 + (true ? 1 : 0)</code> æˆ– <code>255 + [1, 2, 3][0]</code> è¿™æ ·çš„è¡¨è¾¾å¼ç­‰åŒäºç›´æ¥ä½¿ç”¨ 256 å­—é¢å¸¸é‡ã€‚ ä½†äº‹å®ä¸Šï¼Œå®ƒä»¬æ˜¯åœ¨ <code>uint8</code> ç±»å‹ä¸­è®¡ç®—çš„ï¼Œä¼šæº¢å‡ºã€‚</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// VM error: revert.
function testA1() public pure returns (uint256 a) {
    a = 255 + (true ? 1 : 0);
}

function testA2() public pure returns (uint256 a) {
    a = (true ? 1 : 0) + 255;
}

// VM error: revert.
function testB1() public pure returns (uint256 a) {
    a = 255 + [1, 2, 3][0];
}

function testB2() public pure returns (uint256 a) {
    a = [1, 2, 3][0] + 255;
}

function testA3() public pure returns (uint256 a) {
    a = 255 + uint256(true ? 1 : 0);
}

function testB3() public pure returns (uint256 a) {
    a = 255 + uint256([1, 2, 3][0]);
}
</code></pre></div></li></ul> <p><strong>BytesN å®šé•¿å­—èŠ‚æ•°ç»„</strong></p> <ul><li><code>bytesN</code> æœ‰å“ªäº›å±æ€§ï¼Œåˆ†åˆ«æ€ä¹ˆä½¿ç”¨ã€‚
<ul><li>å®šä¹‰æ–¹å¼ <code>bytesN</code>ï¼Œå…¶ä¸­ N å¯å– <code>1~32</code> ä¸­çš„ä»»æ„æ•´æ•°;bytes1 ä»£è¡¨åªèƒ½å­˜å‚¨ä¸€ä¸ªå­—èŠ‚ã€‚ä¸€æ—¦å£°æ˜ï¼Œå…¶å†…éƒ¨çš„å­—èŠ‚é•¿åº¦ä¸å¯ä¿®æ”¹ï¼Œå†…éƒ¨å­—èŠ‚ä¸å¯ä¿®æ”¹ã€‚æ³¨æ„è¿™é‡Œ <code>bytes32</code> å’Œ <code>bytes</code> æ˜¯ä¸åŒçš„ã€‚<code>bytes</code> æ˜¯å˜é•¿å­—èŠ‚æ•°ç»„ï¼Œæ˜¯å¼•ç”¨ç±»å‹ã€‚<code>byte</code> æ˜¯ <code>bytes1</code> çš„åˆ«åï¼Œä¸æ¨èä½¿ç”¨ã€‚</li> <li><code>length</code> ï¼ˆåªè¯»ï¼‰
<ul><li>è¿”å›å­—èŠ‚ä¸ªæ•°ï¼Œå¯ä»¥é€šè¿‡ç´¢å¼•è¯»å–å¯¹åº”ç´¢å¼•çš„å­—èŠ‚ã€‚</li></ul></li> <li>ç´¢å¼•è®¿é—®: <code>bytesN[index]</code> <ul><li>index å–å€¼èŒƒå›´<code>[0, N]</code>ï¼Œå…¶ä¸­ N è¡¨ç¤ºé•¿åº¦ã€‚</li> <li>å¦‚æœ <code>x</code> æ˜¯ <code>bytesI</code> ç±»å‹ï¼Œé‚£ä¹ˆ <code>x[k]</code> ï¼ˆå…¶ä¸­ 0 &lt;= k &lt; Iï¼‰è¿”å›ç¬¬ k ä¸ªå­—èŠ‚ï¼ˆåªè¯»ï¼‰ã€‚</li></ul></li></ul></li> <li><code>bytesN</code> æœ‰ä»€ä¹ˆæ–¹æ³•ï¼Ÿ
<ul><li>è‡ªå·±æ²¡æœ‰æ–¹æ³•ï¼Œå¯ä»¥å…¨å±€çš„ï¼Œæ¯”å¦‚ deleteã€‚</li></ul></li> <li><code>&quot;a&quot;</code> æ˜¯å€¼ç±»å‹è¿˜æ˜¯å¼•ç”¨ç±»å‹ï¼Ÿ
<ul><li>æ³¨ï¼šå­—ç¬¦ä¸²å­—é¢å¸¸é‡æ˜¯å€¼ç±»å‹,è¿™ä¸æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚æ¯”å¦‚<code>bytes1 public b1 = &quot;a&quot;;</code></li></ul></li></ul> <p><strong>Unicode</strong></p> <ul><li>æ€ä¹ˆæ ·è¾“å‡ºä¸­æ–‡å­—ç¬¦ä¸²ï¼Ÿï¼ˆ<code>unicode&quot;åŒå¿—ä»¬å¥½&quot;</code>ï¼‰</li></ul> <p><strong>åå…­è¿›åˆ¶å­—é¢å¸¸é‡</strong></p> <ul><li><code>bytes1 public a4 = hex&quot;61&quot;;</code> çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ<code>0x61</code>ï¼‰</li></ul> <p><strong>Enum:æšä¸¾</strong></p> <ul><li>æšä¸¾ç±»å‹çš„ä½¿ç”¨åœºæ™¯
<ul><li><code>enum</code> æ˜¯ä¸€ç§ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºå¤šç§çŠ¶æ€ï¼Œæšä¸¾å¯ç”¨æ¥åˆ›å»ºç”±ä¸€å®šæ•°é‡çš„â€œå¸¸é‡å€¼â€æ„æˆçš„è‡ªå®šä¹‰ç±»å‹ã€‚ä¸»è¦ä½œç”¨æ˜¯ç”¨äºé™åˆ¶æŸä¸ªäº‹åŠ¡çš„æœ‰é™é€‰æ‹©ã€‚æ¯”å¦‚å°†å’–å•¡çš„å®¹é‡å¤§å°é™åˆ¶ä¸ºï¼šå¤§ã€ä¸­ã€å°ï¼Œè¿™å°†ç¡®ä¿ä»»ä½•äººä¸èƒ½è´­ä¹°å…¶ä»–å®¹é‡çš„å’–å•¡ï¼Œåªèƒ½åœ¨è¿™é‡Œé€‰æ‹©ã€‚</li></ul></li> <li>Enum çš„å±æ€§å’Œæ–¹æ³•
<ul><li>é€‰é¡¹ä» 0 å¼€å§‹çš„æ— ç¬¦å·æ•´æ•°å€¼è¡¨ç¤ºã€‚</li> <li><code>type(NameOfEnum).min/max</code></li> <li>delete æ¢å¤é»˜è®¤</li></ul></li> <li>èŠä¸€èŠæšä¸¾ç±»å‹
<ul><li>æšä¸¾ç±»å‹ï¼Œè¿”å›å€¼æ˜¯ç´¢å¼•ï¼Œé»˜è®¤å€¼æ˜¯ 0;</li> <li>æšä¸¾ç±»å‹çš„é»˜è®¤å€¼æ˜¯ç¬¬ä¸€ä¸ªå€¼ã€‚
<ul><li>æšä¸¾ç±»å‹ enum è‡³å°‘åº”è¯¥æœ‰ä¸€åæˆå‘˜ã€‚</li></ul></li> <li>è®¾ç½®çš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½®ä¸ºç´¢å¼•ï¼Œä¹Ÿå¯ä»¥å¯¹åº”çš„æšä¸¾åç§°;</li> <li>æšä¸¾ç±»å‹ enum å¯ä»¥ä¸æ•´æ•°è¿›è¡Œæ˜¾å¼è½¬æ¢ï¼Œä½†ä¸èƒ½è¿›è¡Œéšå¼è½¬æ¢ã€‚
<ul><li>æ˜¾ç¤ºè½¬æ¢ä¼šåœ¨è¿è¡Œæ—¶æ£€æŸ¥æ•°å€¼èŒƒå›´ï¼Œå¦‚æœä¸åŒ¹é…ï¼Œå°†ä¼šå¼•èµ·å¼‚å¸¸ã€‚</li></ul></li> <li>å¾ˆå¤šäººæ„Ÿè§‰ enum å¾ˆå°‘ç”¨ï¼Œä¸€æ˜¯å› ä¸ºåº”ç”¨åœºæ™¯ç¡®å®æ¯”è¾ƒçª„ï¼ŒäºŒæ˜¯å› ä¸ºå¯ä»¥è¢«å…¶ä»–æ•°æ®ç±»å‹æ‰€ä»£æ›¿ï¼›ä½†æŒ‰ç…§ç¼–ç è§„èŒƒï¼Œé™åˆ¶é€‰æ‹©èŒƒå›´åœºæ™¯ï¼Œé™¤äº† bool ä»¥å¤–çš„ï¼Œæ¨èä½¿ç”¨ enum ç±»å‹æ¥å®šä¹‰ã€‚</li></ul></li></ul> <p><strong>UserType ç”¨æˆ·å®šä¹‰çš„å€¼ç±»å‹</strong></p> <ul><li>èŠä¸€èŠ UserTypeã€‚
<ul><li>ç”¨æˆ·å®šä¹‰å€¼ç±»å‹ä½¿ç”¨ <code>type UserType is DefaultType</code> æ¥å®šä¹‰ï¼Œå…¶ä¸­ <code>UserType</code> æ˜¯æ–°å¼•å…¥çš„ç±»å‹çš„åç§°ï¼Œ <code>DefaultType</code> å¿…é¡»æ˜¯å†…ç½®çš„å€¼ç±»å‹ï¼ˆâ€åº•å±‚ç±»å‹â€ï¼‰ã€‚è‡ªå®šä¹‰ç±»å‹çš„å€¼çš„æ•°æ®è¡¨ç¤ºåˆ™ç»§æ‰¿è‡ªåº•å±‚ç±»å‹ï¼Œå¹¶ä¸” ABI ä¸­ä¹Ÿä½¿ç”¨åº•å±‚ç±»å‹ã€‚</li> <li>âš ï¸: ç”¨æˆ·å®šä¹‰çš„ç±»å‹ <code>UserType</code> æ²¡æœ‰ä»»ä½•è¿ç®—ç¬¦æˆ–ç»‘å®šæˆå‘˜å‡½æ•°ã€‚å³ä½¿æ˜¯æ“ä½œç¬¦ <code>==</code> ä¹Ÿæ²¡æœ‰å®šä¹‰ã€‚ä¹Ÿä¸å…è®¸ä¸å…¶ä»–ç±»å‹è¿›è¡Œæ˜¾å¼å’Œéšå¼è½¬æ¢ã€‚</li></ul></li> <li>UserType æœ‰å±æ€§ä¹ˆï¼Ÿæœ‰æ–¹æ³•ä¹ˆï¼Ÿ
<ul><li><code>UserType.wrap()</code></li> <li><code>UserType.unwrap()</code></li></ul></li></ul> <p><strong>address</strong></p> <ul><li><code>address</code> å’Œ <code>address payable</code> æœ‰ä»€ä¹ˆåŒºåˆ«
<ul><li><code>address</code>ï¼šä¿å­˜ä¸€ä¸ª 20 å­—èŠ‚çš„å€¼ï¼ˆä»¥å¤ªåŠåœ°å€çš„å¤§å°ï¼‰ã€‚</li> <li><code>address payable</code> ï¼šå¯æ”¯ä»˜åœ°å€ï¼Œä¸ <code>address</code> ç›¸åŒï¼Œä¸è¿‡æœ‰æˆå‘˜å‡½æ•° <code>transfer</code> å’Œ <code>send</code> ã€‚</li> <li>å¦‚æœä½ éœ€è¦ <code>address</code> ç±»å‹çš„å˜é‡ï¼Œå¹¶è®¡åˆ’å‘é€ä»¥å¤ªå¸ç»™è¿™ä¸ªåœ°å€ï¼Œé‚£ä¹ˆå£°æ˜ç±»å‹ä¸º <code>address payable</code> å¯ä»¥æ˜ç¡®è¡¨è¾¾å‡ºä½ çš„éœ€æ±‚ã€‚ åŒæ ·ï¼Œå°½é‡æ›´æ—©å¯¹ä»–ä»¬è¿›è¡ŒåŒºåˆ†æˆ–è½¬æ¢ã€‚</li> <li>è¿™ç§åŒºåˆ«èƒŒåçš„æ€æƒ³æ˜¯ <code>address payable</code> å¯ä»¥å‘å…¶å‘é€ä»¥å¤ªå¸ï¼Œè€Œä¸èƒ½å‘ä¸€ä¸ªæ™®é€šçš„ <code>address</code> å‘é€ä»¥å¤ªå¸ã€‚æ¯”å¦‚ï¼Œå®ƒå¯èƒ½æ˜¯ä¸€ä¸ªæ™ºèƒ½åˆçº¦åœ°å€ï¼Œå¹¶ä¸”ä¸æ”¯æŒæ¥æ”¶ä»¥å¤ªå¸ã€‚</li></ul></li> <li>address ç±»å‹åˆ†åˆ«æœ‰ä»€ä¹ˆå±æ€§ï¼Ÿä»‹ç»ä¸€ä¸‹ç”¨é€”
<ol><li>.balance : ä»¥ Wei ä¸ºå•ä½çš„ä½™é¢ã€‚<div class="language- extra-class"><pre class="language-text"><code>&lt;address&gt;.balance    returns(uint256)
</code></pre></div></li> <li>.code : åœ°å€ä¸Šçš„ä»£ç (å¯ä»¥ä¸ºç©º)<div class="language- extra-class"><pre class="language-text"><code>&lt;address&gt;.code        returns(bytes memory)
</code></pre></div></li> <li>.codehash : åœ°å€çš„ codehash<div class="language- extra-class"><pre class="language-text"><code>&lt;address&gt;.codehash    returns(bytes32)
</code></pre></div></li></ol></li> <li>address ç±»å‹æœ‰å“ªäº›æ–¹æ³•ä»¥åŠå„è‡ªçš„ä½œç”¨ã€‚
<ol><li><code>address()</code>: å¯ä»¥å°†åœ°å€è½¬æ¢åˆ°åœ°å€ç±»å‹ã€‚</li> <li><code>payable()</code>: å°†æ™®é€šåœ°å€è½¬ä¸ºå¯æ”¯ä»˜åœ°å€ã€‚
<ol><li>ä» <code>address</code> åˆ° <code>address payable</code> çš„è½¬æ¢ã€‚å¯ä»¥é€šè¿‡ <code>payable(x)</code> è¿›è¡Œ ï¼Œå…¶ä¸­ <code>x</code> å¿…é¡»æ˜¯ <code>address</code> ç±»å‹ã€‚</li></ol></li> <li><code>.transfer(uint256 amount)</code>: å°†ä½™é¢è½¬åˆ°å½“å‰åœ°å€ï¼ˆåˆçº¦åœ°å€è½¬è´¦ï¼‰<div class="language- extra-class"><pre class="language-text"><code>&lt;address payable&gt;.transfer(uint256 amount)
</code></pre></div><ol><li>å¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸, ç­‰ä»·äº<code>require(send())</code> ä½¿ç”¨å›ºå®šï¼ˆä¸å¯è°ƒèŠ‚ï¼‰çš„ 2300 gas çš„çŸ¿å·¥è´¹ï¼Œé”™è¯¯ä¼š reverts</li> <li>éœ€è¦ payable address</li></ol></li> <li><code>.send(uint256 amount)</code>: å°†ä½™é¢è½¬åˆ°å½“å‰åœ°å€ï¼Œå¹¶<strong>è¿”å›äº¤æ˜“æˆåŠŸçŠ¶æ€</strong>ï¼ˆåˆçº¦åœ°å€è½¬è´¦ï¼‰<div class="language- extra-class"><pre class="language-text"><code>&lt;address payable&gt;.send(uint256 amount) returns (bool)
</code></pre></div><ol><li>å¤±è´¥æ—¶ä»…ä¼šè¿”å› <code>false</code>ï¼Œä¸ä¼šç»ˆæ­¢æ‰§è¡Œï¼ˆåˆçº¦åœ°å€è½¬è´¦ï¼‰;ä½¿ç”¨å›ºå®šï¼ˆä¸å¯è°ƒèŠ‚ï¼‰çš„ 2300 gas çš„çŸ¿å·¥è´¹ã€‚</li> <li>éœ€è¦ payable address</li> <li>è¡¥å……ï¼šsend ä¸ transfer å¯¹åº”ï¼Œä½† <strong>send æ›´åº•å±‚</strong>ã€‚å¦‚æœæ‰§è¡Œå¤±è´¥ï¼Œtransfer ä¸ä¼šå› å¼‚å¸¸åœæ­¢ï¼Œè€Œ send ä¼šè¿”å› falseã€‚transfer ç›¸å¯¹ send è¾ƒå®‰å…¨</li> <li>send() æ‰§è¡Œæœ‰ä¸€äº›é£é™©ï¼šå¦‚æœè°ƒç”¨æ ˆçš„æ·±åº¦è¶…è¿‡ 1024 æˆ– gas è€—å…‰ï¼Œäº¤æ˜“éƒ½ä¼šå¤±è´¥ã€‚å› æ­¤ï¼Œä¸ºäº†ä¿è¯å®‰å…¨ï¼Œå¿…é¡»æ£€æŸ¥ send çš„è¿”å›å€¼ï¼Œå¦‚æœäº¤æ˜“å¤±è´¥ï¼Œä¼šå›é€€ä»¥å¤ªå¸ã€‚</li></ol></li> <li><code>.call(bytes memory)</code>: ç”¨ç»™å®šçš„æœ‰æ•ˆè½½è·ï¼ˆpayloadï¼‰å‘å‡ºä½çº§ <code>CALL</code> è°ƒç”¨ï¼Œå¹¶<strong>è¿”å›äº¤æ˜“æˆåŠŸçŠ¶æ€å’Œè¿”å›æ•°æ®</strong>ï¼ˆè°ƒç”¨åˆçº¦çš„æ–¹æ³•å¹¶è½¬è´¦ï¼‰<div class="language- extra-class"><pre class="language-text"><code>&lt;address&gt;.call(bytes memory) returns (bool, bytes memory)
</code></pre></div><ol><li>å‘é€æ‰€æœ‰å¯ç”¨ gasï¼Œä¹Ÿå¯ä»¥è‡ªå·±è°ƒèŠ‚ gasã€‚</li> <li>è¿”å›ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ª <code>bool</code> å€¼ä»£è¡¨æˆåŠŸæˆ–è€…å¤±è´¥ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å¯èƒ½å­˜åœ¨çš„ <code>data</code></li> <li>ä½çº§ <code>CALL</code> è°ƒç”¨ï¼šä¸éœ€è¦ payable address, æ™®é€šåœ°å€å³å¯</li></ol></li> <li><code>.delegatecall(bytes memory)</code>: ç”¨ç»™å®šçš„æœ‰æ•ˆè½½è·ï¼ˆpayloadï¼‰å‘å‡ºä½çº§ <code>DELEGATECALL</code> è°ƒç”¨ï¼Œå¹¶<strong>è¿”å›äº¤æ˜“æˆåŠŸçŠ¶æ€å’Œè¿”å›æ•°æ®</strong>ï¼ˆè°ƒç”¨åˆçº¦çš„æ–¹æ³•å¹¶è½¬è´¦ï¼‰<div class="language- extra-class"><pre class="language-text"><code>&lt;address&gt;.delegatecall(bytes memory) returns (bool, bytes memory)
</code></pre></div><ol><li>å‘å‡ºä½çº§å‡½æ•° <code>DELEGATECALL</code>ï¼Œå¤±è´¥æ—¶è¿”å› falseï¼Œå‘é€æ‰€æœ‰å¯ç”¨ gasï¼Œä¹Ÿå¯ä»¥è‡ªå·±è°ƒèŠ‚ gasã€‚</li></ol></li> <li><code>staticcall(bytes memory)</code>: ç”¨ç»™å®šçš„æœ‰æ•ˆè½½è·ï¼ˆpayloadï¼‰å‘å‡ºä½çº§ <code>STATICCALL</code> è°ƒç”¨ï¼Œå¹¶<strong>è¿”å›äº¤æ˜“æˆåŠŸçŠ¶æ€å’Œè¿”å›æ•°æ®</strong>ï¼ˆè°ƒç”¨åˆçº¦çš„æ–¹æ³•å¹¶è½¬è´¦ï¼‰<div class="language- extra-class"><pre class="language-text"><code>&lt;address&gt;.staticcall(bytes memory) returns (bool, bytes memory)
</code></pre></div><ol><li>å‘é€æ‰€æœ‰å¯ç”¨ gasï¼Œä¹Ÿå¯ä»¥è‡ªå·±è°ƒèŠ‚ gasã€‚</li></ol></li></ol></li> <li>åœ°å€çš„ä¸‰ç§è½¬å¸æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿtransfer / send /call
<ul><li>ç›¸åŒç‚¹
<ul><li>ä¸‰ç§æ–¹æ³•éƒ½å¯ä»¥è¿›è¡Œè½¬è´¦</li> <li><code>_to.transfer(100)</code>ã€<code>_to.send(100)</code>ã€<code>_to.call{value: 100}(&quot;&quot;)</code> çš„æ¥æ”¶æ–¹éƒ½æ˜¯<code>_to</code>ã€‚
<ul><li>å¦‚æœ<code>_to</code>åˆçº¦ä¸­å¿…é¡»å¢åŠ  <code>fallback</code> æˆ–è€… <code>receive</code> å‡½æ•°ï¼</li> <li>å¦åˆ™æŠ¥é”™<code>In order to receive Ether transfer the contract should have either 'receive' or payable 'fallback' function</code></li></ul></li></ul></li> <li>ä¸åŒç‚¹:
<ul><li>ä½çº§ <code>CALL</code> è°ƒç”¨ï¼šä¸éœ€è¦ <code>payable address</code> <ul><li>transfer å’Œ send åªèƒ½æ˜¯ <code>payable address</code></li></ul></li> <li><code>call</code> çš„ gas å¯ä»¥åŠ¨æ€è°ƒæ•´
<ul><li>transfer å’Œ send åªèƒ½æ˜¯å›ºå®šåˆ¶ <code>2300</code></li></ul></li> <li><code>call</code> é™¤äº†å¯ä»¥è½¬è´¦å¤–ï¼Œå¯ä»¥è¿˜å¯ä»¥è°ƒç”¨ä¸çŸ¥é“ ABI çš„æ–¹æ³•ï¼Œè¿˜å¯ä»¥è°ƒç”¨çš„æ—¶å€™è½¬è´¦
<ul><li>å½“è°ƒç”¨ä¸å­˜åœ¨çš„åˆçº¦æ–¹æ³•æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹æ–¹åˆçº¦å†…çš„ <code>fallback</code> æˆ–è€… <code>receive</code>ã€‚</li> <li>å¦‚æœä½¿ç”¨ <code>_to.call{value: 100}(data)</code>ï¼Œé‚£ä¹ˆ<code>data</code>ä¸­è¢«è°ƒç”¨çš„æ–¹æ³•å¿…é¡»æ·»åŠ  <code>payable</code> ä¿®é¥°ç¬¦ï¼Œå¦åˆ™è½¬è´¦å¤±è´¥ï¼</li> <li>å› ä¸ºå¯ä»¥è°ƒç”¨æ–¹æ³•ï¼Œæ‰€ä»¥ call æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œé™¤äº†ä¸€ä¸ª <code>bool</code> å€¼ä»£è¡¨æˆåŠŸæˆ–è€…å¤±è´¥ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å¯èƒ½å­˜åœ¨çš„ <code>data</code>ï¼Œæ¯”å¦‚åˆ›å»ºåˆçº¦æ—¶å€™å¾—åˆ°éƒ¨ç½²çš„åœ°å€ï¼Œè°ƒç”¨å‡½æ•°æ—¶å€™å¾—åˆ°çš„å‡½æ•°æ”¾å›å€¼ã€‚</li></ul></li></ul></li></ul></li> <li>delegatecall å’Œ call çš„åŒºåˆ«
<ul><li><code>delegatecall</code> ä½¿ç”¨æ–¹æ³•å’Œ <code>call</code> å®Œå…¨ä¸€æ ·ã€‚åŒºåˆ«åœ¨äºï¼Œ<code>delegatecall</code> åªè°ƒç”¨ç»™å®šåœ°å€çš„ä»£ç ï¼ˆå‡½æ•°ï¼‰ï¼Œå…¶ä»–çŠ¶æ€å±æ€§å¦‚ï¼ˆå­˜å‚¨ï¼Œä½™é¢ â€¦ï¼‰éƒ½æ¥è‡ªå½“å‰åˆçº¦ã€‚<code>delegatecall</code> çš„ç›®çš„æ˜¯ä½¿ç”¨å¦ä¸€ä¸ªåˆçº¦ä¸­çš„åº“ä»£ç ã€‚</li> <li>å§”æ‰˜è°ƒç”¨æ˜¯ï¼š<strong>å§”æ‰˜å¯¹æ–¹è°ƒç”¨è‡ªå·±æ•°æ®çš„</strong>ã€‚ç±»ä¼¼æˆæƒè½¬è´¦ï¼Œæ¯”å¦‚æˆ‘éƒ¨ç½²ä¸€ä¸ª Bank åˆçº¦ï¼Œ æˆæƒ ContractA ä½¿ç”¨ Bank åœ°å€å†…çš„èµ„é‡‘ï¼ŒContractA åªæ‹¥æœ‰æ§åˆ¶æƒï¼Œä½†æ˜¯æ²¡æœ‰æ‹¥æœ‰æƒã€‚</li> <li>å§”æ‰˜è°ƒç”¨åï¼Œæ‰€æœ‰å˜é‡ä¿®æ”¹éƒ½æ˜¯å‘ç”Ÿåœ¨å§”æ‰˜åˆçº¦å†…éƒ¨ï¼Œå¹¶ä¸ä¼šä¿å­˜åœ¨è¢«å§”æ‰˜åˆçº¦ä¸­ã€‚
<ul><li>åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå¯ä»¥é€šè¿‡æ›´æ¢è¢«å§”æ‰˜åˆçº¦ï¼Œæ¥å‡çº§å§”æ‰˜åˆçº¦ã€‚</li></ul></li> <li>å§”æ‰˜è°ƒç”¨åˆçº¦å†…éƒ¨ï¼Œéœ€è¦å’Œè¢«å§”æ‰˜åˆçº¦çš„å†…éƒ¨å‚æ•°å®Œå…¨ä¸€æ ·ï¼Œå¦åˆ™å®¹æ˜“å¯¼è‡´æ•°æ®æ··ä¹±
<ul><li>å¯ä»¥é€šè¿‡é¡ºåºæ¥é¿å…è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æ¨èå®Œå…¨ä¸€æ ·</li></ul></li></ul></li> <li>èŠä¸€èŠä¸‰ç§ä½çº§ call
<ol><li><code>call</code> ï¼Œ <code>delegatecall</code> å’Œ <code>staticcall</code> éƒ½æ˜¯éå¸¸ä½çº§çš„å‡½æ•°ï¼Œåº”è¯¥åªæŠŠå®ƒä»¬å½“ä½œæœ€åä¸€æ‹›æ¥ä½¿ç”¨ï¼Œå®ƒä»¬ç ´åäº† Solidity çš„ç±»å‹å®‰å…¨æ€§ã€‚</li> <li>ä¸‰ç§æ–¹æ³•éƒ½æä¾› <code>gas</code> é€‰é¡¹ï¼Œè€Œ <code>value</code> é€‰é¡¹ä»… <code>call</code> æ”¯æŒ ã€‚æ‰€ä»¥ä¸‰ç§ call é‡Œåªæœ‰ <code>call</code> å¯ä»¥è¿›è¡Œ ETH è½¬è´¦ï¼Œå…¶ä»–ä¸¤ç§ä¸å¯ä»¥è¿›è¡Œè½¬è´¦ã€‚</li> <li>ä¸ç®¡æ˜¯è¯»å–çŠ¶æ€è¿˜æ˜¯å†™å…¥çŠ¶æ€ï¼Œæœ€å¥½é¿å…åœ¨åˆçº¦ä»£ç ä¸­ç¡¬ç¼–ç ä½¿ç”¨çš„ gas å€¼ã€‚è¿™å¯èƒ½ä¼šå¼•å…¥<strong>é”™è¯¯</strong>ï¼Œè€Œä¸” gas çš„æ¶ˆè€—ä¹Ÿæ˜¯åŠ¨æ€æ”¹å˜çš„ã€‚</li> <li>å¦‚æœåœ¨é€šè¿‡ä½çº§å‡½æ•° <code>delegatecall</code> å‘èµ·è°ƒç”¨æ—¶éœ€è¦è®¿é—®å­˜å‚¨ä¸­çš„å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªåˆçº¦çš„å­˜å‚¨å¸ƒå±€éœ€è¦ä¸€è‡´ï¼Œä»¥ä¾¿è¢«è°ƒç”¨çš„åˆçº¦ä»£ç å¯ä»¥æ­£ç¡®åœ°é€šè¿‡å˜é‡åè®¿é—®åˆçº¦çš„å­˜å‚¨å˜é‡ã€‚ è¿™ä¸æ˜¯æŒ‡åœ¨åº“å‡½æ•°è°ƒç”¨ï¼ˆé«˜çº§çš„è°ƒç”¨æ–¹å¼ï¼‰æ—¶æ‰€ä¼ é€’çš„å­˜å‚¨å˜é‡æŒ‡é’ˆéœ€è¦æ»¡è¶³é‚£æ ·æƒ…å†µã€‚</li></ol></li> <li>ç¼–å†™åˆçº¦çš„æ—¶å€™ï¼Œå¦‚æœåœ°å€ä¸æ˜¯ checksum address ,è¯¥æ€ä¹ˆå¤„ç†ï¼Ÿ
<ul><li>é€šè¿‡æµè§ˆå™¨å†…è½¬</li></ul></li> <li>èŠä¸€ä¸‹åˆçº¦ç±»å‹
<ul><li>æ¯ä¸€ä¸ªåˆçº¦å®šä¹‰éƒ½æœ‰ä»–è‡ªå·±çš„ç±»å‹ã€‚</li> <li>å¯ä»¥éšå¼åœ°å°†åˆçº¦è½¬æ¢ä¸ºä»ä»–ä»¬ç»§æ‰¿çš„åˆçº¦ã€‚</li> <li>åˆçº¦å¯ä»¥æ˜¾å¼è½¬æ¢ä¸º <code>address</code> ç±»å‹ã€‚</li> <li>å¯ä»¥è½¬æ¢ä¸º <code>address payable</code> ç±»å‹</li> <li>âš ï¸ æ³¨æ„ï¼šåˆçº¦ä¸æ”¯æŒä»»ä½•è¿ç®—ç¬¦ã€‚</li></ul></li> <li>åˆçº¦çš„å±æ€§
<ul><li><code>type(C).name</code> <ul><li>è·å¾—åˆçº¦å</li></ul></li> <li><code>type(C).creationCode</code> <ul><li>è·å¾—åŒ…å«åˆ›å»ºåˆçº¦å­—èŠ‚ç çš„å†…å­˜å­—èŠ‚æ•°ç»„ã€‚</li> <li>è¯¥å€¼å’Œåˆçº¦å†…ä½¿ç”¨ <code>address(this).code;</code> ç»“æœä¸€æ ·ã€‚</li> <li>å®ƒå¯ä»¥åœ¨å†…è”æ±‡ç¼–ä¸­æ„å»ºè‡ªå®šä¹‰åˆ›å»ºä¾‹ç¨‹ï¼Œå°¤å…¶æ˜¯ä½¿ç”¨ <code>create2</code> æ“ä½œç ã€‚</li> <li>ä¸èƒ½åœ¨åˆçº¦æœ¬èº«æˆ–æ´¾ç”Ÿçš„åˆçº¦è®¿é—®æ­¤å±æ€§ã€‚ å› ä¸ºä¼šå¼•èµ·å¾ªç¯å¼•ç”¨ã€‚</li></ul></li> <li><code>type(C).runtimeCode</code> <ul><li>è·å¾—åˆçº¦çš„è¿è¡Œæ—¶å­—èŠ‚ç çš„å†…å­˜å­—èŠ‚æ•°ç»„ã€‚è¿™æ˜¯é€šå¸¸ç”± <code>C</code> çš„æ„é€ å‡½æ•°éƒ¨ç½²çš„ä»£ç ã€‚</li> <li>å¦‚æœ <code>C</code> æœ‰ä¸€ä¸ªä½¿ç”¨å†…è”æ±‡ç¼–çš„æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆå¯èƒ½ä¸å®é™…éƒ¨ç½²çš„å­—èŠ‚ç ä¸åŒã€‚</li> <li>è¿˜è¦æ³¨æ„åº“åœ¨éƒ¨ç½²æ—¶ä¿®æ”¹å…¶è¿è¡Œæ—¶å­—èŠ‚ç ä»¥é˜²èŒƒå®šæœŸè°ƒç”¨ï¼ˆguard against regular callsï¼‰ã€‚ ä¸ <code>.creationCode</code> æœ‰ç›¸åŒçš„é™åˆ¶ï¼Œä¸èƒ½åœ¨åˆçº¦æœ¬èº«æˆ–æ´¾ç”Ÿçš„åˆçº¦è®¿é—®æ­¤å±æ€§ã€‚ å› ä¸ºä¼šå¼•èµ·å¾ªç¯å¼•ç”¨ã€‚</li></ul></li></ul></li> <li>å¦‚ä½•è·å–åˆçº¦æœ¬èº«çš„ bytecodeï¼Ÿ
<ul><li><code>type(C).creationCode</code></li></ul></li></ul> <p><strong>æ•°æ®ä½ç½®</strong></p> <ul><li><p>èŠä¸€èŠ storage/memory/calldata ä¸‰ç§æ•°æ®ä½ç½®</p> <ul><li>å­˜å‚¨ storage : çŠ¶æ€å˜é‡ä¿å­˜çš„ä½ç½®ï¼Œåªè¦åˆçº¦å­˜åœ¨å°±ä¸€ç›´å­˜å‚¨ï¼</li> <li>å†…å­˜ memory : å³æ•°æ®åœ¨å†…å­˜ä¸­ï¼Œå› æ­¤æ•°æ®ä»…åœ¨å…¶ç”Ÿå‘½å‘¨æœŸå†…ï¼ˆå‡½æ•°è°ƒç”¨æœŸé—´ï¼‰æœ‰æ•ˆã€‚ä¸èƒ½ç”¨äºå¤–éƒ¨è°ƒç”¨ã€‚</li> <li>è°ƒç”¨æ•°æ® calldata : ç”¨æ¥ä¿å­˜å‡½æ•°å‚æ•°çš„ç‰¹æ®Šæ•°æ®ä½ç½®ï¼Œæ˜¯ä¸€ä¸ªåªè¯»ä½ç½®ã€‚
<ul><li>è°ƒç”¨æ•°æ® calldata æ˜¯ä¸å¯ä¿®æ”¹çš„ã€éæŒä¹…çš„å‡½æ•°å‚æ•°å­˜å‚¨åŒºåŸŸï¼Œæ•ˆæœå¤§å¤šç±»ä¼¼ å†…å­˜ memory ã€‚</li> <li>ä¸»è¦ç”¨äºå¤–éƒ¨å‡½æ•°çš„å‚æ•°ï¼Œä½†ä¹Ÿå¯ç”¨äºå…¶ä»–å˜é‡ï¼Œæ— è®ºå¤–éƒ¨å†…éƒ¨å‡½æ•°éƒ½å¯ä»¥ä½¿ç”¨ã€‚</li></ul></li> <li>æ ¸å¿ƒï¼šæ›´æ”¹æ•°æ®ä½ç½®æˆ–ç±»å‹è½¬æ¢å°†å§‹ç»ˆäº§ç”Ÿè‡ªåŠ¨è¿›è¡Œä¸€ä»½æ‹·è´ï¼Œè€Œåœ¨åŒä¸€æ•°æ®ä½ç½®å†…ï¼ˆå¯¹äº å­˜å‚¨ storage æ¥è¯´ï¼‰çš„å¤åˆ¶ä»…åœ¨æŸäº›æƒ…å†µä¸‹è¿›è¡Œæ‹·è´ã€‚</li></ul></li> <li><p>ä¸‰ç§æ•°æ®ä½ç½®ç›¸äº’èµ‹å€¼ï¼Œä»¥åŠç›¸åŒæ•°æ®ä½ç½®ä¹‹é—´èµ‹å€¼éƒ½æ˜¯æ‹·è´ä¹ˆï¼Ÿè¯¦ç»†ä»‹ç»ä¸€ä¸‹ã€‚</p> <ol><li>å°† <strong style="color:blue;">å­˜å‚¨å˜é‡</strong> èµ‹å€¼ç»™ <strong>å­˜å‚¨å˜é‡</strong> (åŒç±»å‹)
<ul><li><code>å€¼ ç±» å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li> <li><code>å¼•ç”¨ç±»å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li></ul></li> <li>å°† <strong style="color:red;">å†…å­˜å˜é‡</strong> èµ‹å€¼ç»™ <strong>å­˜å‚¨å˜é‡</strong> <ul><li><code>å€¼ ç±» å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li> <li><code>å¼•ç”¨ç±»å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li></ul></li> <li>å°† <strong style="color:blue;">å­˜å‚¨å˜é‡</strong> èµ‹å€¼ç»™ å†…å­˜å˜é‡
<ul><li><code>å€¼ ç±» å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li> <li><code>å¼•ç”¨ç±»å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li></ul></li> <li>å°† <strong style="color:red;">å†…å­˜å˜é‡</strong> èµ‹å€¼ç»™ å†…å­˜å˜é‡ (åŒç±»å‹)
<ul><li><code>å€¼ ç±» å‹</code>: åˆ›å»ºä¸€ä¸ªæ–°å‰¯æœ¬ã€‚</li> <li><code>å¼•ç”¨ç±»å‹</code>: ä¸ä¼šåˆ›å»ºå‰¯æœ¬ã€‚(<strong>é‡è¦</strong>)</li></ul></li></ol></li> <li><p>memory å’Œ calldata ä¹‹é—´çš„åŒºåˆ«</p> <ul><li><strong>å‡½æ•°è°ƒç”¨å‡½æ•°æ—¶çš„åŒºåˆ«</strong>:<code>calldataå¯ä»¥éšå¼è½¬æ¢ä¸ºmemory</code></li> <li>calldata å¯ä»¥éšå¼è½¬æ¢ä¸º memory</li> <li>memory ä¸å¯ä»¥éšå¼è½¬æ¢ä¸º calldata</li> <li>ä½œä¸ºå‚æ•°ï¼š
<ul><li>memory å¯ä»¥ä¿®æ”¹å‚æ•°</li> <li>calldata ç¦æ­¢ä¿®æ”¹å‚æ•°</li></ul></li></ul></li></ul> <p><strong>array</strong></p> <ul><li><p>åˆ›å»ºæ•°ç»„çš„æ–¹æ³•æœ‰å“ªäº›ã€‚ï¼ˆå®šé•¿æ•°ç»„ï¼ŒåŠ¨æ€æ•°ç»„ï¼‰</p> <ul><li>å›ºå®šé•¿åº¦æ•°ç»„:åˆ›å»º<div class="language- extra-class"><pre class="language-text"><code>uint256[5] public T1 = [1, 2, 3, 4, 5];
address[5] public A =   [0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926ac];
bytes1[5] public B = [bytes1(0x61)];
</code></pre></div></li> <li>å¯å˜é•¿åº¦æ•°ç»„:åˆ›å»º
<ul><li>æ–¹å¼ 1: <code>uint256[] T1 = [1, 2, 3, 4, 5];</code> <ul><li>è¯¥æ–¹å¼ä¸å¯ä»¥åœ¨å‡½æ•°å†…åˆ›å»º</li></ul></li> <li>æ–¹å¼ 2: <code>uint256[] T2 = new uint256[](5);</code> <ul><li>ç”¨æ–¹å¼ 2 åˆ›å»ºæ•°ç»„æ—¶ï¼Œè‹¥æ•°ç»„ä¸ºæˆå‘˜å˜é‡, åˆ™é»˜è®¤ä¸º storage ç±»å‹ï¼›</li> <li>è‹¥ä¸ºå±€éƒ¨å˜é‡é»˜è®¤ä¸º <code>memory</code> ç±»å‹ï¼Œ<code>memory</code> ç±»å‹çš„æ•°ç»„ï¼Œå¿…é¡»å£°æ˜é•¿åº¦ï¼Œå¹¶ä¸”é•¿åº¦åˆ›å»ºåä¸å¯å˜ã€‚</li> <li><code>push</code> æ–¹æ³•ä¸èƒ½ç”¨åœ¨ <code>memeory</code> çš„æ•°ç»„ä¸Š,åªèƒ½é€ä¸ªç´¢å¼•çš„èµ‹å€¼ã€‚</li></ul></li></ul></li> <li>äºŒç»´æ•°ç»„:åˆ›å»º
<ul><li>ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªé•¿åº¦ä¸º <code>5</code>ï¼Œå…ƒç´ ç±»å‹ä¸º uint çš„åŠ¨æ€æ•°ç»„çš„æ•°ç»„ï¼ˆäºŒç»´æ•°ç»„ï¼‰ï¼Œåº”å£°æ˜ä¸º <code>uint[][5]</code> ï¼ˆæ³¨æ„è¿™é‡Œè·Ÿå…¶å®ƒè¯­è¨€æ¯”ï¼Œæ•°ç»„é•¿åº¦çš„å£°æ˜ä½ç½®æ˜¯åçš„ï¼‰ã€‚åœ¨ Solidity ä¸­ï¼Œ <code>X[3]</code> æ€»æ˜¯ä¸€ä¸ªåŒ…å«ä¸‰ä¸ª X ç±»å‹å…ƒç´ çš„æ•°ç»„ï¼Œå³ä½¿ X æœ¬èº«å°±æ˜¯ä¸€ä¸ªæ•°ç»„.</li> <li><code>uint256[2][3] public T = [[1, 2], [3, 4], [5, 6]];</code></li> <li><code>T.length</code> ä¸º 3</li></ul></li> <li>å…¶å®ƒ
<ul><li><code>uint256[2][] public T = new uint256[2][](10);</code></li></ul></li></ul></li> <li><p>å†…å­˜ä¸­å¦‚ä½•åˆ›å»ºæ•°ç»„</p> <ul><li>å¯ä»¥ä½¿ç”¨ <code>new</code> å…³é”®å­—åœ¨å†…å­˜ä¸­åˆ›å»ºåŠ¨æ€æ•°ç»„ã€‚ä¸å­˜å‚¨æ•°ç»„ç›¸åï¼Œä¸èƒ½é€šè¿‡è®¾ç½® <code>.length</code> æˆå‘˜æ¥è°ƒæ•´å†…å­˜åŠ¨æ€æ•°ç»„çš„é•¿åº¦ã€‚ (<strong>éœ€è¦ä¾‹å­æ¥æ¼”ç¤º</strong>)ã€‚memory ç±»å‹çš„æ•°ç»„é•¿åº¦åˆ›å»ºåä¸å¯å˜ï¼Œä¸èƒ½é€šè¿‡ä¿®æ”¹æˆå‘˜å˜é‡ <code>.push</code> æ”¹å˜ memory æ•°ç»„çš„å¤§å°ã€‚å¿…é¡»æå‰è®¡ç®—æ•°ç»„å¤§å°ï¼Œæˆ–è€…åˆ›å»ºä¸€ä¸ªæ–°çš„å†…å­˜æ•°ç»„å¹¶å¤åˆ¶æ¯ä¸ªå…ƒç´ ã€‚</li> <li>åˆ›å»ºæ ¼å¼: <code>uint256[] memory a = new uint256[](5);</code></li> <li>å†…å­˜ä¸­åˆ›å»ºçš„æ•°ç»„æ˜¯å±€éƒ¨å˜é‡ã€‚</li> <li>å†…å­˜ä¸­ä¸èƒ½åˆ›å»ºåŠ¨æ€æ•°ç»„ï¼Œå¿…é¡»åˆ›å»ºå®šé•¿æ•°ç»„ã€‚</li></ul></li> <li><p>ä¸‹é¢ä»£ç å¯ä»¥æ­£å¸¸è¿è¡Œä¹ˆï¼Ÿå¦‚æœå¯ä»¥ï¼Œå€¼åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p> <ul><li>ç›®å‰éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>å®šé•¿çš„ memory æ•°ç»„å¹¶ä¸èƒ½èµ‹å€¼ç»™å˜é•¿çš„ memory æ•°ç»„</strong>ï¼Œä¸‹é¢çš„ä¾‹å­ f å‡½æ•°æ˜¯æ— æ³•è¿è¡Œçš„ï¼š</li> <li>å¼•å‘äº†ä¸€ä¸ªç±»å‹é”™è¯¯ï¼Œå› ä¸º <code>unint[3] memory</code>ï¼Œä¸èƒ½è½¬æ¢æˆ <code>uint[] memory</code>ã€‚</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Demo {
    uint256[] public x = [1, 3, 4];
    uint256[] public y = [uint256(1), 3, 4];
    uint256[] public z = [uint8(1), 3, 4];

    function f() public pure returns(uint256[] memory x){
        x = [uint256(1), 3, 4];
    }
}
</code></pre></div></li> <li><p>ä¸‹é¢ä»£ç å¯ä»¥æ­£å¸¸è¿è¡Œä¹ˆï¼Ÿ</p> <ul><li>ä¸å¯ä»¥ï¼Œéœ€è¦<code>s([uint256(1), uint256(2)])</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>contract T {
    function t() public {
        s([1, 2]);
    }

    function s(uint256[2] memory _arr) public {}
}
</code></pre></div></li> <li><p>æœ‰å“ªäº›å¯ä»¥æ“ä½œæ•°ç»„çš„æ–¹æ³•ï¼Œåˆ†åˆ«åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿ(<code>push</code> / <code>pop</code> / <code>delete</code>/<code>x[start:end]</code>)</p> <ul><li>push å¢åŠ ï¼Œæ”¹å˜é•¿åº¦</li> <li>pop åˆ é™¤æœ€åä¸€ä½ï¼Œæ”¹å˜é•¿åº¦</li> <li>delete: åˆ é™¤å¯¹åº”çš„ç´¢å¼•ï¼›åˆ é™¤å¹¶ä¸ä¼šæ”¹å˜é•¿åº¦ï¼Œç´¢å¼•ä½ç½®çš„å€¼ä¼šæ”¹ä¸ºé»˜è®¤å€¼ã€‚</li> <li><code>x[start:end]</code>: æ•°ç»„åˆ‡ç‰‡ï¼Œä»…å¯ä½¿ç”¨äº <code>calldata</code> æ•°ç»„.</li></ul></li> <li><p>èƒ½å¦å®ç°ä¸€ä¸ªå®Œå…¨ delete æ•°ç»„çš„æ–¹æ³•ï¼ˆåˆ é™¤æ•°æ®ï¼Œé•¿åº¦æ”¹å˜ï¼‰ï¼Œè¯´ä¸‹å®ç°é€»è¾‘ä¹Ÿå¯ä»¥ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract FunctionOutputs {
    function deletePro(uint256[] memory arr, uint256 _index)
        internal
        pure
        returns (uint256[] memory temp)
    {
        require(_index &lt; arr.length, &quot;index out of bound&quot;);
        temp = new uint256[](arr.length - 1);
        for (uint256 index = 0; index &lt;= temp.length - 1; index++) {
            if (index &gt;= _index) {
                temp[_index] = arr[_index + 1];
            } else {
                temp[index] = arr[index];
            }
        }
    }

    function test()
        external
        pure
        returns (uint256[] memory arr, uint256[] memory temp)
    {
        arr = new uint256[](3);
        arr[0] = 1;
        arr[1] = 2;
        arr[2] = 3;
        assert(arr[0] == 1);
        assert(arr[1] == 2);
        assert(arr[2] == 3);
        assert(arr.length == 3);

        temp = deletePro(arr, 1);
        assert(temp[0] == 1);
        assert(temp[1] == 3);
        assert(temp.length == 2);
    }
}
</code></pre></div></li></ul> <p><strong>bytes</strong></p> <ul><li>bytes çš„åˆ›å»ºæ–¹æ³•æœ‰å“ªäº›ï¼Ÿ
<ul><li>çŠ¶æ€å˜é‡çš„åˆ›å»ºæ–¹å¼<div class="language- extra-class"><pre class="language-text"><code>bytes public welcome = bytes(&quot;1.Welcome&quot;);
</code></pre></div></li> <li>å‡½æ•°ä¸­å¯å˜å­—èŠ‚æ•°ç»„åˆ›å»ºæ–¹å¼ï¼š<div class="language- extra-class"><pre class="language-text"><code>// å¯å˜å­—èŠ‚æ•°ç»„åˆ›å»ºæ–¹å¼
bytes memory temp2 = new bytes(length);
</code></pre></div></li></ul></li> <li><code>bytes</code> <code>bytes32</code> ,å’Œ <code>bytes32[]</code> åŒºåˆ« æ˜¯ä»€ä¹ˆï¼Ÿ
<ul><li><code>abcBytes</code> çš„å€¼æ˜¯: <code>0x616263</code>;</li> <li><code>abcArray</code> çš„å€¼æ˜¯ï¼š<code>[0x61..00,0x62..00,0x63..00]</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>  bytes32[] public abcArray = [bytes1(&quot;a&quot;), bytes1(&quot;b&quot;), bytes1(&quot;c&quot;)];
  // 0x616263
  bytes public abcBytes = bytes(&quot;abc&quot;);
</code></pre></div></li> <li>ä¸‹é¢çš„å€¼åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ<div class="language- extra-class"><pre class="language-text"><code>bytes32[] public abcArray = [bytes1(&quot;a&quot;), bytes1(&quot;b&quot;), bytes1(&quot;c&quot;)];
bytes public abcBytes = bytes(&quot;abc&quot;);
</code></pre></div></li> <li>bytes çš„å€¼å¦‚ä½•ä¿®æ”¹ï¼Ÿï¼ˆ<code>bytesVar[7] = 'x'</code>ï¼‰</li> <li>æœ‰å“ªäº›æ–¹æ³•å¯ä»¥æ“ä½œ <code>bytes</code> ç±»å‹æ•°æ®ï¼Ÿåˆ†åˆ«æ˜¯ä»€ä¹ˆåŠŸèƒ½ï¼Ÿ
<ul><li><code>concat</code>/ <code>push</code> / <code>x[start:end]</code> / <code>delete</code> / <code>bytes()</code></li></ul></li> <li><code>bytes</code> å’Œ <code>string</code> ä¹‹é—´å¦‚ä½•è½¬æ¢ï¼Ÿ
<ul><li>å¯ä»¥ä½¿ç”¨ <code>bytes()</code> æ„é€ å‡½æ•°å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º <code>bytes</code>ã€‚</li> <li>å¯ä»¥ä½¿ç”¨ string() æ„é€ å‡½æ•°å°† bytes è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</li></ul></li> <li>å¦‚ä½•æ¯”è¾ƒä¸¤ä¸ª bytes æ•°æ®æ˜¯å¦ç›¸åŒï¼Ÿ
<ul><li><code>keccak256(welcome2) == keccak256(welcome1);</code></li></ul></li></ul> <p><strong>string</strong></p> <ul><li>å¦‚ä½•ä¿®æ”¹ string ç±»å‹çš„å­—ç¬¦ä¸²ï¼Ÿ
<ul><li>è·å–å­—ç¬¦ä¸²çš„é•¿åº¦
<ul><li><code>bytes(str).length</code>:ä»¥å­—èŠ‚é•¿åº¦è¡¨ç¤ºå­—ç¬¦ä¸²çš„é•¿åº¦</li></ul></li> <li>æŸä¸ªå­—ç¬¦ä¸²ç´¢å¼•çš„å­—èŠ‚ç 
<ul><li><code>bytes1 temp1 = bytes(str)[_index];</code><div class="language- extra-class"><pre class="language-text"><code>function getIndexValue(uint256 _index) public view return(string memory) {
    bytes1 temp1 = bytes(welcome)[_index]; // è¿”å›å›ºå®šé•¿åº¦çš„ bytes1
    bytes memory temp2 = new bytes(1); // å¯å˜å­—èŠ‚æ•°ç»„åˆ›å»ºæ–¹å¼
    temp2[0] = temp1;
    return string(temp2);
}
</code></pre></div></li></ul></li> <li>ä¿®æ”¹å­—ç¬¦ä¸²
<ul><li><code>bytes(s)[7] = 'x'</code></li></ul></li></ul></li> <li>å¦‚ä½•æ¯”è¾ƒä¸¤ä¸ª string ç±»å‹çš„å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Ÿ
<ul><li><code>keccak256(abi.encodePacked(s1)) == keccak256(abi.encodePacked(s2))</code></li> <li><code>keccak256(bytes(s1)) == keccak256(bytes(s2))</code> : æ›´æ¨èè¿™ä¸ªï¼Œçœ gas</li></ul></li></ul> <p><strong>mapping</strong></p> <ul><li><p>mapping ä½¿ç”¨çš„æ—¶å€™æœ‰å“ªäº›éœ€è¦æ³¨æ„çš„ï¼Ÿ</p> <ul><li><code>_KeyType</code>ï¼šå¯ä»¥æ˜¯ä»»ä½•å†…ç½®ç±»å‹ï¼Œæˆ–è€… bytes å’Œ å­—ç¬¦ä¸²ã€‚
<ul><li>ä¸å…è®¸ä½¿ç”¨å¼•ç”¨ç±»å‹æˆ–å¤æ‚å¯¹è±¡</li> <li>é”®æ˜¯å”¯ä¸€çš„ï¼Œå…¶èµ‹å€¼æ–¹å¼ä¸ºï¼š<code>map[a]=test</code>; æ„æ€æ˜¯é”®ä¸º a,å€¼ä¸º testï¼›ã€‚</li></ul></li> <li><code>_ValueType</code>ï¼š å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ã€‚</li> <li>mapping æ”¯æŒåµŒå¥—ã€‚</li> <li>æ˜ å°„çš„æ•°æ®ä½ç½®(data location)åªèƒ½æ˜¯ <code>storage</code>ï¼Œé€šå¸¸ç”¨äºçŠ¶æ€å˜é‡ã€‚</li> <li><code>mapping</code> ä¸èƒ½ç”¨äº <code>public</code> å‡½æ•°çš„å‚æ•°æˆ–è¿”å›ç»“æœ
<ul><li>æ˜ å°„åªèƒ½æ˜¯ å­˜å‚¨ storage çš„æ•°æ®ä½ç½®ï¼Œå› æ­¤åªå…è®¸ä½œä¸ºçŠ¶æ€å˜é‡ æˆ– ä½œä¸ºå‡½æ•°å†…çš„ å­˜å‚¨ storage å¼•ç”¨ æˆ– ä½œä¸ºåº“å‡½æ•°çš„å‚æ•°ã€‚ å®ƒä»¬ä¸èƒ½ç”¨åˆçº¦å…¬æœ‰å‡½æ•°çš„å‚æ•°æˆ–è¿”å›å€¼ã€‚</li> <li>è¿™äº›é™åˆ¶åŒæ ·é€‚ç”¨äºåŒ…å«æ˜ å°„çš„æ•°ç»„å’Œç»“æ„ä½“ã€‚</li></ul></li> <li>æ˜ å°„å¯ä»¥æ ‡è®°ä¸º <code>public</code>ï¼ŒSolidity è‡ªåŠ¨ä¸ºå®ƒåˆ›å»º getter å‡½æ•°ã€‚
<ul><li><code>_KeyType</code> å°†æˆä¸º <code>getter</code> çš„å¿…é¡»å‚æ•°ï¼Œå¹¶ä¸” getter ä¼šè¿”å› <code>_ValueType</code>ã€‚</li> <li>å¦‚æœ <code>ValueType</code> æ˜¯ä¸€ä¸ªæ˜ å°„ã€‚è¿™æ—¶åœ¨ä½¿ç”¨ <code>getter</code> æ—¶å°†éœ€è¦é€’å½’åœ°ä¼ å…¥æ¯ä¸ª <code>KeyType</code> å‚æ•°ï¼Œ</li></ul></li> <li>æ˜ å°„ä¸å“ˆå¸Œè¡¨ä¸åŒçš„åœ°æ–¹ï¼š<strong>åœ¨æ˜ å°„ä¸­,å¹¶ä¸å­˜å‚¨ keyï¼Œè€Œæ˜¯å­˜å‚¨å®ƒçš„ <code>keccak256</code> å“ˆå¸Œå€¼ï¼Œä»è€Œä¾¿äºæŸ¥è¯¢å®é™…çš„å€¼</strong>ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œæ˜ å°„æ˜¯æ²¡æœ‰é•¿åº¦çš„ï¼Œä¹Ÿæ²¡æœ‰ <code>key çš„é›†åˆ</code>æˆ– <code>value çš„é›†åˆ</code>çš„æ¦‚å¿µã€‚æ˜ å°„åªèƒ½æ˜¯å­˜å‚¨çš„æ•°æ®ä½ç½®ï¼Œå› æ­¤åªå…è®¸ä½œä¸ºçŠ¶æ€å˜é‡æˆ–ä½œä¸ºå‡½æ•°å†…çš„å­˜å‚¨å¼•ç”¨ æˆ– ä½œä¸ºåº“å‡½æ•°çš„å‚æ•°ã€‚</li></ul></li> <li><p>mapping å¦‚ä½•è·å–-è®¾ç½®-åˆ é™¤ï¼Ÿ</p> <ul><li><code>balances[msg.sender];</code></li> <li><code>balances[msg.sender] += amount;</code></li> <li><code>delete balances[msg.sender];</code></li></ul></li> <li><p>mapping æ€ä¹ˆåšå±€éƒ¨å˜é‡ï¼Ÿ</p> <ul><li><code>mapping</code> ç±»å‹å¯ä»¥ç”¨åšå±€éƒ¨å˜é‡ï¼Œä½†åªèƒ½å¼•ç”¨çŠ¶æ€å˜é‡ï¼Œè€Œä¸”å­˜å‚¨ä½ç½®ä¸º storageã€‚</li></ul> <div class="language- extra-class"><pre class="language-text"><code>contract Mapping {
  mapping(address =&gt; uint256) public balances;

  function updateBalance() public returns (uint256) {
      // mapping å±€éƒ¨å˜é‡ ref å¼•ç”¨çŠ¶æ€å˜é‡ balances
      mapping(address =&gt; uint256) storage ref = balances;
      ref[msg.sender] = 3;
      return ref[msg.sender];
  }
}
</code></pre></div></li> <li><p>å¦‚ä½•å®ç°ä¸€ä¸ªå¯è¿­ä»£çš„ mappingï¼Ÿ</p> <ul><li>ï¼ˆMapping+arrayï¼‰</li></ul> <div class="language- extra-class"><pre class="language-text"><code>contract Mapping {
  mapping(address =&gt; uint256) public balances;
  mapping(address =&gt; bool) public balancesInserted;
  address[] public balancesKey;

  function set(address _ads, uint256 amount) external {
      balances[_ads] = amount;
      if (!balancesInserted[_ads]) {
          balancesInserted[_ads] = true;
          balancesKey.push(_ads);
      }
  }

  function totalAddress() external view returns (uint256) {
      return balancesKey.length;
  }

  function first() external view returns (uint256) {
      return balances[balancesKey[0]];
  }

  function latest() external view returns (uint256) {
      return balances[balancesKey[balancesKey.length - 1]];
  }

  function get(uint256 i) external view returns (uint256) {
      require(i &lt; balancesKey.length, &quot;length error&quot;);
      return balances[balancesKey[i]];
  }
}
</code></pre></div></li></ul> <p><strong>struct</strong></p> <ul><li><p>struct ä½¿ç”¨çš„æ—¶å€™æœ‰å“ªäº›éœ€è¦æ³¨æ„çš„ï¼Ÿ</p></li> <li><p>struct çš„åˆ›å»ºæ–¹æ³•æœ‰å“ªäº›ï¼Ÿ(3 ç§)</p> <div class="language- extra-class"><pre class="language-text"><code>// ç¬¬ 1 ç§ç”Ÿæˆ
Book memory solidity = Book(&quot;Solidity&quot;, &quot;LiSi&quot;, ++bookId, false, 0);

// ç¬¬ 2 ç§ç”Ÿæˆ
Book memory rust = Book({
    title: &quot;Solidity&quot;,
    author: &quot;LiSi&quot;,
    book_id: ++bookId,
    is_lost: false,
    uv: 0
});

// ç¬¬ 3 ç§ç”Ÿæˆ
Book memory temp;
temp.title = &quot;Solidity&quot;;
temp.author = &quot;LiSi&quot;;
temp.book_id = ++bookId;
</code></pre></div></li> <li><p>struct å¦‚ä½•è·å–-è®¾ç½®-åˆ é™¤ï¼Ÿ</p> <ol><li>å‡½æ•°å†…ä»…è¯»å–ç»“æ„ä½“ï¼Œå˜é‡ä½¿ç”¨ memory: <code>Book memory _book = bookcase[_index];</code> <ol><li>å‡½æ•°å†…è¯»å–å¹¶è¿”å›,å¦‚æœä½¿ç”¨ memory å˜é‡æ¥æ”¶:ä»çŠ¶æ€å˜é‡æ‹·è´åˆ°å†…å­˜ä¸­ï¼Œç„¶åå†…å­˜ä¸­çš„å˜é‡æ‹·è´åˆ°è¿”å›å€¼ã€‚ä¸¤æ¬¡æ‹·è´ï¼Œæ¶ˆè€— gas å¤š
<ol><li><code>Todo memory temp = list[_index];</code></li></ol></li> <li>å‡½æ•°å†…è¯»å–å¹¶è¿”å›,å¦‚æœä½¿ç”¨ storage å˜é‡æ¥æ”¶:ç›´æ¥ä»çŠ¶æ€å˜é‡è¯»å–ï¼ŒçŠ¶æ€å˜é‡æ‹·è´åˆ°è¿”å›å€¼ã€‚1 æ¬¡æ‹·è´ï¼Œæ¶ˆè€— gas å°</li> <li>æ€»ç»“: è¯»å–æ—¶å€™æ¨èä½¿ç”¨ <code>storage</code></li></ol></li> <li>å‡½æ•°å†…è·å–å¹¶ä¿®æ”¹ç»“æ„ä½“ï¼Œå˜é‡ä½¿ç”¨ storage<div class="language- extra-class"><pre class="language-text"><code>Book storage _book = bookcase[_index]; // å› ä¸ºè¦ä¿®æ”¹çŠ¶æ€å˜é‡ï¼Œæ‰€ä»¥ä½¿ç”¨ storage
_book.author = &quot;Anbang&quot;;
</code></pre></div><ul><li>å‡½æ•°å†…ç›´æ¥ä¿®æ”¹å˜é‡;åœ¨ä¿®æ”¹ä¸€ä¸ªå±æ€§æ—¶æ¯”è¾ƒçœ Gas è´¹ç”¨</li> <li>å‡½æ•°å†…å…ˆè·å–å­˜å‚¨åˆ° storage å†ä¿®æ”¹:ä¿®æ”¹å¤šä¸ªå±æ€§çš„æ—¶å€™æ¯”è¾ƒçœ Gas è´¹ç”¨</li></ul></li> <li>åˆ é™¤ç»“æ„ä½“çš„å˜é‡ï¼Œä»…ä»…æ˜¯é‡ç½®æ•°æ®ï¼Œå¹¶ä¸æ˜¯å®Œå…¨çš„åˆ é™¤ã€‚</li></ol></li> <li><p>å‡½æ•°å†…ä½¿ç”¨ structï¼Œæ ‡è®° <code>memory</code> / <code>storage</code> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p> <ul><li>å‡½æ•°å†…è¯»å–æ—¶ï¼Œæ ‡è®° <code>memory</code> / <code>storage</code>,ä¼šäº§ç”Ÿå®Œå…¨ä¸åŒçš„ç»“æœï¼›</li> <li>ç‰¹åˆ«æ³¨æ„ï¼š<strong>å¦‚æœç»“æ„ä½“å†…åŒ…å« <code>mapping</code> ç±»å‹ï¼Œåˆ™å¿…é¡»ä½¿ç”¨ <code>storage</code>ï¼Œä¸å¯ä»¥ä½¿ç”¨ memeory.</strong>ï¼Œ</li></ul></li> <li><p>èŠä¸€ä¸‹ä¼—ç­¹åˆçº¦çš„å®ç°é€»è¾‘</p></li></ul> <p><strong>ç±»å‹è½¬æ¢</strong></p> <ul><li>éšå¼è½¬æ¢çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ
<ul><li>éšå¼è½¬æ¢çš„åœºæ™¯: åœ¨èµ‹å€¼, å‚æ•°ä¼ é€’ç»™å‡½æ•°ä»¥åŠåº”ç”¨è¿ç®—ç¬¦æ—¶ã€‚</li> <li>éšå¼è½¬æ¢çš„åœºæ™¯:
<ul><li>å¯ä»¥è¿›è¡Œå€¼ç±»å‹ä¹‹é—´çš„éšå¼è½¬æ¢</li> <li>ä¸ä¼šä¸¢å¤±ä»»ä½•ä¿¡æ¯</li></ul></li> <li>ä¾‹å¦‚ï¼Œ<code>uint8</code> å¯ä»¥è½¬æ¢ä¸º <code>uint16</code>/<code>uint24</code>../<code>uint256</code>ï¼Œå› ä¸º<code>uint8</code>æ˜¯<code>uint16</code>è¿™äº›ç±»å‹çš„å­é›†ã€‚ä½†æ˜¯ <code>int8</code> ä¸å¯ä»¥è½¬æ¢ä¸º <code>uint256</code>ï¼Œå› ä¸º <code>int8</code> å¯ä»¥åŒ…å« <code>uint256</code> ä¸­ä¸å…è®¸çš„è´Ÿå€¼ï¼Œæ¯”å¦‚ <code>-1</code>ã€‚</li></ul></li> <li>æ˜¾ç¤ºè½¬æ¢æœ‰å“ªäº›éœ€è¦æ³¨æ„çš„ï¼Ÿ
<ul><li><code>uint8</code> - <code>uint256</code> ä¹‹é—´è½¬æ¢çš„åŸç†</li> <li><code>bytes1</code> - <code>bytes32</code> ä¹‹é—´è½¬æ¢çš„åŸç†</li> <li>æ•´å‹åŠ å¤§æ•°æ®ä½ç½®æ˜¯ä»å·¦ä¾§å¢åŠ ï¼Œå‡å°æ•°æ®ä½ç½®ä¹Ÿæ˜¯ä»å·¦ä¾§ç§»é™¤ï¼›ï¼ˆæ•´å‹æ˜¯å³å¯¹é½ï¼‰</li> <li>å­—èŠ‚åŠ å¤§æ•°æ®ä½ç½®æ˜¯ä»å³ä¾§å¢åŠ ï¼Œå‡å°æ•°æ®ä½ç½®ä¹Ÿæ˜¯ä»å³ä¾§ç§»é™¤ï¼›ï¼ˆå­—èŠ‚æ˜¯å·¦å¯¹é½ï¼‰</li></ul></li> <li>èŠä¸€èŠ int/uint ç±»å‹ä¹‹é—´çš„è½¬æ¢
<ul><li>å› ä¸ºæ•´å‹åŠ å¤§æ•°æ®ä½ç½®æ˜¯ä»å·¦ä¾§å¢åŠ ï¼Œå‡å°æ•°æ®ä½ç½®ä¹Ÿæ˜¯ä»å·¦ä¾§ç§»é™¤ï¼›ï¼ˆ<strong>æ•´å‹æ˜¯å³å¯¹é½</strong>ï¼‰</li> <li>æ•´å‹è½¬æ¢æˆæ›´å¤§çš„ç±»å‹ï¼Œä»å·¦ä¾§æ·»åŠ å¡«å……ä½ã€‚</li> <li>æ•´å‹è½¬æ¢æˆæ›´å°çš„ç±»å‹ï¼Œä¼šä¸¢å¤±å·¦ä¾§æ•°æ®ã€‚</li></ul></li> <li>èŠä¸€èŠ bytes å­—èŠ‚ç±»å‹ä¹‹é—´çš„è½¬æ¢
<ul><li>å› ä¸ºå­—èŠ‚åŠ å¤§æ•°æ®ä½ç½®æ˜¯ä»å³ä¾§å¢åŠ ï¼Œå‡å°æ•°æ®ä½ç½®ä¹Ÿæ˜¯ä»å³ä¾§ç§»é™¤ï¼›ï¼ˆ<strong>å­—èŠ‚æ˜¯å·¦å¯¹é½</strong>ï¼‰</li> <li>å­—èŠ‚è½¬æ¢ä¸ºæ›´å¤§çš„ç±»å‹æ—¶ï¼Œä»å³ä¾§æ·»åŠ å¡«å……ä½ã€‚</li> <li>å­—èŠ‚è½¬æ¢åˆ°æ›´å°çš„ç±»å‹æ—¶ï¼Œä¸¢å¤±å³ä¾§æ•°æ®ã€‚</li></ul></li> <li><code>bytes</code> ä¸ <code>uint</code> è½¬æ¢
<ul><li>bytes è½¬æ¢æˆ uint: å…ˆè½¬ç±»å‹ï¼Œå†è½¬å¤§å°</li> <li>uint è½¬æ¢æˆ bytes: å…ˆè½¬å¤§å°ï¼Œå†è½¬ç±»å‹</li></ul></li> <li><code>bytes</code> ä¸ <code>address</code> è½¬æ¢
<ul><li>address çš„æ ¼å¼æ˜¯ <code>0xffD0d80c48F6C3C5387b7cfA7AA03970bdB926ac</code>ï¼Œæ˜¯ä¸€ä¸ª <strong>bytes20</strong> çš„æ•°æ®.</li> <li>è€Œç”±å­—ç¬¦ä¸²ç”Ÿæˆ bytes çš„æ–¹å¼æ˜¯ <code>keccak256(abi.encodePacked())</code>ï¼Œè¿”å›çš„æ˜¯ <code>bytes32</code> ç±»å‹ã€‚åœ°å€æ˜¯å– <code>bytes32</code> æ•°æ®ä¸­çš„å 20 ä½ã€‚å¦‚æœåˆ é™¤å‰é¢çš„ 12 ä½æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ solidity assembly (å†…è”æ±‡ç¼–) æ¥æˆªå–ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ© <code>uint</code> è½¬æ¢æˆæ›´å°çš„ç±»å‹ï¼Œä¼šä¸¢å¤±å·¦ä¾§æ•°æ®çš„ç‰¹æ€§æ¥å®Œæˆã€‚</li></ul></li> <li><code>uint</code> ä¸ <code>address</code> è½¬æ¢</li> <li><code>bytes</code> ä¸ <code>bytes32</code> ä¹‹é—´çš„è½¬æ¢
<ul><li>åˆ›å»ºé•¿åº¦ï¼Œfor å¾ªç¯</li></ul></li></ul> <p><strong>å­—é¢å¸¸é‡ä¸åŸºæœ¬ç±»å‹çš„è½¬æ¢</strong></p> <ul><li>åè¿›åˆ¶å’Œåå…­è¿›åˆ¶å­—é¢å¸¸é‡ä¹‹é—´çš„è½¬æ¢éœ€è¦æ³¨æ„ä»€ä¹ˆé—®é¢˜ï¼Ÿ
<ul><li>åªæœ‰åœ¨åŒ¹é…æ•°æ®èŒƒå›´æ—¶ï¼Œæ‰èƒ½è¿›è¡Œéšå½¢è½¬æ¢ï¼Œå¦‚æœè¶…å‡ºï¼Œä¸ä¼šæˆªæ–­ï¼Œè€Œæ˜¯æŠ¥é”™ã€‚</li></ul></li></ul></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/solidity/professional-solidity/Contents.html" class="prev">
          ç›®å½•
        </a></span> <span class="next"><a href="/solidity/professional-solidity/03.variable.html">
          å˜é‡
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_1ï¸âƒ£-æ•°æ®ä¸å˜é‡" class="sidebar-link reco-side-_1ï¸âƒ£-æ•°æ®ä¸å˜é‡" data-v-b57cc07c>1ï¸âƒ£ æ•°æ®ä¸å˜é‡</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#æœ¬èŠ‚é…å¥—è§†é¢‘" class="sidebar-link reco-side-æœ¬èŠ‚é…å¥—è§†é¢‘" data-v-b57cc07c>æœ¬èŠ‚é…å¥—è§†é¢‘</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_1-éšå¼è½¬æ¢" class="sidebar-link reco-side-_1-éšå¼è½¬æ¢" data-v-b57cc07c>1.éšå¼è½¬æ¢</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_2ï¸âƒ£-ä¸¤ç§ç±»å‹çš„æ•°æ®" class="sidebar-link reco-side-_2ï¸âƒ£-ä¸¤ç§ç±»å‹çš„æ•°æ®" data-v-b57cc07c>2ï¸âƒ£ ä¸¤ç§ç±»å‹çš„æ•°æ®</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#æœ¬èŠ‚é…å¥—è§†é¢‘-2" class="sidebar-link reco-side-æœ¬èŠ‚é…å¥—è§†é¢‘-2" data-v-b57cc07c>æœ¬èŠ‚é…å¥—è§†é¢‘</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#å†…å®¹" class="sidebar-link reco-side-å†…å®¹" data-v-b57cc07c>å†…å®¹</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_3ï¸âƒ£-å€¼ç±»å‹" class="sidebar-link reco-side-_3ï¸âƒ£-å€¼ç±»å‹" data-v-b57cc07c>3ï¸âƒ£ å€¼ç±»å‹</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_1-boolean-å¸ƒå°”ç±»å‹" class="sidebar-link reco-side-_1-boolean-å¸ƒå°”ç±»å‹" data-v-b57cc07c>1.Boolean å¸ƒå°”ç±»å‹</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_2-integer-æ•´æ•°ç±»å‹" class="sidebar-link reco-side-_2-integer-æ•´æ•°ç±»å‹" data-v-b57cc07c>2.Integer æ•´æ•°ç±»å‹</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_3-integer-æ•´æ•°å­—é¢å¸¸é‡" class="sidebar-link reco-side-_3-integer-æ•´æ•°å­—é¢å¸¸é‡" data-v-b57cc07c>3.Integer æ•´æ•°å­—é¢å¸¸é‡</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_4-fixed-å®šé•¿æµ®ç‚¹å‹" class="sidebar-link reco-side-_4-fixed-å®šé•¿æµ®ç‚¹å‹" data-v-b57cc07c>4.Fixed å®šé•¿æµ®ç‚¹å‹</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_5-bytesn-å®šé•¿å­—èŠ‚æ•°ç»„" class="sidebar-link reco-side-_5-bytesn-å®šé•¿å­—èŠ‚æ•°ç»„" data-v-b57cc07c>5.BytesN å®šé•¿å­—èŠ‚æ•°ç»„</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_6-å­—ç¬¦ä¸²å­—é¢å¸¸é‡åŠç±»å‹" class="sidebar-link reco-side-_6-å­—ç¬¦ä¸²å­—é¢å¸¸é‡åŠç±»å‹" data-v-b57cc07c>6.å­—ç¬¦ä¸²å­—é¢å¸¸é‡åŠç±»å‹</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_7-unicode-å­—é¢å¸¸é‡" class="sidebar-link reco-side-_7-unicode-å­—é¢å¸¸é‡" data-v-b57cc07c>7.Unicode å­—é¢å¸¸é‡</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_8-åå…­è¿›åˆ¶å­—é¢å¸¸é‡" class="sidebar-link reco-side-_8-åå…­è¿›åˆ¶å­—é¢å¸¸é‡" data-v-b57cc07c>8.åå…­è¿›åˆ¶å­—é¢å¸¸é‡</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_9-enum-æšä¸¾" class="sidebar-link reco-side-_9-enum-æšä¸¾" data-v-b57cc07c>9.Enum:æšä¸¾</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_10-ç”¨æˆ·å®šä¹‰çš„å€¼ç±»å‹" class="sidebar-link reco-side-_10-ç”¨æˆ·å®šä¹‰çš„å€¼ç±»å‹" data-v-b57cc07c>10.ç”¨æˆ·å®šä¹‰çš„å€¼ç±»å‹</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_4ï¸âƒ£-å€¼ç±»å‹-åœ°å€ç±»å‹" class="sidebar-link reco-side-_4ï¸âƒ£-å€¼ç±»å‹-åœ°å€ç±»å‹" data-v-b57cc07c>4ï¸âƒ£ å€¼ç±»å‹:åœ°å€ç±»å‹</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#æœ¬èŠ‚é…å¥—è§†é¢‘-13" class="sidebar-link reco-side-æœ¬èŠ‚é…å¥—è§†é¢‘-13" data-v-b57cc07c>æœ¬èŠ‚é…å¥—è§†é¢‘</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_1-åœ°å€å­—é¢å¸¸é‡" class="sidebar-link reco-side-_1-åœ°å€å­—é¢å¸¸é‡" data-v-b57cc07c>1.åœ°å€å­—é¢å¸¸é‡</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_2-address-uint-bytes32-ä¹‹é—´çš„è½¬æ¢" class="sidebar-link reco-side-_2-address-uint-bytes32-ä¹‹é—´çš„è½¬æ¢" data-v-b57cc07c>2.address/uint/bytes32 ä¹‹é—´çš„è½¬æ¢</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_3-ä¸¤ç§å½¢å¼çš„åœ°å€" class="sidebar-link reco-side-_3-ä¸¤ç§å½¢å¼çš„åœ°å€" data-v-b57cc07c>3.ä¸¤ç§å½¢å¼çš„åœ°å€</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_4-åœ°å€å±æ€§" class="sidebar-link reco-side-_4-åœ°å€å±æ€§" data-v-b57cc07c>4.åœ°å€å±æ€§</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_5-åœ°å€æ–¹æ³•" class="sidebar-link reco-side-_5-åœ°å€æ–¹æ³•" data-v-b57cc07c>5.åœ°å€æ–¹æ³•</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_5ï¸âƒ£-å€¼ç±»å‹-åˆçº¦ç±»å‹" class="sidebar-link reco-side-_5ï¸âƒ£-å€¼ç±»å‹-åˆçº¦ç±»å‹" data-v-b57cc07c>5ï¸âƒ£ å€¼ç±»å‹:åˆçº¦ç±»å‹</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#æœ¬èŠ‚é…å¥—è§†é¢‘-14" class="sidebar-link reco-side-æœ¬èŠ‚é…å¥—è§†é¢‘-14" data-v-b57cc07c>æœ¬èŠ‚é…å¥—è§†é¢‘</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_1-åˆ›å»ºçš„ä¾‹å­" class="sidebar-link reco-side-_1-åˆ›å»ºçš„ä¾‹å­" data-v-b57cc07c>1.åˆ›å»ºçš„ä¾‹å­</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_2-è½¬é’±çš„ä¾‹å­" class="sidebar-link reco-side-_2-è½¬é’±çš„ä¾‹å­" data-v-b57cc07c>2.è½¬é’±çš„ä¾‹å­</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_3-åˆçº¦çš„å±æ€§" class="sidebar-link reco-side-_3-åˆçº¦çš„å±æ€§" data-v-b57cc07c>3.åˆçº¦çš„å±æ€§</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_6ï¸âƒ£-å¼•ç”¨ç±»å‹çš„é¢å¤–æ³¨è§£-æ•°æ®ä½ç½®" class="sidebar-link reco-side-_6ï¸âƒ£-å¼•ç”¨ç±»å‹çš„é¢å¤–æ³¨è§£-æ•°æ®ä½ç½®" data-v-b57cc07c>6ï¸âƒ£ å¼•ç”¨ç±»å‹çš„é¢å¤–æ³¨è§£:æ•°æ®ä½ç½®</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_1-æ•°æ®ä½ç½®çš„åŸºç¡€ä»‹ç»" class="sidebar-link reco-side-_1-æ•°æ®ä½ç½®çš„åŸºç¡€ä»‹ç»" data-v-b57cc07c>1.æ•°æ®ä½ç½®çš„åŸºç¡€ä»‹ç»</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_2-ä¸åŒæ•°æ®ä½ç½®ä¹‹é—´çš„èµ‹å€¼è§„åˆ™" class="sidebar-link reco-side-_2-ä¸åŒæ•°æ®ä½ç½®ä¹‹é—´çš„èµ‹å€¼è§„åˆ™" data-v-b57cc07c>2.ä¸åŒæ•°æ®ä½ç½®ä¹‹é—´çš„èµ‹å€¼è§„åˆ™</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_3-æ·±åˆ»ç†è§£å¼•ç”¨ç±»å‹èµ‹å€¼å’Œä¿®æ”¹" class="sidebar-link reco-side-_3-æ·±åˆ»ç†è§£å¼•ç”¨ç±»å‹èµ‹å€¼å’Œä¿®æ”¹" data-v-b57cc07c>3.æ·±åˆ»ç†è§£å¼•ç”¨ç±»å‹èµ‹å€¼å’Œä¿®æ”¹</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_4-calldata-å’Œ-memeory-åŒºåˆ«" class="sidebar-link reco-side-_4-calldata-å’Œ-memeory-åŒºåˆ«" data-v-b57cc07c>4.calldata å’Œ memeory åŒºåˆ«</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_7ï¸âƒ£-å¼•ç”¨ç±»å‹" class="sidebar-link reco-side-_7ï¸âƒ£-å¼•ç”¨ç±»å‹" data-v-b57cc07c>7ï¸âƒ£ å¼•ç”¨ç±»å‹</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_1-array-æ•°ç»„" class="sidebar-link reco-side-_1-array-æ•°ç»„" data-v-b57cc07c>1.array æ•°ç»„</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_2-bytes" class="sidebar-link reco-side-_2-bytes" data-v-b57cc07c>2.bytes</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_3-string" class="sidebar-link reco-side-_3-string" data-v-b57cc07c>3.string</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_4-mapping-æ˜ å°„" class="sidebar-link reco-side-_4-mapping-æ˜ å°„" data-v-b57cc07c>4.mapping æ˜ å°„</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_5-struct-ç»“æ„ä½“" class="sidebar-link reco-side-_5-struct-ç»“æ„ä½“" data-v-b57cc07c>5.struct ç»“æ„ä½“</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_8ï¸âƒ£-ç±»å‹è½¬æ¢" class="sidebar-link reco-side-_8ï¸âƒ£-ç±»å‹è½¬æ¢" data-v-b57cc07c>8ï¸âƒ£ ç±»å‹è½¬æ¢</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#æœ¬èŠ‚é…å¥—è§†é¢‘-24" class="sidebar-link reco-side-æœ¬èŠ‚é…å¥—è§†é¢‘-24" data-v-b57cc07c>æœ¬èŠ‚é…å¥—è§†é¢‘</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_1-éšå¼è½¬æ¢-2" class="sidebar-link reco-side-_1-éšå¼è½¬æ¢-2" data-v-b57cc07c>1.éšå¼è½¬æ¢</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_2-æ˜¾å¼è½¬æ¢" class="sidebar-link reco-side-_2-æ˜¾å¼è½¬æ¢" data-v-b57cc07c>2.æ˜¾å¼è½¬æ¢</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_3-æ•°å­—è½¬æ¢æˆå­—ç¬¦ä¸²" class="sidebar-link reco-side-_3-æ•°å­—è½¬æ¢æˆå­—ç¬¦ä¸²" data-v-b57cc07c>3.æ•°å­—è½¬æ¢æˆå­—ç¬¦ä¸²</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_9ï¸âƒ£-å­—é¢å¸¸é‡ä¸åŸºæœ¬ç±»å‹çš„è½¬æ¢" class="sidebar-link reco-side-_9ï¸âƒ£-å­—é¢å¸¸é‡ä¸åŸºæœ¬ç±»å‹çš„è½¬æ¢" data-v-b57cc07c>9ï¸âƒ£ å­—é¢å¸¸é‡ä¸åŸºæœ¬ç±»å‹çš„è½¬æ¢</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#æœ¬èŠ‚é…å¥—è§†é¢‘-26" class="sidebar-link reco-side-æœ¬èŠ‚é…å¥—è§†é¢‘-26" data-v-b57cc07c>æœ¬èŠ‚é…å¥—è§†é¢‘</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_1-åè¿›åˆ¶å’Œåå…­è¿›åˆ¶å­—é¢å¸¸é‡" class="sidebar-link reco-side-_1-åè¿›åˆ¶å’Œåå…­è¿›åˆ¶å­—é¢å¸¸é‡" data-v-b57cc07c>1.åè¿›åˆ¶å’Œåå…­è¿›åˆ¶å­—é¢å¸¸é‡</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_2-æ•´å‹å­—é¢å¸¸é‡ä¸-bytesn" class="sidebar-link reco-side-_2-æ•´å‹å­—é¢å¸¸é‡ä¸-bytesn" data-v-b57cc07c>2.æ•´å‹å­—é¢å¸¸é‡ä¸ bytesN</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_3-å­—ç¬¦ä¸²å­—é¢å¸¸é‡ä¸-bytesn" class="sidebar-link reco-side-_3-å­—ç¬¦ä¸²å­—é¢å¸¸é‡ä¸-bytesn" data-v-b57cc07c>3.å­—ç¬¦ä¸²å­—é¢å¸¸é‡ä¸ bytesN</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_4-åå…­è¿›åˆ¶å­—é¢å¸¸é‡ä¸åœ°å€ç±»å‹" class="sidebar-link reco-side-_4-åå…­è¿›åˆ¶å­—é¢å¸¸é‡ä¸åœ°å€ç±»å‹" data-v-b57cc07c>4.åå…­è¿›åˆ¶å­—é¢å¸¸é‡ä¸åœ°å€ç±»å‹</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#ğŸ†—-å®æˆ˜-1-todo-list" class="sidebar-link reco-side-ğŸ†—-å®æˆ˜-1-todo-list" data-v-b57cc07c>ğŸ†— å®æˆ˜ 1: Todo List</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#æœ¬èŠ‚é…å¥—è§†é¢‘-27" class="sidebar-link reco-side-æœ¬èŠ‚é…å¥—è§†é¢‘-27" data-v-b57cc07c>æœ¬èŠ‚é…å¥—è§†é¢‘</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_1-éœ€è¦å®Œæˆçš„åŠŸèƒ½" class="sidebar-link reco-side-_1-éœ€è¦å®Œæˆçš„åŠŸèƒ½" data-v-b57cc07c>1.éœ€è¦å®Œæˆçš„åŠŸèƒ½</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_2-æ€è€ƒä»£ç å†…çŠ¶æ€å˜é‡æ€ä¹ˆå®‰æ’" class="sidebar-link reco-side-_2-æ€è€ƒä»£ç å†…çŠ¶æ€å˜é‡æ€ä¹ˆå®‰æ’" data-v-b57cc07c>2.æ€è€ƒä»£ç å†…çŠ¶æ€å˜é‡æ€ä¹ˆå®‰æ’ï¼Ÿ</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_3-æ¼”ç¤ºä»£ç " class="sidebar-link reco-side-_3-æ¼”ç¤ºä»£ç " data-v-b57cc07c>3.æ¼”ç¤ºä»£ç </a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_4-è‡ªå·±åŠ¨æ‰‹" class="sidebar-link reco-side-_4-è‡ªå·±åŠ¨æ‰‹" data-v-b57cc07c>4. è‡ªå·±åŠ¨æ‰‹</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#ğŸ†—-å®æˆ˜-2-ä¼—ç­¹åˆçº¦" class="sidebar-link reco-side-ğŸ†—-å®æˆ˜-2-ä¼—ç­¹åˆçº¦" data-v-b57cc07c>ğŸ†— å®æˆ˜ 2: ä¼—ç­¹åˆçº¦</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#æœ¬èŠ‚é…å¥—è§†é¢‘-28" class="sidebar-link reco-side-æœ¬èŠ‚é…å¥—è§†é¢‘-28" data-v-b57cc07c>æœ¬èŠ‚é…å¥—è§†é¢‘</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_1-éœ€æ±‚åˆ†æ" class="sidebar-link reco-side-_1-éœ€æ±‚åˆ†æ" data-v-b57cc07c>1.éœ€æ±‚åˆ†æ</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_2-æ¼”ç¤ºä»£ç " class="sidebar-link reco-side-_2-æ¼”ç¤ºä»£ç " data-v-b57cc07c>2.æ¼”ç¤ºä»£ç </a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_3-è‡ªå·±åŠ¨æ‰‹" class="sidebar-link reco-side-_3-è‡ªå·±åŠ¨æ‰‹" data-v-b57cc07c>3.è‡ªå·±åŠ¨æ‰‹</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#ğŸ†—-å®æˆ˜-3-åŒå¿—ä»¬å¥½å¢åŠ æç¤º" class="sidebar-link reco-side-ğŸ†—-å®æˆ˜-3-åŒå¿—ä»¬å¥½å¢åŠ æç¤º" data-v-b57cc07c>ğŸ†— å®æˆ˜ 3: åŒå¿—ä»¬å¥½å¢åŠ æç¤º</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#æœ¬èŠ‚é…å¥—è§†é¢‘-29" class="sidebar-link reco-side-æœ¬èŠ‚é…å¥—è§†é¢‘-29" data-v-b57cc07c>æœ¬èŠ‚é…å¥—è§†é¢‘</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_1-éœ€æ±‚åˆ†æ-2" class="sidebar-link reco-side-_1-éœ€æ±‚åˆ†æ-2" data-v-b57cc07c>1.éœ€æ±‚åˆ†æ</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_2-ä»£ç å¦‚ä¸‹" class="sidebar-link reco-side-_2-ä»£ç å¦‚ä¸‹" data-v-b57cc07c>2.ä»£ç å¦‚ä¸‹</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#ğŸ†—-å®æˆ˜-4-eth-é’±åŒ…" class="sidebar-link reco-side-ğŸ†—-å®æˆ˜-4-eth-é’±åŒ…" data-v-b57cc07c>ğŸ†— å®æˆ˜ 4: ETH é’±åŒ…</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#æœ¬èŠ‚é…å¥—è§†é¢‘-30" class="sidebar-link reco-side-æœ¬èŠ‚é…å¥—è§†é¢‘-30" data-v-b57cc07c>æœ¬èŠ‚é…å¥—è§†é¢‘</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#å†…å®¹-2" class="sidebar-link reco-side-å†…å®¹-2" data-v-b57cc07c>å†…å®¹</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#ğŸ†—-å®æˆ˜-5-å¤šç­¾é’±åŒ…" class="sidebar-link reco-side-ğŸ†—-å®æˆ˜-5-å¤šç­¾é’±åŒ…" data-v-b57cc07c>ğŸ†— å®æˆ˜ 5: å¤šç­¾é’±åŒ…</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#æœ¬èŠ‚é…å¥—è§†é¢‘-31" class="sidebar-link reco-side-æœ¬èŠ‚é…å¥—è§†é¢‘-31" data-v-b57cc07c>æœ¬èŠ‚é…å¥—è§†é¢‘</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_1-åŸç†" class="sidebar-link reco-side-_1-åŸç†" data-v-b57cc07c>1.åŸç†</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_2-ä»£ç " class="sidebar-link reco-side-_2-ä»£ç " data-v-b57cc07c>2.ä»£ç </a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#_3-æµ‹è¯•æµç¨‹" class="sidebar-link reco-side-_3-æµ‹è¯•æµç¨‹" data-v-b57cc07c>3.æµ‹è¯•æµç¨‹</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/02.type-of-data.html#ï¸âƒ£-é—®ç­”é¢˜" class="sidebar-link reco-side-ï¸âƒ£-é—®ç­”é¢˜" data-v-b57cc07c>#ï¸âƒ£ é—®ç­”é¢˜</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/solidity/assets/js/app.e5082ffd.js" defer></script><script src="/solidity/assets/js/3.5ee47f7c.js" defer></script><script src="/solidity/assets/js/1.912b4b55.js" defer></script><script src="/solidity/assets/js/28.f5e564d2.js" defer></script>
  </body>
</html>
