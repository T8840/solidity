<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>09.äº‹ä»¶ | T8840 Blog</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="T8840çš„åšå®¢">
    
    <link rel="preload" href="/solidity/assets/css/0.styles.b490882a.css" as="style"><link rel="preload" href="/solidity/assets/js/app.e5082ffd.js" as="script"><link rel="preload" href="/solidity/assets/js/3.5ee47f7c.js" as="script"><link rel="preload" href="/solidity/assets/js/1.912b4b55.js" as="script"><link rel="preload" href="/solidity/assets/js/35.95934a73.js" as="script"><link rel="prefetch" href="/solidity/assets/js/10.b8fb11d0.js"><link rel="prefetch" href="/solidity/assets/js/11.f32d6aa6.js"><link rel="prefetch" href="/solidity/assets/js/12.500c9e01.js"><link rel="prefetch" href="/solidity/assets/js/13.f32bd8e7.js"><link rel="prefetch" href="/solidity/assets/js/14.240c8045.js"><link rel="prefetch" href="/solidity/assets/js/15.0e4064e0.js"><link rel="prefetch" href="/solidity/assets/js/16.520be469.js"><link rel="prefetch" href="/solidity/assets/js/17.9e1045bf.js"><link rel="prefetch" href="/solidity/assets/js/18.fda721ea.js"><link rel="prefetch" href="/solidity/assets/js/19.7dcfc9fc.js"><link rel="prefetch" href="/solidity/assets/js/20.5b4e6f91.js"><link rel="prefetch" href="/solidity/assets/js/21.19568bc5.js"><link rel="prefetch" href="/solidity/assets/js/22.166c2d98.js"><link rel="prefetch" href="/solidity/assets/js/23.5cfe8d9a.js"><link rel="prefetch" href="/solidity/assets/js/24.ca3cb849.js"><link rel="prefetch" href="/solidity/assets/js/25.fd73bb0b.js"><link rel="prefetch" href="/solidity/assets/js/26.560bc8ec.js"><link rel="prefetch" href="/solidity/assets/js/27.f2377326.js"><link rel="prefetch" href="/solidity/assets/js/28.f5e564d2.js"><link rel="prefetch" href="/solidity/assets/js/29.dd2c0633.js"><link rel="prefetch" href="/solidity/assets/js/30.28848fc0.js"><link rel="prefetch" href="/solidity/assets/js/31.4c918904.js"><link rel="prefetch" href="/solidity/assets/js/32.a8886025.js"><link rel="prefetch" href="/solidity/assets/js/33.ffc5709c.js"><link rel="prefetch" href="/solidity/assets/js/34.f08a3e2e.js"><link rel="prefetch" href="/solidity/assets/js/36.61b3c3c3.js"><link rel="prefetch" href="/solidity/assets/js/37.a902f0d2.js"><link rel="prefetch" href="/solidity/assets/js/38.c8172eb9.js"><link rel="prefetch" href="/solidity/assets/js/39.d83f4932.js"><link rel="prefetch" href="/solidity/assets/js/4.673bf15a.js"><link rel="prefetch" href="/solidity/assets/js/40.a01d9291.js"><link rel="prefetch" href="/solidity/assets/js/41.bd4ae60c.js"><link rel="prefetch" href="/solidity/assets/js/42.00e1217a.js"><link rel="prefetch" href="/solidity/assets/js/43.398d96c8.js"><link rel="prefetch" href="/solidity/assets/js/44.61afc1d6.js"><link rel="prefetch" href="/solidity/assets/js/45.e8d6009e.js"><link rel="prefetch" href="/solidity/assets/js/46.5d6497e3.js"><link rel="prefetch" href="/solidity/assets/js/47.34b62bec.js"><link rel="prefetch" href="/solidity/assets/js/48.b3077ae7.js"><link rel="prefetch" href="/solidity/assets/js/49.51c93428.js"><link rel="prefetch" href="/solidity/assets/js/5.8b013b29.js"><link rel="prefetch" href="/solidity/assets/js/50.be8ed4e3.js"><link rel="prefetch" href="/solidity/assets/js/51.ec76f9b6.js"><link rel="prefetch" href="/solidity/assets/js/52.40936f0d.js"><link rel="prefetch" href="/solidity/assets/js/53.488d417b.js"><link rel="prefetch" href="/solidity/assets/js/54.8e10336a.js"><link rel="prefetch" href="/solidity/assets/js/55.2edfb408.js"><link rel="prefetch" href="/solidity/assets/js/56.2c197860.js"><link rel="prefetch" href="/solidity/assets/js/57.1574a0d4.js"><link rel="prefetch" href="/solidity/assets/js/58.34fb9546.js"><link rel="prefetch" href="/solidity/assets/js/59.33203193.js"><link rel="prefetch" href="/solidity/assets/js/6.aad79307.js"><link rel="prefetch" href="/solidity/assets/js/7.8e49b54c.js"><link rel="prefetch" href="/solidity/assets/js/8.1296ca76.js"><link rel="prefetch" href="/solidity/assets/js/9.cc552303.js">
    <link rel="stylesheet" href="/solidity/assets/css/0.styles.b490882a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>T8840 Blog</h3> <p class="description" data-v-59e6cb88>T8840çš„åšå®¢</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
        Â Â 
        <!---->
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/solidity/" class="home-link router-link-active"><!----> <span class="site-name">T8840 Blog</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/solidity/" class="nav-link"><i class="undefined"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      T8840 åšå®¢
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/t8840" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><!----> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>41</h3> <h6 data-v-1fad0c41>æ–‡ç« </h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>0</h3> <h6 data-v-1fad0c41>æ ‡ç­¾</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/solidity/" class="nav-link"><i class="undefined"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      T8840 åšå®¢
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/t8840" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/solidity/" class="sidebar-heading clickable router-link-active"><span>æ¬¢è¿å­¦ä¹ </span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/solidity/" aria-current="page" class="sidebar-link">å­¦å‰å¿…è¯»</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/solidity/best/BestWeb3TechIntroduce" class="sidebar-heading clickable"><span>Web3æœ€ä½³ç¼–ç¨‹å®è·µæŒ‡å—</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/solidity/best/BestWeb3TechIntroduce.html" class="sidebar-link">Web3æœ€ä½³ç¼–ç¨‹å®è·µæŒ‡å—</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/solidity/basic/Introduce" class="sidebar-heading clickable"><span>åŸºç¡€</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/solidity/basic/Introduce.html" class="sidebar-link">ä»‹ç»</a></li><li><a href="/solidity/basic/FirstMetSolidity.html" class="sidebar-link">åˆæ­¥äº†è§£Solidity</a></li><li><a href="/solidity/basic/SoliditybyExample.html" class="sidebar-link">SoliditybyExample</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/standards/Introduce" class="sidebar-heading clickable"><span>æ ‡å‡†</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/professional-solidity/Contents" class="sidebar-heading clickable open"><span>æ•™ç¨‹:professional-solidity</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/solidity/professional-solidity/Contents.html" class="sidebar-link">ç›®å½•</a></li><li><a href="/solidity/professional-solidity/02.type-of-data.html" class="sidebar-link">æ•°æ®</a></li><li><a href="/solidity/professional-solidity/03.variable.html" class="sidebar-link">å˜é‡</a></li><li><a href="/solidity/professional-solidity/04.function.html" class="sidebar-link">å‡½æ•°</a></li><li><a href="/solidity/professional-solidity/05.operator.html" class="sidebar-link">æ“ä½œç¬¦</a></li><li><a href="/solidity/professional-solidity/06.error.html" class="sidebar-link">é”™è¯¯å¤„ç†</a></li><li><a href="/solidity/professional-solidity/07.control-flow.html" class="sidebar-link">æµç¨‹æ§åˆ¶</a></li><li><a href="/solidity/professional-solidity/08.loops-and-iteration.html" class="sidebar-link">å¾ªç¯ä¸è¿­ä»£</a></li><li><a href="/solidity/professional-solidity/09.event.html" aria-current="page" class="active sidebar-link">äº‹ä»¶</a></li><li><a href="/solidity/professional-solidity/10.inheritance.html" class="sidebar-link">ç»§æ‰¿</a></li><li><a href="/solidity/professional-solidity/11.call-other.html" class="sidebar-link">åˆçº¦è°ƒç”¨åˆçº¦</a></li><li><a href="/solidity/professional-solidity/12.deploy.html" class="sidebar-link">åˆçº¦éƒ¨ç½²åˆçº¦</a></li><li><a href="/solidity/professional-solidity/13.interface.html" class="sidebar-link">æ¥å£</a></li><li><a href="/solidity/professional-solidity/14.library.html" class="sidebar-link">åº“</a></li><li><a href="/solidity/professional-solidity/15.algorithm.html" class="sidebar-link">ç®—æ³•</a></li><li><a href="/solidity/professional-solidity/16.assembly.html" class="sidebar-link">å†…è”æ±‡ç¼–</a></li><li><a href="/solidity/professional-solidity/17.metadata.html" class="sidebar-link">å…ƒæ•°æ®</a></li><li><a href="/solidity/professional-solidity/18.abi.html" class="sidebar-link">ABIç¼–ç </a></li><li><a href="/solidity/professional-solidity/19.layout.html" class="sidebar-link">å˜é‡å¸ƒå±€</a></li><li><a href="/solidity/professional-solidity/20.safe.html" class="sidebar-link">å®‰å…¨</a></li><li><a href="/solidity/professional-solidity/21.gas.html" class="sidebar-link">gasä¼˜åŒ–</a></li><li><a href="/solidity/professional-solidity/22.styleguide.html" class="sidebar-link">åˆçº¦ç¼–ç è§„èŒƒ</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/openzeppelin-learn/Introduce" class="sidebar-heading clickable"><span>æ•™ç¨‹:openzeppelin-learn</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/nodejs/Introduce" class="sidebar-heading clickable"><span>nodejs</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/go/Introduce" class="sidebar-heading clickable"><span>Go</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/relay/Introduce" class="sidebar-heading clickable"><span>Relay</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/dapp/CreateWeb3Dapp" class="sidebar-heading clickable"><span>Dapp</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/solidity/project/Summary" class="sidebar-heading clickable"><span>é¡¹ç›®</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88></h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
        Â Â 
        <!---->
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">09.äº‹ä»¶</h1> <div data-v-8a445198><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="_09-äº‹ä»¶"><a href="#_09-äº‹ä»¶" class="header-anchor">#</a> 09.äº‹ä»¶</h1> <p>äº‹ä»¶æ˜¯èƒ½æ–¹ä¾¿åœ°è°ƒç”¨ä»¥å¤ªåŠè™šæ‹Ÿæœºæ—¥å¿—åŠŸèƒ½çš„æ¥å£ã€‚åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡ä»¥å¤ªåŠå®¢æˆ·ç«¯çš„ RPC æ¥å£è®¢é˜…å’Œç›‘å¬è¿™äº›äº‹ä»¶ã€‚</p> <p><strong>é‡ç‚¹:è®°å½•åŒºå—é“¾çš„æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨çŠ¶æ€å˜é‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨äº‹ä»¶ Eventï¼Œä½† Event ä½¿ç”¨çš„ gas è´¹æ¯”çŠ¶æ€å˜é‡ä½ã€‚</strong></p> <p>åŸåˆ™ï¼šæ”¹å˜çŠ¶æ€å˜é‡æ—¶ï¼Œä¸€å®šè¦è§¦å‘äº‹ä»¶ã€‚</p> <p>Soliddity Event äº‹ä»¶æ˜¯ä»¥å¤ªåŠè™šæ‹Ÿæœº(EVM)æ—¥å¿—åŸºç¡€è®¾æ–½æä¾›çš„ä¸€ä¸ªä¾¿åˆ©æ¥å£ã€‚å½“è¢«å‘é€äº‹ä»¶ï¼ˆè°ƒç”¨ï¼‰æ—¶ï¼Œä¼šè§¦å‘å‚æ•°å­˜å‚¨åˆ°äº¤æ˜“çš„æ—¥å¿—ä¸­ã€‚è¿™äº›æ—¥å¿—ä¸åˆçº¦çš„åœ°å€å…³è”ï¼Œå¹¶è®°å½•åˆ°åŒºå—é“¾ä¸­ã€‚æ¯ä¸ªäº¤æ˜“æ”¶æ®åŒ…å« 0 åˆ°å¤šä¸ª log è®°å½•ï¼Œlog è¡¨æ˜ç€æ™ºèƒ½åˆçº¦æ‰€è§¦å‘çš„äº‹ä»¶ã€‚</p> <h2 id="_1ï¸âƒ£-event-è¯­æ³•"><a href="#_1ï¸âƒ£-event-è¯­æ³•" class="header-anchor">#</a> 1ï¸âƒ£ Event è¯­æ³•</h2> <p><strong>äº‹ä»¶çš„å®šä¹‰</strong>:ä½¿ç”¨ <code>event</code> å…³é”®å­—æ¥å®šä¹‰ä¸€ä¸ªäº‹ä»¶ Eventï¼Œè¯­æ³•å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>event EventName(&lt;parameter list&gt;);
</code></pre></div><p><strong>äº‹ä»¶çš„è§¦å‘</strong>:åªèƒ½ä½¿ç”¨ <code>emit</code> å…³é”®å­—æ¥è§¦å‘äº‹ä»¶ Eventï¼Œè¯­æ³•å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>emit EventName(&lt;parameter list&gt;);
</code></pre></div><h2 id="_2ï¸âƒ£-å››ç§äº‹ä»¶å®šä¹‰æ–¹å¼"><a href="#_2ï¸âƒ£-å››ç§äº‹ä»¶å®šä¹‰æ–¹å¼" class="header-anchor">#</a> 2ï¸âƒ£ å››ç§äº‹ä»¶å®šä¹‰æ–¹å¼</h2> <ol><li>ä¸å¸¦å‚æ•°çš„ event</li> <li>å¸¦å‚æ•°çš„ event</li> <li>å¸¦å‚æ•°åçš„ event</li> <li>å¸¦ indexed å‚æ•°åçš„ event
<ol><li>è¿™ç§äº‹ä»¶ä¹Ÿè¢«ç§°ä¸º<strong>ç´¢å¼•äº‹ä»¶</strong></li> <li>è¯­æ³•:<code>event EventName(TypeName indexed varibleName....);</code></li> <li>äº‹ä»¶ä¸­ indexed æ ‡è®°è¿‡çš„å‚æ•°ï¼Œå¯ä»¥åœ¨é“¾å¤–è¿›è¡Œæœç´¢æŸ¥è¯¢ã€‚</li> <li>ä¸€ä¸ªäº‹ä»¶ä¸­ indexed æ ‡è®°è¿‡çš„å‚æ•°æœ€å¤šæœ‰ 3 ä¸ªã€‚</li></ol></li></ol> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Event {
    // æ™®é€š event
    event Log1(address, string);

    // å¸¦åå­—çš„ event
    event Log2(address ads, string msg);

    // å¸¦ indexed çš„event
    event Log3(address indexed ads, string msg);

    // indexed åœ¨ä¸€ä¸ªäº‹ä»¶å†…ä½¿ç”¨æ¬¡æ•°ä¸èƒ½è¶…è¿‡3æ¬¡
    event Transfer(
        address indexed from,
        address indexed to,
        uint256 indexed amount
    );

    function log1() external {
        emit Log1(msg.sender, &quot;Log111&quot;);
    }

    function log2() external {
        emit Log2(msg.sender, &quot;Log222&quot;);
    }

    function log3() external {
        emit Log3(msg.sender, &quot;Log333&quot;);
    }

    function transfer(address _to, uint256 amount) external {
        emit Transfer(msg.sender, _to, amount);
    }
}
</code></pre></div><h3 id="_1-ä¸å¸¦å‚æ•°çš„-event"><a href="#_1-ä¸å¸¦å‚æ•°çš„-event" class="header-anchor">#</a> 1 ä¸å¸¦å‚æ•°çš„ event</h3> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		<span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x7874d94b8f9E2a28FCceCE404666C984f33a82b8&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;topic&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x1732d0c17008d342618e7f03069177d8d39391d79811bb4e706d7c6c84108c0f&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Log1&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><h3 id="_2-å¸¦å‚æ•°çš„-event"><a href="#_2-å¸¦å‚æ•°çš„-event" class="header-anchor">#</a> 2 å¸¦å‚æ•°çš„ event</h3> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		<span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x7874d94b8f9E2a28FCceCE404666C984f33a82b8&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;topic&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x54010eb0426bdddd13273086604fca7ba750a84093c6839732d954056646e81b&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Log2&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;0&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x5B38Da6a701c568545dCfcB03FcB875f56beddC4&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;1&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Log222&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><h3 id="_3-å¸¦å‚æ•°åçš„-event"><a href="#_3-å¸¦å‚æ•°åçš„-event" class="header-anchor">#</a> 3 å¸¦å‚æ•°åçš„ event</h3> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		<span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x7874d94b8f9E2a28FCceCE404666C984f33a82b8&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;topic&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x940879bf2d29cdfe8084f2f033d2168f5859a6e10530b61fb84dc1c5ddc9ca40&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Log3&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;0&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x5B38Da6a701c568545dCfcB03FcB875f56beddC4&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;1&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Log333&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;ads&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x5B38Da6a701c568545dCfcB03FcB875f56beddC4&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Log333&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><h3 id="_4-å¸¦-indexed-å‚æ•°åçš„-event"><a href="#_4-å¸¦-indexed-å‚æ•°åçš„-event" class="header-anchor">#</a> 4 å¸¦ indexed å‚æ•°åçš„ event</h3> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		<span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0xfB72aAdB17a855D27A68B565ee0a84CB30A387e4&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;topic&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0xf485c071883274befba21423da7f60203f9df753bf614bca26c4763ed4b240fb&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Log4&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;0&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x5B38Da6a701c568545dCfcB03FcB875f56beddC4&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;1&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Log444&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;ads&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x5B38Da6a701c568545dCfcB03FcB875f56beddC4&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Log444&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		<span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0xfB72aAdB17a855D27A68B565ee0a84CB30A387e4&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;topic&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Transfer&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;0&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x5B38Da6a701c568545dCfcB03FcB875f56beddC4&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;1&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x5B38Da6a701c568545dCfcB03FcB875f56beddC4&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x5B38Da6a701c568545dCfcB03FcB875f56beddC4&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;to&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x5B38Da6a701c568545dCfcB03FcB875f56beddC4&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><h2 id="_3ï¸âƒ£-indexed-çš„ä½œç”¨"><a href="#_3ï¸âƒ£-indexed-çš„ä½œç”¨" class="header-anchor">#</a> 3ï¸âƒ£ indexed çš„ä½œç”¨</h2> <p>indexed æ•°æ®ä¼šè¢«è®°å½•åˆ° <code>topics</code> ä¸­ï¼Œå¯ä»¥ç”¨äºæ£€ç´¢ã€‚å·²ç´¢å¼•çš„éƒ¨åˆ†ï¼Œæœ€å¤šæœ‰ 3 ä¸ªï¼ˆå¯¹äºéåŒ¿åäº‹ä»¶ï¼‰æˆ– 4 ä¸ªï¼ˆå¯¹äºåŒ¿åäº‹ä»¶ï¼‰</p> <p>å¯¹äºéåŒ¿åäº‹ä»¶ï¼Œæœ€å¤šä¸‰ä¸ªå‚æ•°å¯ä»¥æ¥æ”¶ <code>indexed</code>å±æ€§ï¼ˆå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„åä¸º: &quot;ä¸»é¢˜&quot; çš„æ•°æ®ç»“æ„ï¼Œè€Œä¸ä½œä¸ºæ—¥å¿—çš„æ•°æ®éƒ¨åˆ†ï¼‰ã€‚ä¸»é¢˜ä»…æœ‰ 32 å­—èŠ‚ï¼Œ å› æ­¤å¦‚æœ:å¼•ç”¨ç±»å‹ æ ‡è®°ä¸ºç´¢å¼•é¡¹ï¼Œåˆ™å®ƒä»¬çš„ keccak-256 å“ˆå¸Œå€¼ä¼šè¢«ä½œä¸º ä¸»é¢˜ï¼ˆtopicï¼‰ ä¿å­˜ã€‚</p> <p>ä¸»é¢˜ï¼ˆtopicï¼‰è®©æˆ‘ä»¬å¯ä»¥å¯ä»¥æœç´¢äº‹ä»¶ï¼Œæ¯”å¦‚åœ¨ä¸ºæŸäº›äº‹ä»¶è¿‡æ»¤ä¸€äº›åŒºå—ï¼Œè¿˜å¯ä»¥æŒ‰å‘èµ·äº‹ä»¶çš„åˆåŒåœ°å€æ¥è¿‡æ»¤äº‹ä»¶ã€‚</p> <p>ä¾‹å¦‚, ä½¿ç”¨å¦‚ä¸‹çš„ web3.js <code>subscribe(&quot;logs&quot;)æ–¹æ³•</code> å»è¿‡æ»¤ç¬¦åˆç‰¹å®šåœ°å€çš„ ä¸»é¢˜ï¼ˆtopicï¼‰ ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">fromBlock</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token literal-property property">address</span><span class="token operator">:</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>defaultAccount<span class="token punctuation">,</span>
	<span class="token literal-property property">topics</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
web3<span class="token punctuation">.</span>eth
	<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> options<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">log</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;changed&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">log</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¸»è¦ç”¨åœ¨é“¾ä¸‹æœåŠ¡ï¼Œå¯ä»¥é€šè¿‡ RPC è·å–ï¼Œæ¯”å¦‚ web3 çš„ä»¥ä¸‹æ–¹æ³•:</p> <ul><li><code>myContract.once</code> <ul><li>https://web3js.readthedocs.io/en/v1.7.5/web3-eth-contract.html</li></ul></li> <li><code>myContract.events.MyEvent</code> <ul><li>https://web3js.readthedocs.io/en/v1.7.5/web3-eth-contract.html#contract-events</li></ul></li> <li><code>myContract.getPastEvents</code> <ul><li>https://web3js.readthedocs.io/en/v1.7.5/web3-eth-contract.html#getpastevents</li></ul></li></ul> <h2 id="_4ï¸âƒ£-log-çš„ä½¿ç”¨"><a href="#_4ï¸âƒ£-log-çš„ä½¿ç”¨" class="header-anchor">#</a> 4ï¸âƒ£ log çš„ä½¿ç”¨</h2> <p>é™¤éä½ ç”¨ <code>anonymous</code> å£°æ˜äº‹ä»¶ï¼Œå¦åˆ™äº‹ä»¶ç­¾åçš„å“ˆå¸Œå€¼æ˜¯ä¸€ä¸ª ä¸»é¢˜ï¼ˆtopicï¼‰ã€‚åŒæ—¶ä¹Ÿæ„å‘³ç€å¯¹äºåŒ¿åäº‹ä»¶æ— æ³•é€šè¿‡åå­—æ¥è¿‡æ»¤ï¼Œä»…èƒ½æŒ‰åˆçº¦åœ°å€è¿‡æ»¤ã€‚åŒ¿åäº‹ä»¶çš„ä¼˜åŠ¿æ˜¯ä»–ä»¬éƒ¨ç½²å’Œè°ƒç”¨çš„æˆæœ¬æ›´ä½ã€‚å®ƒä¹Ÿå…è®¸ä½ å£°æ˜ 4 ä¸ªç´¢å¼•å‚ä¸è€Œä¸æ˜¯ 3 ä¸ªã€‚</p> <p>âš ï¸ï¼šç”±äºäº¤æ˜“æ—¥å¿—åªå­˜å‚¨äº‹ä»¶æ•°æ®è€Œä¸å­˜å‚¨ç±»å‹ã€‚ä½ å¿…é¡»çŸ¥é“äº‹ä»¶çš„ç±»å‹ï¼ŒåŒ…æ‹¬å“ªä¸ªå‚æ•°è¢«ç´¢å¼•ï¼Œä»¥åŠè¯¥äº‹ä»¶æ˜¯å¦æ˜¯åŒ¿åçš„ï¼Œä»¥ä¾¿æ­£ç¡®è§£é‡Šæ•°æ®ã€‚å°¤å…¶æ˜¯ï¼Œæœ‰å¯èƒ½ä½¿ç”¨ä¸€ä¸ªåŒ¿åäº‹ä»¶æ¥&quot;ä¼ªé€ &quot;å¦ä¸€ä¸ªäº‹ä»¶çš„ç­¾åã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>pragma solidity  &gt;=0.4.21 &lt;0.9.0;

contract ClientReceipt {
    event Deposit(
        address indexed from,
        bytes32 indexed id,
        uint value
    );

    function deposit(bytes32 id) public payable {
        // äº‹ä»¶ä½¿ç”¨ emit è§¦å‘äº‹ä»¶ã€‚
        // æˆ‘ä»¬å¯ä»¥è¿‡æ»¤å¯¹ `Deposit` çš„è°ƒç”¨ï¼Œä»è€Œç”¨ Javascript API æ¥æŸ¥æ˜å¯¹è¿™ä¸ªå‡½æ•°çš„ä»»ä½•è°ƒç”¨ï¼ˆç”šè‡³æ˜¯æ·±åº¦åµŒå¥—è°ƒç”¨ï¼‰ã€‚
        emit Deposit(msg.sender, id, msg.value);
    }
}
</code></pre></div><p>ä½¿ç”¨ JavaScript API è°ƒç”¨äº‹ä»¶çš„ç”¨æ³•å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> abi <span class="token operator">=</span> <span class="token comment">/* abi ç”±ç¼–è¯‘å™¨äº§ç”Ÿ */</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ClientReceipt <span class="token operator">=</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">contract</span><span class="token punctuation">(</span>abi<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> clientReceipt <span class="token operator">=</span> ClientReceipt<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span><span class="token string">&quot;0x1234...xlb67&quot;</span> <span class="token comment">/* åœ°å€ */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> depositEvent <span class="token operator">=</span> clientReceipt<span class="token punctuation">.</span><span class="token function">Deposit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ç›‘å¬å˜åŒ–</span>
depositEvent<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç»“æœåŒ…å« éç´¢å¼•å‚æ•° ä»¥åŠ ä¸»é¢˜ topic</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æˆ–è€…é€šè¿‡ä¼ å…¥å›è°ƒå‡½æ•°ï¼Œç«‹å³å¼€å§‹å¬ç›‘</span>
<span class="token keyword">var</span> depositEvent <span class="token operator">=</span> clientReceipt<span class="token punctuation">.</span><span class="token function">Deposit</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¸Šé¢çš„è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼ˆæœ‰åˆ å‡ï¼‰ï¼š</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;returnValues&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x1111â€¦FFFFCCCC&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x50â€¦sd5adb20&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x420042&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token property">&quot;raw&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x7fâ€¦91385&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;topics&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;0xfd4â€¦b4ead7&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;0x7fâ€¦1a91385&quot;</span><span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_5ï¸âƒ£-log-é‡è½½"><a href="#_5ï¸âƒ£-log-é‡è½½" class="header-anchor">#</a> 5ï¸âƒ£ Log é‡è½½</h2> <p>Log å¯ä»¥åƒå‡½æ•°ä¸€æ ·é‡è½½</p> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Event {
    event Log(address ads);
    event Log(address indexed ads, string msg); // é‡è½½

    function log1() external {
        emit Log(msg.sender);
    }

    function log2() external {
        emit Log(msg.sender, &quot;Log111&quot;);
    }
}
</code></pre></div><h2 id="ğŸ†—-å®æˆ˜-ä¼—ç­¹åˆçº¦"><a href="#ğŸ†—-å®æˆ˜-ä¼—ç­¹åˆçº¦" class="header-anchor">#</a> ğŸ†— å®æˆ˜: ä¼—ç­¹åˆçº¦</h2> <h3 id="åˆçº¦ä»£ç "><a href="#åˆçº¦ä»£ç " class="header-anchor">#</a> åˆçº¦ä»£ç </h3> <div class="language- extra-class"><pre class="language-text"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

contract Croedfund {
    /* ============ Type Declaration ============ */
    // å‡ºèµ„äººè§’è‰²
    // * ä»…éœ€è®°å½•åœ°å€/é‡‘é¢å³å¯
    struct Donor {
        address addr; //å‡ºèµ„äººåœ°å€
        uint256 amount; //å‡ºèµ„äººé‡‘é¢
    }

    // å‹Ÿèµ„äººè§’è‰²
    // * ç”¨äºè¡¨ç¤ºä¸€ä¸ªå‹Ÿèµ„é¡¹ç›®ï¼Œå…¶ä¸­åŒ…æ‹¬å‹Ÿèµ„äººåœ°å€ã€ç›®æ ‡é‡‘é¢ã€
    // å·²ç­¹é›†é‡‘é¢ã€æèµ è€…äººæ•°ã€é¡¹ç›®çŠ¶æ€ä»¥åŠæ‰€æœ‰çš„å‡ºèµ„äººã€‚
    struct Donee {
        address creator; // å‹Ÿèµ„äººåœ°å€
        uint256 goal; // ä¼—ç­¹ç›®æ ‡æ•°é‡
        uint32 startAt; // å¼€å§‹æ—¶é—´
        uint32 endAt; // ç»“æŸæ—¶é—´
        bool claimed; // æ˜¯å¦è¢«é¢†å–
        uint256 amount; // å·²ç­¹é›†é‡‘é¢
        uint256 donorCount; // * æèµ è€…äººæ•°
        mapping(uint256 =&gt; Donor) donorMap; // * å‡ºèµ„äººå­—å…¸
    }

    /* ============ State Variables ============ */
    address payable owner; //åˆçº¦æ‹¥æœ‰è€…
    uint256 public doneeCount; // å‹Ÿèµ„äººæ•°é‡
    mapping(uint256 =&gt; Donee) public doneeMap; //å‹Ÿèµ„äººå­—å…¸

    /* ============ Events ============ */
    event Launch(
        uint256 id,
        address indexed creator,
        uint256 goal,
        uint32 startAt,
        uint32 endAt
    );
    event Cancel(uint256 id);
    event Donate(uint256 indexed id, address indexed caller, uint256 amount);
    event Unpledge(uint256 indexed id, address indexed caller, uint256 amount);
    event Claim(uint256 id, address creator, uint256 amount);
    event Refund(uint256 indexed id, address indexed caller, uint256 amount);

    /* ============ Modifier ============ */
    modifier onlyOwner() {
        require(msg.sender == owner, &quot;only owner&quot;);
        _;
    }
    // éªŒè¯å‹Ÿææ´»åŠ¨IDæ˜¯å¦æœ‰æ•ˆ
    modifier validDonee(uint256 doneeID) {
        require(doneeID &gt; 0 &amp;&amp; doneeID &lt;= doneeCount);
        _;
    }

    /* ============ Errors ============ */
    error MyError(string);

    /* ============ Constructor ============ */
    constructor() {
        owner = payable(msg.sender);
    }

    /* ============ Functions ============ */
    // å¯åŠ¨æ–°ä¼—ç­¹
    function launch(
        address _addr,
        uint256 _goal,
        uint32 _startAt,
        uint32 _endAt
    ) external onlyOwner {
        require(_startAt &gt;= block.timestamp, &quot;start at &lt; now&quot;);
        require(_startAt &lt;= _endAt, &quot;start at &gt; end at&quot;);
        require(_endAt &lt;= block.timestamp + 30 days, &quot;end at &gt; max duration&quot;);

        doneeCount++;

        Donee storage donee = doneeMap[doneeCount];
        donee.creator = _addr;
        donee.goal = _goal;
        donee.startAt = _startAt;
        donee.endAt = _endAt;
        emit Launch(doneeCount, msg.sender, _goal, _startAt, _endAt);
    }

    // å–æ¶ˆæŒ‡å®šIDçš„ä¼—ç­¹
    function cancel(uint256 _id) external onlyOwner {
        // ä¸éœ€è¦ä¿®æ”¹ï¼Œéœ€ç”¨ memeory ,ä½†æ˜¯åŒ…å«mappingç±»å‹ï¼Œæ‰€ä»¥éœ€è¦ç”¨ storage
        Donee storage campaign = doneeMap[_id];
        require(block.timestamp &lt; campaign.startAt, &quot;started&quot;); // å¿…é¡»è¿˜æ²¡æœ‰å¼€å§‹
        delete doneeMap[_id];
        emit Cancel(_id);
    }

    // å‡ºèµ„äººæèµ 
    function donate(uint256 _id) external payable validDonee(_id) {
        Donee storage donee = doneeMap[_id]; // éœ€è¦ä¿®æ”¹ï¼Œæ‰€ä»¥ä½¿ç”¨ storage
        require(block.timestamp &gt;= donee.startAt, &quot;not start&quot;); //
        require(block.timestamp &lt;= donee.endAt, &quot;ended&quot;); //

        donee.donorCount++;
        donee.amount += msg.value;

        Donor storage donor = donee.donorMap[donee.donorCount];
        donor.addr = msg.sender;
        donor.amount = msg.value;

        emit Donate(_id, msg.sender, msg.value);
    }

    // å®Œæˆç›®æ ‡ç»™å‹Ÿèµ„äººè½¬è´¦
    function transfer(uint256 doneeID) public onlyOwner validDonee(doneeID) {
        Donee storage donee = doneeMap[doneeID];

        require(!donee.claimed, &quot;is claimed&quot;);
        require(block.timestamp &gt;= donee.endAt, &quot;not ended&quot;);
        require(donee.amount &gt;= donee.goal, &quot;amount &lt; goal&quot;);

        // è®¾ç½®å·²ç»æ”¯ä»˜çš„çŠ¶æ€
        donee.claimed = true;

        // ç»™å‹Ÿèµ„äººè½¬è´¦
        payable(donee.creator).transfer(donee.goal);
        emit Claim(doneeID, msg.sender, donee.amount);
    }

    /* ============ Helper ============ */
    fallback() external {}

    receive() external payable {}

    // è·å–å½“å‰åˆçº¦çš„ä½™é¢
    function getBalance() public view returns (uint256) {
        return address(this).balance;
    }

    // åˆçº¦çš„ä½™é¢è½¬è´¦åˆ°æ‹¥æœ‰è€…
    function withdraw(uint256 doneeID) public onlyOwner {
        Donee storage donee = doneeMap[doneeID];
        require(donee.claimed, &quot;not claimed&quot;);
        require(block.timestamp &gt;= donee.endAt, &quot;not ended&quot;);

        payable(msg.sender).transfer(address(this).balance);
    }

    // è·å–é¡¹ç›®çŠ¶æ€
    function getStatus(uint256 doneeID)
        public
        view
        validDonee(doneeID)
        returns (bool)
    {
        Donee storage donee = doneeMap[doneeID];
        return (block.timestamp &gt;= donee.startAt &amp;&amp;
            block.timestamp &lt;= donee.endAt);
    }
}
</code></pre></div><h3 id="æµ‹è¯•åˆçº¦"><a href="#æµ‹è¯•åˆçº¦" class="header-anchor">#</a> æµ‹è¯•åˆçº¦</h3> <ul><li>address1 launch ä¸€æ¬¡æ´»åŠ¨
<ul><li>goal ä¸º 10</li> <li>æ—¶é—´æˆ³è·å–: <a href="https://tool.chinaz.com/tools/unixtime.aspx" target="_blank" rel="noopener noreferrer">https://tool.chinaz.com/tools/unixtime.aspx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>doneeMap æŸ¥è¯¢ id 1 ä¿¡æ¯</li> <li>getStatus æŸ¥è¯¢ id 1 æ˜¯å¦å¼€å§‹</li> <li>address2 donate 6</li> <li>address3 donate 7</li> <li>doneeMap æŸ¥è¯¢ id 1 ä¿¡æ¯</li></ul></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/solidity/professional-solidity/08.loops-and-iteration.html" class="prev">
          å¾ªç¯ä¸è¿­ä»£
        </a></span> <span class="next"><a href="/solidity/professional-solidity/10.inheritance.html">
          ç»§æ‰¿
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/09.event.html#_1ï¸âƒ£-event-è¯­æ³•" class="sidebar-link reco-side-_1ï¸âƒ£-event-è¯­æ³•" data-v-b57cc07c>1ï¸âƒ£ Event è¯­æ³•</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/09.event.html#_2ï¸âƒ£-å››ç§äº‹ä»¶å®šä¹‰æ–¹å¼" class="sidebar-link reco-side-_2ï¸âƒ£-å››ç§äº‹ä»¶å®šä¹‰æ–¹å¼" data-v-b57cc07c>2ï¸âƒ£ å››ç§äº‹ä»¶å®šä¹‰æ–¹å¼</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/09.event.html#_1-ä¸å¸¦å‚æ•°çš„-event" class="sidebar-link reco-side-_1-ä¸å¸¦å‚æ•°çš„-event" data-v-b57cc07c>1 ä¸å¸¦å‚æ•°çš„ event</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/09.event.html#_2-å¸¦å‚æ•°çš„-event" class="sidebar-link reco-side-_2-å¸¦å‚æ•°çš„-event" data-v-b57cc07c>2 å¸¦å‚æ•°çš„ event</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/09.event.html#_3-å¸¦å‚æ•°åçš„-event" class="sidebar-link reco-side-_3-å¸¦å‚æ•°åçš„-event" data-v-b57cc07c>3 å¸¦å‚æ•°åçš„ event</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/09.event.html#_4-å¸¦-indexed-å‚æ•°åçš„-event" class="sidebar-link reco-side-_4-å¸¦-indexed-å‚æ•°åçš„-event" data-v-b57cc07c>4 å¸¦ indexed å‚æ•°åçš„ event</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/09.event.html#_3ï¸âƒ£-indexed-çš„ä½œç”¨" class="sidebar-link reco-side-_3ï¸âƒ£-indexed-çš„ä½œç”¨" data-v-b57cc07c>3ï¸âƒ£ indexed çš„ä½œç”¨</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/09.event.html#_4ï¸âƒ£-log-çš„ä½¿ç”¨" class="sidebar-link reco-side-_4ï¸âƒ£-log-çš„ä½¿ç”¨" data-v-b57cc07c>4ï¸âƒ£ log çš„ä½¿ç”¨</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/09.event.html#_5ï¸âƒ£-log-é‡è½½" class="sidebar-link reco-side-_5ï¸âƒ£-log-é‡è½½" data-v-b57cc07c>5ï¸âƒ£ Log é‡è½½</a></li><li class="level-2" data-v-b57cc07c><a href="/solidity/professional-solidity/09.event.html#ğŸ†—-å®æˆ˜-ä¼—ç­¹åˆçº¦" class="sidebar-link reco-side-ğŸ†—-å®æˆ˜-ä¼—ç­¹åˆçº¦" data-v-b57cc07c>ğŸ†— å®æˆ˜: ä¼—ç­¹åˆçº¦</a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/09.event.html#åˆçº¦ä»£ç " class="sidebar-link reco-side-åˆçº¦ä»£ç " data-v-b57cc07c>åˆçº¦ä»£ç </a></li><li class="level-3" data-v-b57cc07c><a href="/solidity/professional-solidity/09.event.html#æµ‹è¯•åˆçº¦" class="sidebar-link reco-side-æµ‹è¯•åˆçº¦" data-v-b57cc07c>æµ‹è¯•åˆçº¦</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/solidity/assets/js/app.e5082ffd.js" defer></script><script src="/solidity/assets/js/3.5ee47f7c.js" defer></script><script src="/solidity/assets/js/1.912b4b55.js" defer></script><script src="/solidity/assets/js/35.95934a73.js" defer></script>
  </body>
</html>
